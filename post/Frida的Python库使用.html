<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Android逆向学习笔记——使用Python库调用Frida | Whitebird&#39;s Home</title>
  <meta name="keywords" content=" Android ">
  <meta name="description" content="Android逆向学习笔记——使用Python库调用Frida | Whitebird&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="about">
<meta property="og:url" content="https://whitebird0.github.io/about/index.html">
<meta property="og:site_name" content="Whitebird&#39;s Home">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-07-09T11:26:44.000Z">
<meta property="article:modified_time" content="2022-07-09T11:26:44.827Z">
<meta property="article:author" content="Whitebird">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/github.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.2"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Whitebird</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/Whitebird0"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://blog.csdn.net/jxnu_666?type=blog"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:767778848@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=767778848&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(27)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="CTF">
                        
                        CTF
                        <small>(6)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Reverse">
                        
                        Reverse
                        <small>(8)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Android开发">
                        
                        Android开发
                        <small>(10)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Android逆向">
                        
                        Android逆向
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Windows内核">
                        
                        Windows内核
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="27">
<input type="hidden" id="yelog_site_word_count" value="149.1k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://www.codetea.top/">Codetea</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Reverse</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Windows内核</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/unidbg%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向学习笔记——Unidbg学习与实战">Android逆向学习笔记——Unidbg学习与实战</span>
            <span class="post-date" title="2023-07-01 09:00:15">2023/07/01</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/Frida%E7%9A%84Python%E5%BA%93%E4%BD%BF%E7%94%A8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向学习笔记——使用Python库调用Frida">Android逆向学习笔记——使用Python库调用Frida</span>
            <span class="post-date" title="2023-06-01 09:00:15">2023/06/01</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/NDK%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记——NDK开发">Android开发学习笔记——NDK开发</span>
            <span class="post-date" title="2023-03-31 09:00:14">2023/03/31</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code1.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(1)——初识安卓">Android开发学习笔记(1)——初识安卓</span>
            <span class="post-date" title="2023-03-30 09:00:21">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code2.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(2)——探究活动">Android开发学习笔记(2)——探究活动</span>
            <span class="post-date" title="2023-03-30 09:00:20">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code3.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(3)——UI开发">Android开发学习笔记(3)——UI开发</span>
            <span class="post-date" title="2023-03-30 09:00:19">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code4.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(4)——探究碎片">Android开发学习笔记(4)——探究碎片</span>
            <span class="post-date" title="2023-03-30 09:00:18">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code5.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(5)——详解广播机制">Android开发学习笔记(5)——详解广播机制</span>
            <span class="post-date" title="2023-03-30 09:00:17">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code6.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(6)——数据存储全方案">Android开发学习笔记(6)——数据存储全方案</span>
            <span class="post-date" title="2023-03-30 09:00:16">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code7.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(7)——跨程序共享数据">Android开发学习笔记(7)——跨程序共享数据</span>
            <span class="post-date" title="2023-03-30 09:00:15">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(8)——运用手机多媒体">Android开发学习笔记(8)——运用手机多媒体</span>
            <span class="post-date" title="2023-03-30 09:00:14">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code9.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(9)——网络技术">Android开发学习笔记(9)——网络技术</span>
            <span class="post-date" title="2023-03-30 09:00:13">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022%E5%B9%B4%E6%B1%9F%E8%A5%BF%E7%9C%81%E2%80%9C%E8%B5%A3%E8%82%B2%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022年江西省“赣育杯”网络安全大赛初赛 Re WriteUp">2022年江西省“赣育杯”网络安全大赛初赛 Re WriteUp</span>
            <span class="post-date" title="2022-10-08 22:40:21">2022/10/08</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/qwb.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第六届强网杯全国网络安全挑战赛 Re WriteUp">第六届强网杯全国网络安全挑战赛 Re WriteUp</span>
            <span class="post-date" title="2022-08-08 15:49:21">2022/08/08</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/bluecup.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第六届蓝帽杯初赛CTF题目 Re WriteUp">第六届蓝帽杯初赛CTF题目 Re WriteUp</span>
            <span class="post-date" title="2022-07-13 22:49:21">2022/07/13</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/CISCN2022.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第十五届全国大学生信息安全竞赛创新实践能力赛CISCN">第十五届全国大学生信息安全竞赛创新实践能力赛CISCN</span>
            <span class="post-date" title="2022-06-03 20:49:21">2022/06/03</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022DASCTF Apr X FATE 防疫挑战赛">2022DASCTF Apr X FATE 防疫挑战赛</span>
            <span class="post-date" title="2022-06-01 20:49:21">2022/06/01</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/PE%E6%98%A0%E5%83%8F%E5%88%87%E6%8D%A2.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——PE映像切换">逆向工程核心原理——PE映像切换</span>
            <span class="post-date" title="2022-04-02 10:49:21">2022/04/02</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E5%8F%8D%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——反调试技术">逆向工程核心原理——反调试技术</span>
            <span class="post-date" title="2022-03-28 10:30:21">2022/03/28</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022-3-26-2022DASCTF-X-SU-Re-WriteUp.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022DASCTF X SU Re WriteUp">2022DASCTF X SU Re WriteUp</span>
            <span class="post-date" title="2022-03-26 20:49:21">2022/03/26</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/SEH.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——SEH原理分析">逆向工程核心原理——SEH原理分析</span>
            <span class="post-date" title="2022-03-19 10:49:21">2022/03/19</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/TLS%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——TLS回调函数">逆向工程核心原理——TLS回调函数</span>
            <span class="post-date" title="2022-03-15 22:49:21">2022/03/15</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E5%85%A8%E5%B1%80API%E9%92%A9%E5%8F%96-IE%E9%93%BE%E6%8E%A5%E6%8E%A7%E5%88%B6.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——全局API钩取">逆向工程核心原理——全局API钩取</span>
            <span class="post-date" title="2022-03-11 16:49:21">2022/03/11</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E8%AE%A1%E7%AE%97%E5%99%A8%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E6%95%B0%E5%AD%97.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——IAT_HOOK">逆向工程核心原理——IAT_HOOK</span>
            <span class="post-date" title="2022-03-08 22:49:21">2022/03/08</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9PE%E5%8A%A0%E8%BD%BDDLL.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——通过修改PE加载DLL">逆向工程核心原理——通过修改PE加载DLL</span>
            <span class="post-date" title="2022-02-28 22:49:21">2022/02/28</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/DLL%E6%B3%A8%E5%85%A5.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——DLL注入">逆向工程核心原理——DLL注入</span>
            <span class="post-date" title="2022-02-26 00:49:21">2022/02/26</span>
        </a>
        
        
        <a  class="全部文章 Windows内核 "
           href="/post/%E6%AE%B5%E4%B8%8E%E9%A1%B5%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html"
           data-tag="Windows内核"
           data-author="" >
            <span class="post-title" title="Windows内核基础知识-段选择子与段描述符">Windows内核基础知识-段选择子与段描述符</span>
            <span class="post-date" title="2021-10-03 12:40:21">2021/10/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-Frida的Python库使用" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">Android逆向学习笔记——使用Python库调用Frida</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="Android逆向">Android逆向</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color3">Android</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2023-07-13 15:11:59'>2023-06-01 09:00</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:2.4k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8frida%E7%9A%84Python%E5%BA%93"><span class="toc-text">1、为什么使用frida的Python库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2%E3%80%81API%E5%AD%A6%E4%B9%A0"><span class="toc-text">2、API学习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%E3%80%81%E5%8C%85%E5%90%8D%E9%99%84%E5%8A%A0"><span class="toc-text">2.1、包名附加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E3%80%81PID%E9%99%84%E5%8A%A0"><span class="toc-text">2.2、PID附加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3%E3%80%81spawn%E6%96%B9%E5%BC%8F%E9%99%84%E5%8A%A0"><span class="toc-text">2.3、spawn方式附加</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4%E3%80%81%E8%BF%9E%E6%8E%A5%E9%9D%9E%E6%A0%87%E5%87%86%E7%AB%AF%E5%8F%A3"><span class="toc-text">2.4、连接非标准端口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5%E3%80%81frida%E4%B8%8EPython%E7%9A%84%E4%BA%A4%E4%BA%92-send"><span class="toc-text">2.5、frida与Python的交互(send)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6%E3%80%81frida%E4%B8%8EPython%E7%9A%84%E4%BA%A4%E4%BA%92-recv"><span class="toc-text">2.6、frida与Python的交互(recv)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7%E3%80%81frida%E7%9A%84rpc"><span class="toc-text">2.7、frida的rpc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-8%E3%80%81frida%E7%AE%97%E6%B3%95%E8%BD%AC%E5%8F%91"><span class="toc-text">2.8、frida算法转发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-9%E3%80%81%E5%B0%86python%E4%BD%9C%E4%B8%BA%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%BD%AC%E5%8F%91"><span class="toc-text">2.9、将python作为服务端转发</span></a></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1、为什么使用frida的Python库"><a href="#1、为什么使用frida的Python库" class="headerlink" title="1、为什么使用frida的Python库"></a>1、为什么使用frida的Python库</h1><p>1、之前学习的frida更多是用于手工调试阶段，如果要用代码自动化处理，还需要其他语言接入，比如Python</p>
<p>2、 后续学习的frida算法转发方案和frida的rpc也需要用到Python，算法转发和rpc能给逆向带来无比便捷的体验</p>
<p>3、frida可以实时与python进行数据交互，可以把数据发送给python，等待python处理完后，接收返回值，frida再接着往下执行代码。Python提供的各种库，让代码编写更为简单</p>
<h1 id="2、API学习"><a href="#2、API学习" class="headerlink" title="2、API学习"></a>2、API学习</h1><h2 id="2-1、包名附加"><a href="#2-1、包名附加" class="headerlink" title="2.1、包名附加"></a>2.1、包名附加</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> frida<span class="token punctuation">,</span> sys
jsCode <span class="token operator">=</span> <span class="token triple-quoted-string string">""" ...... """</span>
process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">'进程名'</span><span class="token punctuation">)</span><span class="token comment">#老版本frida用包名，新版本frida用进程名</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jsCode<span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我这里以嘟嘟牛在线为例</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> frida<span class="token punctuation">,</span>sys
jscode<span class="token operator">=</span><span class="token triple-quoted-string string">"""
   Java.perform(function()&#123;
        var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
        RequestUtil.encodeDesMap.overload('java.lang.String', 'java.lang.String', 'java.lang.String').implementation = function(a, b, c)&#123;
            console.log('data: ', a);
            console.log('desKey: ', b);
            console.log('desIV: ', c);
            var retval = this.encodeDesMap(a, b, c);
            console.log('retval: ', retval);
            return retval;
        &#125;
        var Utils = Java.use('com.dodonew.online.util.Utils');
        Utils.md5.implementation = function(a)&#123;
            console.log('MD5 string: ', a);
            var retval = this.md5(a);
            console.log(retval);
            return retval;
        &#125;
    &#125;);
"""</span>
process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">'嘟嘟牛在线'</span><span class="token punctuation">)</span>
script<span class="token operator">=</span>process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span><span class="token punctuation">;</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306032354518.png"></p>
<p>在pycharm的控制台中已经打印出数据了</p>
<h2 id="2-2、PID附加"><a href="#2-2、PID附加" class="headerlink" title="2.2、PID附加"></a>2.2、PID附加</h2><p>先通过ps -A｜grep dodo，获取PID</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306040024334.png"></p>
<p>由于有的应用是双进程，这个时候使用包名附加就会冲突，因此可以使用PID附加</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token number">11518</span><span class="token punctuation">)</span>
script<span class="token operator">=</span>process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span><span class="token punctuation">;</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>很简单，只需要把attach里的包名&#x2F;应用名改为PID进行了</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306040026720.png"></p>
<h2 id="2-3、spawn方式附加"><a href="#2-3、spawn方式附加" class="headerlink" title="2.3、spawn方式附加"></a>2.3、spawn方式附加</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> frida<span class="token punctuation">,</span>sys
jscode<span class="token operator">=</span><span class="token triple-quoted-string string">"""
   Java.perform(function()&#123;
        var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
        RequestUtil.encodeDesMap.overload('java.lang.String', 'java.lang.String', 'java.lang.String').implementation = function(a, b, c)&#123;
            console.log('data: ', a);
            console.log('desKey: ', b);
            console.log('desIV: ', c);
            var retval = this.encodeDesMap(a, b, c);
            console.log('retval: ', retval);
            return retval;
        &#125;
        var Utils = Java.use('com.dodonew.online.util.Utils');
        Utils.md5.implementation = function(a)&#123;
            console.log('MD5 string: ', a);
            var retval = this.md5(a);
            console.log(retval);
            return retval;
        &#125;
    &#125;);
"""</span>
<span class="token comment">#get_remote_device</span>
device <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"device:"</span><span class="token punctuation">,</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
pid <span class="token operator">=</span> device<span class="token punctuation">.</span>spawn<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"com.dodonew.online"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#以挂起的方式创建进程</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"pid:"</span><span class="token punctuation">,</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
process <span class="token operator">=</span> device<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"process:"</span><span class="token punctuation">,</span>process<span class="token punctuation">)</span><span class="token punctuation">;</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
device<span class="token punctuation">.</span>resume<span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token comment">#加载完脚本，恢复进程运行</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>先创建device，然后通过device.spawn挂起进程，通过device.attach(pid)附加到进程，加载脚本后通过resume恢复进程运行</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306040043381.png"></p>
<h2 id="2-4、连接非标准端口"><a href="#2-4、连接非标准端口" class="headerlink" title="2.4、连接非标准端口"></a>2.4、连接非标准端口</h2><p>先查看手机的ip</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306041653905.png"></p>
<p>然后frida-server用指定端口的方法启动</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306041645013.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_device_manager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_remote_device<span class="token punctuation">(</span><span class="token string">'192.168.0.104:8888'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">'嘟嘟牛在线'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span><span class="token punctuation">;</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始hook"</span><span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306041653933.png"></p>
<h2 id="2-5、frida与Python的交互-send"><a href="#2-5、frida与Python的交互-send" class="headerlink" title="2.5、frida与Python的交互(send)"></a>2.5、frida与Python的交互(send)</h2><p>我们用frida去做hook的时候，js代码中通过console.log打印出想要的值，但是这个值无法交给python继续使用，因此需要用到send函数来将值传递给python中，具体操作如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> frida<span class="token punctuation">,</span>sys
jscode<span class="token operator">=</span><span class="token triple-quoted-string string">"""
   Java.perform(function()&#123;
        var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
        RequestUtil.encodeDesMap.overload('java.lang.String', 'java.lang.String', 'java.lang.String').implementation = function(a, b, c)&#123;
            console.log('data: ', a);
            console.log('desKey: ', b);
            console.log('desIV: ', c);
            var retval = this.encodeDesMap(a, b, c);
            console.log('retval: ', retval);
            return retval;
        &#125;
        var Utils = Java.use('com.dodonew.online.util.Utils');
        Utils.md5.implementation = function(a)&#123;
            console.log('MD5 string: ', a);
            var retval = this.md5(a);
            send(retval);
            return retval;
        &#125;
    &#125;);
"""</span>
<span class="token keyword">def</span> <span class="token function">messageFunc</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    <span class="token keyword">if</span> message<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'send'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">u"[*] &#123;0&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>message<span class="token punctuation">[</span><span class="token string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>

process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">'嘟嘟牛在线'</span><span class="token punctuation">)</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> messageFunc<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始hook"</span><span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们通过script.on(‘message’, messageFunc)接受js里发来的消息，类似监听，然后messageFunc是回调函数，对message进行处理</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306041831576.png"></p>
<p>我们打印出message，格式是key+value，通过判断key为send，打印出payload</p>
<h2 id="2-6、frida与Python的交互-recv"><a href="#2-6、frida与Python的交互-recv" class="headerlink" title="2.6、frida与Python的交互(recv)"></a>2.6、frida与Python的交互(recv)</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> time

<span class="token keyword">import</span> frida<span class="token punctuation">,</span>sys
jscode<span class="token operator">=</span><span class="token triple-quoted-string string">"""
   Java.perform(function()&#123;
        var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
        RequestUtil.encodeDesMap.overload('java.lang.String', 'java.lang.String', 'java.lang.String').implementation = function(a, b, c)&#123;
            console.log('data: ', a);
            console.log('desKey: ', b);
            console.log('desIV: ', c);
            var retval = this.encodeDesMap(a, b, c);
            console.log('retval: ', retval);
            return retval;
        &#125;
        var Utils = Java.use('com.dodonew.online.util.Utils');
        Utils.md5.implementation = function(a)&#123;
            console.log('MD5 string: ', a);
            var retval = this.md5(a);
            send(retval);
            recv(
            function(obj)&#123;
                console.log(obj.data)
                retval=obj.data
            &#125;
            ).wait();
            return retval;
        &#125;
    &#125;);
"""</span>
<span class="token keyword">def</span> <span class="token function">messageFunc</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    <span class="token keyword">if</span> message<span class="token punctuation">[</span><span class="token string">"type"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'send'</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">u"[*] &#123;0&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>message<span class="token punctuation">[</span><span class="token string">'payload'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>

process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">'嘟嘟牛在线'</span><span class="token punctuation">)</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>on<span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> messageFunc<span class="token punctuation">)</span>
time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>post<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'data'</span><span class="token punctuation">:</span> <span class="token string">'12345678123456781234567812345678'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始hook"</span><span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我们在接收到message时，通过messageFunc处理，打印出了现在的md5加密后的结果，然后通过time.sleep(10)暂停10秒后再发送数据给js，发送的值为12345678123456781234567812345678。js中通过recv函数接受python发来的数据并作处理。</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token function">recv</span><span class="token punctuation">(</span>
           <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
               console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
               retval<span class="token operator">=</span>obj<span class="token punctuation">.</span>data
           <span class="token punctuation">&#125;</span>
           <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>recv的参数是一个回调函数，里面先打印了传来的数据，然后又把这个数据赋值给retval</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306041856204.png"></p>
<h2 id="2-7、frida的rpc"><a href="#2-7、frida的rpc" class="headerlink" title="2.7、frida的rpc"></a>2.7、frida的rpc</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> time

<span class="token keyword">import</span> frida<span class="token punctuation">,</span>sys
jscode<span class="token operator">=</span><span class="token triple-quoted-string string">"""
  Java.perform(function()&#123;
        var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
        RequestUtil.encodeDesMap.overload('java.lang.String', 'java.lang.String', 'java.lang.String').implementation = function(a, b, c)&#123;
            console.log('data: ', a);
            console.log('desKey: ', b);
            console.log('desIV: ', c);
            var retval = this.encodeDesMap(a, b, c);
            console.log('retval: ', retval);
            return retval;
        &#125;
        var Utils = Java.use('com.dodonew.online.util.Utils');
        Utils.md5.implementation = function(a)&#123;
            console.log('MD5 string: ', a);
            var retval = this.md5(a);
            console.log('retval: ', retval);
            return retval;
        &#125;
    &#125;);
   
  function test(data) &#123;
        return new Promise(function(resolve, reject) &#123;
             Java.perform(function() &#123;   
                    var result = Java.use('com.dodonew.online.util.Utils').md5(data);
                    console.log('result1: ', result);
                    resolve(result);
                 &#125;);
         &#125;).then(function(result) &#123;
                console.log('result2: ', result);
                return result;
  &#125;);
&#125;

    
     rpc.exports = &#123;
        rpcfunc: test
    &#125;;
    
"""</span>
device <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_usb_device<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"device:"</span><span class="token punctuation">,</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
pid <span class="token operator">=</span> device<span class="token punctuation">.</span>spawn<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"com.dodonew.online"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#以挂起的方式创建进程</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"pid:"</span><span class="token punctuation">,</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
process <span class="token operator">=</span> device<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"process:"</span><span class="token punctuation">,</span>process<span class="token punctuation">)</span><span class="token punctuation">;</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jscode<span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
device<span class="token punctuation">.</span>resume<span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token comment">#加载完脚本，恢复进程运行</span>

result <span class="token operator">=</span> script<span class="token punctuation">.</span>exports_sync<span class="token punctuation">.</span>rpcfunc<span class="token punctuation">(</span><span class="token string">'equtype=ANDROID&amp;loginImei=Androidnull&amp;timeStamp=1626790668522&amp;userPwd=a12345678&amp;username=15968079477&amp;key=sdlkjsdljf0j2fsjk'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"开始hook"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"result3："</span><span class="token operator">+</span>result<span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>stdin<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>通过rpc.exports导出函数，然后通过script.exports_sync.rpcfunc调用函数。这里要注意个问题，我们在js中定义函数test时，原本的代码如下：</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
       Java<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   
           result <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'com.dodonew.online.util.Utils'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
           console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'result1: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'result2: '</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> result<span class="token punctuation">;</span>
   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里有个问题，test被执行时，并不是顺序执行的， Java.perform会异步操作，因此，在 Java.perform()调用之后，代码会立即执行 console.log(‘result2: ‘, result)，然后执行 return result;。这意味着 Java.use(‘com.dodonew.online.util.Utils’).md5(data)的执行尚未完成，因此 result 变量的值仍然为空字符串，而不是预期的 MD5 值。利用chatgpt对代码进行了修改后就可以正常打印了</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202306042207129.png"></p>
<h2 id="2-8、frida算法转发"><a href="#2-8、frida算法转发" class="headerlink" title="2.8、frida算法转发"></a>2.8、frida算法转发</h2><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">import</span> requests<span class="token punctuation">,</span> json
<span class="token keyword">import</span> frida

jsCode <span class="token operator">=</span> <span class="token string">""</span>"
    <span class="token keyword">function</span> <span class="token function">hookTest</span><span class="token punctuation">(</span><span class="token parameter">username<span class="token punctuation">,</span> passward</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> result<span class="token punctuation">;</span>
        Java<span class="token punctuation">.</span><span class="token function">perform</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> signData <span class="token operator">=</span> <span class="token string">'equtype=ANDROID&amp;loginImei=Android352689082129358&amp;timeStamp='</span> <span class="token operator">+</span> 
            time <span class="token operator">+</span> <span class="token string">'&amp;userPwd='</span> <span class="token operator">+</span> passward <span class="token operator">+</span> <span class="token string">'&amp;username='</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">'&amp;key=sdlkjsdljf0j2fsjk'</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> Utils <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'com.dodonew.online.util.Utils'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> sign <span class="token operator">=</span> Utils<span class="token punctuation">.</span><span class="token function">md5</span><span class="token punctuation">(</span>signData<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sign: '</span><span class="token punctuation">,</span> sign<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">var</span> encryptData <span class="token operator">=</span> <span class="token string">'&#123;"equtype":"ANDROID","loginImei":"Android352689082129358","sign":"'</span><span class="token operator">+</span> 
            sign <span class="token operator">+</span><span class="token string">'","timeStamp":"'</span><span class="token operator">+</span> time <span class="token operator">+</span><span class="token string">'","userPwd":"'</span> <span class="token operator">+</span> passward <span class="token operator">+</span> <span class="token string">'","username":"'</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token string">'"&#125;'</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> RequestUtil <span class="token operator">=</span> Java<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'com.dodonew.online.http.RequestUtil'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">var</span> Encrypt <span class="token operator">=</span> RequestUtil<span class="token punctuation">.</span><span class="token function">encodeDesMap</span><span class="token punctuation">(</span>encryptData<span class="token punctuation">,</span> <span class="token string">'65102933'</span><span class="token punctuation">,</span> <span class="token string">'32028092'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Encrypt: '</span><span class="token punctuation">,</span> Encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
            result <span class="token operator">=</span> Encrypt<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    rpc<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token literal-property property">rpcfunc</span><span class="token operator">:</span> hookTest
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token string">""</span>"

# 调用frida脚本
process <span class="token operator">=</span> frida<span class="token punctuation">.</span><span class="token function">get_device_manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add_remote_device</span><span class="token punctuation">(</span><span class="token string">'192.168.1.106:8888'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attach</span><span class="token punctuation">(</span><span class="token string">"嘟嘟牛在线"</span><span class="token punctuation">)</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">create_script</span><span class="token punctuation">(</span>jsCode<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'[*] Running Whitebird'</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
cipherText <span class="token operator">=</span> script<span class="token punctuation">.</span>exports<span class="token punctuation">.</span><span class="token function">rpcfunc</span><span class="token punctuation">(</span><span class="token string">'18075042220'</span><span class="token punctuation">,</span> <span class="token string">'a12345678'</span><span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span>cipherText<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>其实就是调用app中的加密算法</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202307040646286.png"></p>
<h2 id="2-9、将python作为服务端转发"><a href="#2-9、将python作为服务端转发" class="headerlink" title="2.9、将python作为服务端转发"></a>2.9、将python作为服务端转发</h2><p>我们上面的测试代码都是用python写的，有的时候我们可能想用其他语言去实现，但是其他语言不一定有frida的rpc库，所以我们可以把python作为中间层，将python开启一个服务，这样就可以让别的语言访问，类似于函数的封装，然后提供一个接口。</p>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">pip3 install fastapi
pip3 install uvicorn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>代码如下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token punctuation">,</span> json
<span class="token keyword">import</span> frida
<span class="token keyword">import</span> uvicorn
<span class="token keyword">import</span> fastapi
jsCode <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
    function hookTest(username, passward)&#123;
        var result;
        Java.perform(function()&#123;
            var time = new Date().getTime();
            var signData = 'equtype=ANDROID&amp;loginImei=Android352689082129358&amp;timeStamp=' + 
            time + '&amp;userPwd=' + passward + '&amp;username=' + username + '&amp;key=sdlkjsdljf0j2fsjk';
            var Utils = Java.use('com.dodonew.online.util.Utils');
            var sign = Utils.md5(signData).toUpperCase();
            console.log('sign: ', sign);

            var encryptData = '&#123;"equtype":"ANDROID","loginImei":"Android352689082129358","sign":"'+ 
            sign +'","timeStamp":"'+ time +'","userPwd":"' + passward + '","username":"' + username + '"&#125;';
            var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
            var Encrypt = RequestUtil.encodeDesMap(encryptData, '65102933', '32028092');
            console.log('Encrypt: ', Encrypt);
            result = Encrypt;
        &#125;);
        return result;
    &#125;
    rpc.exports = &#123;
        rpcfunc: hookTest
    &#125;;
"""</span>

<span class="token comment"># 调用frida脚本</span>
process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_device_manager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_remote_device<span class="token punctuation">(</span><span class="token string">'192.168.1.106:8888'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">"嘟嘟牛在线"</span><span class="token punctuation">)</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jsCode<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Running Whitebird'</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
cipherText <span class="token operator">=</span> script<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>rpcfunc<span class="token punctuation">(</span><span class="token string">'18075042220'</span><span class="token punctuation">,</span> <span class="token string">'a12345678'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipherText<span class="token punctuation">)</span>


app <span class="token operator">=</span> fastapi<span class="token punctuation">.</span>FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">getEchoApi</span><span class="token punctuation">(</span>item_id<span class="token punctuation">,</span> item_user<span class="token punctuation">,</span> item_pass<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> script<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>rpcfunc<span class="token punctuation">(</span>item_user<span class="token punctuation">,</span> item_pass<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"item_id"</span><span class="token punctuation">:</span> item_id<span class="token punctuation">,</span> <span class="token string">"item_retval"</span><span class="token punctuation">:</span> result<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    uvicorn<span class="token punctuation">.</span>run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> port <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202307040734160.png"></p>
<p>构造访问的url：<a target="_blank" rel="noopener" href="http://127.0.0.1:8080/get?item_id=100&item_user=18075042220&item_pass=a12345678">http://127.0.0.1:8080/get?item_id=100&amp;item_user=18075042220&amp;item_pass=a12345678</a></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202307040735058.png"></p>
<p>现在我们可以用其他语言直接发起get请求，传入对应的参数就可以得到加密后的结果</p>
<p>我们还可以写一个post请求</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> curses <span class="token keyword">import</span> A_ALTCHARSET
<span class="token keyword">import</span> requests<span class="token punctuation">,</span> json
<span class="token keyword">import</span> frida
<span class="token keyword">import</span> uvicorn
<span class="token keyword">import</span> fastapi
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel
jsCode <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
    function hookTest(username, passward)&#123;
        var result;
        Java.perform(function()&#123;
            var time = new Date().getTime();
            var signData = 'equtype=ANDROID&amp;loginImei=Android352689082129358&amp;timeStamp=' + 
            time + '&amp;userPwd=' + passward + '&amp;username=' + username + '&amp;key=sdlkjsdljf0j2fsjk';
            var Utils = Java.use('com.dodonew.online.util.Utils');
            var sign = Utils.md5(signData).toUpperCase();
            console.log('sign: ', sign);

            var encryptData = '&#123;"equtype":"ANDROID","loginImei":"Android352689082129358","sign":"'+ 
            sign +'","timeStamp":"'+ time +'","userPwd":"' + passward + '","username":"' + username + '"&#125;';
            var RequestUtil = Java.use('com.dodonew.online.http.RequestUtil');
            var Encrypt = RequestUtil.encodeDesMap(encryptData, '65102933', '32028092');
            console.log('Encrypt: ', Encrypt);
            result = Encrypt;
        &#125;);
        return result;
    &#125;
    rpc.exports = &#123;
        rpcfunc: hookTest
    &#125;;
"""</span>

<span class="token comment"># 调用frida脚本</span>
process <span class="token operator">=</span> frida<span class="token punctuation">.</span>get_device_manager<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>add_remote_device<span class="token punctuation">(</span><span class="token string">'192.168.1.106:8888'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>attach<span class="token punctuation">(</span><span class="token string">"嘟嘟牛在线"</span><span class="token punctuation">)</span>
script <span class="token operator">=</span> process<span class="token punctuation">.</span>create_script<span class="token punctuation">(</span>jsCode<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Running Whitebird'</span><span class="token punctuation">)</span>
script<span class="token punctuation">.</span>load<span class="token punctuation">(</span><span class="token punctuation">)</span>
cipherText <span class="token operator">=</span> script<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>rpcfunc<span class="token punctuation">(</span><span class="token string">'18075042220'</span><span class="token punctuation">,</span> <span class="token string">'a12345678'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipherText<span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Item</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    item_id<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    item_user<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span>
    item_pass<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token boolean">None</span>

app <span class="token operator">=</span> fastapi<span class="token punctuation">.</span>FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/post"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">getEchoApi</span><span class="token punctuation">(</span>postData<span class="token punctuation">:</span> Item<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> script<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>rpcfunc<span class="token punctuation">(</span>postData<span class="token punctuation">.</span>item_user<span class="token punctuation">,</span> postData<span class="token punctuation">.</span>item_pass<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"item_id"</span><span class="token punctuation">:</span> postData<span class="token punctuation">.</span>item_id<span class="token punctuation">,</span> <span class="token string">"item_retval"</span><span class="token punctuation">:</span> result<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    uvicorn<span class="token punctuation">.</span>run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> port <span class="token operator">=</span> <span class="token number">8080</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/202307040751119.png"></p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 767778848@qq.com </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '6c49373fe3729f3c2b02',
            clientSecret: '4b38338216282f43430b6118f27ae24e4732ecec',
            repo: 'Whitebird0.github.io',
            owner: 'Whitebird0',
            admin: ['Whitebird0'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2020-2022 Whitebird
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
