<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>第六届强网杯全国网络安全挑战赛 Re WriteUp | Whitebird&#39;s Home</title>
  <meta name="keywords" content=" CTF ">
  <meta name="description" content="第六届强网杯全国网络安全挑战赛 Re WriteUp | Whitebird&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="about">
<meta property="og:url" content="https://whitebird0.github.io/about/index.html">
<meta property="og:site_name" content="Whitebird&#39;s Home">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-07-09T11:26:44.000Z">
<meta property="article:modified_time" content="2022-07-09T11:26:44.827Z">
<meta property="article:author" content="Whitebird">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/github.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.2"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Whitebird</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/Whitebird0"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://blog.csdn.net/jxnu_666?type=blog"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:767778848@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=767778848&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(32)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="CTF">
                        
                        CTF
                        <small>(6)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Reverse">
                        
                        Reverse
                        <small>(8)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Android开发">
                        
                        Android开发
                        <small>(10)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Android逆向">
                        
                        Android逆向
                        <small>(5)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="WEB安全">
                        
                        WEB安全
                        <small>(2)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Windows内核">
                        
                        Windows内核
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="32">
<input type="hidden" id="yelog_site_word_count" value="192.1k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://www.codetea.top/">Codetea</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Reverse</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WEB</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Windows内核</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/%E6%8A%93%E5%8C%85%E6%A3%80%E6%B5%8B%E4%B8%8Ehook%E6%8A%93%E5%8C%85.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向中抓包检测与hook抓包">Android逆向中抓包检测与hook抓包</span>
            <span class="post-date" title="2023-12-27 11:40:21">2023/12/27</span>
        </a>
        
        
        <a  class="全部文章 WEB安全 "
           href="/post/web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0-%E4%BF%A1%E6%81%AF%E6%89%93%E7%82%B9.html"
           data-tag="WEB"
           data-author="" >
            <span class="post-title" title="WEB安全-信息打点">WEB安全-信息打点</span>
            <span class="post-date" title="2023-12-25 12:40:21">2023/12/25</span>
        </a>
        
        
        <a  class="全部文章 WEB安全 "
           href="/post/web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E5%85%A5%E9%97%A8.html"
           data-tag="WEB"
           data-author="" >
            <span class="post-title" title="WEB安全-基础入门">WEB安全-基础入门</span>
            <span class="post-date" title="2023-12-20 11:40:21">2023/12/20</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/Android%E9%80%86%E5%90%91%E4%B8%AD%E5%B8%B8%E8%A7%81%E5%AF%86%E7%A0%81%E5%AD%A6%E5%85%A5%E9%97%A8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向中常见密码学算法入门">Android逆向中常见密码学算法入门</span>
            <span class="post-date" title="2023-11-30 20:40:21">2023/11/30</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/Android%E7%B3%BB%E7%BB%9F%E6%B2%99%E7%9B%92%E5%AE%9A%E5%88%B6%E4%B8%93%E9%A2%98.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android系统沙盒定制">Android系统沙盒定制</span>
            <span class="post-date" title="2023-09-15 12:40:21">2023/09/15</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/unidbg%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向学习笔记——Unidbg学习与实战">Android逆向学习笔记——Unidbg学习与实战</span>
            <span class="post-date" title="2023-07-01 09:00:15">2023/07/01</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/Frida%E7%9A%84Python%E5%BA%93%E4%BD%BF%E7%94%A8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向学习笔记——使用Python库调用Frida">Android逆向学习笔记——使用Python库调用Frida</span>
            <span class="post-date" title="2023-06-01 09:00:15">2023/06/01</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/NDK%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记——NDK开发">Android开发学习笔记——NDK开发</span>
            <span class="post-date" title="2023-03-31 09:00:14">2023/03/31</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code1.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(1)——初识安卓">Android开发学习笔记(1)——初识安卓</span>
            <span class="post-date" title="2023-03-30 09:00:21">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code2.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(2)——探究活动">Android开发学习笔记(2)——探究活动</span>
            <span class="post-date" title="2023-03-30 09:00:20">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code3.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(3)——UI开发">Android开发学习笔记(3)——UI开发</span>
            <span class="post-date" title="2023-03-30 09:00:19">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code4.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(4)——探究碎片">Android开发学习笔记(4)——探究碎片</span>
            <span class="post-date" title="2023-03-30 09:00:18">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code5.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(5)——详解广播机制">Android开发学习笔记(5)——详解广播机制</span>
            <span class="post-date" title="2023-03-30 09:00:17">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code6.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(6)——数据存储全方案">Android开发学习笔记(6)——数据存储全方案</span>
            <span class="post-date" title="2023-03-30 09:00:16">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code7.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(7)——跨程序共享数据">Android开发学习笔记(7)——跨程序共享数据</span>
            <span class="post-date" title="2023-03-30 09:00:15">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(8)——运用手机多媒体">Android开发学习笔记(8)——运用手机多媒体</span>
            <span class="post-date" title="2023-03-30 09:00:14">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code9.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(9)——网络技术">Android开发学习笔记(9)——网络技术</span>
            <span class="post-date" title="2023-03-30 09:00:13">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022%E5%B9%B4%E6%B1%9F%E8%A5%BF%E7%9C%81%E2%80%9C%E8%B5%A3%E8%82%B2%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022年江西省“赣育杯”网络安全大赛初赛 Re WriteUp">2022年江西省“赣育杯”网络安全大赛初赛 Re WriteUp</span>
            <span class="post-date" title="2022-10-08 22:40:21">2022/10/08</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/qwb.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第六届强网杯全国网络安全挑战赛 Re WriteUp">第六届强网杯全国网络安全挑战赛 Re WriteUp</span>
            <span class="post-date" title="2022-08-08 15:49:21">2022/08/08</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/bluecup.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第六届蓝帽杯初赛CTF题目 Re WriteUp">第六届蓝帽杯初赛CTF题目 Re WriteUp</span>
            <span class="post-date" title="2022-07-13 22:49:21">2022/07/13</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/CISCN2022.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第十五届全国大学生信息安全竞赛创新实践能力赛CISCN">第十五届全国大学生信息安全竞赛创新实践能力赛CISCN</span>
            <span class="post-date" title="2022-06-03 20:49:21">2022/06/03</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022DASCTF Apr X FATE 防疫挑战赛">2022DASCTF Apr X FATE 防疫挑战赛</span>
            <span class="post-date" title="2022-06-01 20:49:21">2022/06/01</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/PE%E6%98%A0%E5%83%8F%E5%88%87%E6%8D%A2.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——PE映像切换">逆向工程核心原理——PE映像切换</span>
            <span class="post-date" title="2022-04-02 10:49:21">2022/04/02</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E5%8F%8D%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——反调试技术">逆向工程核心原理——反调试技术</span>
            <span class="post-date" title="2022-03-28 10:30:21">2022/03/28</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022-3-26-2022DASCTF-X-SU-Re-WriteUp.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022DASCTF X SU Re WriteUp">2022DASCTF X SU Re WriteUp</span>
            <span class="post-date" title="2022-03-26 20:49:21">2022/03/26</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/SEH.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——SEH原理分析">逆向工程核心原理——SEH原理分析</span>
            <span class="post-date" title="2022-03-19 10:49:21">2022/03/19</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/TLS%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——TLS回调函数">逆向工程核心原理——TLS回调函数</span>
            <span class="post-date" title="2022-03-15 22:49:21">2022/03/15</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E5%85%A8%E5%B1%80API%E9%92%A9%E5%8F%96-IE%E9%93%BE%E6%8E%A5%E6%8E%A7%E5%88%B6.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——全局API钩取">逆向工程核心原理——全局API钩取</span>
            <span class="post-date" title="2022-03-11 16:49:21">2022/03/11</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E8%AE%A1%E7%AE%97%E5%99%A8%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E6%95%B0%E5%AD%97.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——IAT_HOOK">逆向工程核心原理——IAT_HOOK</span>
            <span class="post-date" title="2022-03-08 22:49:21">2022/03/08</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9PE%E5%8A%A0%E8%BD%BDDLL.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——通过修改PE加载DLL">逆向工程核心原理——通过修改PE加载DLL</span>
            <span class="post-date" title="2022-02-28 22:49:21">2022/02/28</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/DLL%E6%B3%A8%E5%85%A5.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——DLL注入">逆向工程核心原理——DLL注入</span>
            <span class="post-date" title="2022-02-26 00:49:21">2022/02/26</span>
        </a>
        
        
        <a  class="全部文章 Windows内核 "
           href="/post/%E6%AE%B5%E4%B8%8E%E9%A1%B5%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html"
           data-tag="Windows内核"
           data-author="" >
            <span class="post-title" title="Windows内核基础知识-段选择子与段描述符">Windows内核基础知识-段选择子与段描述符</span>
            <span class="post-date" title="2021-10-03 12:40:21">2021/10/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-qwb" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">第六届强网杯全国网络安全挑战赛 Re WriteUp</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color4">CTF</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2022-08-08 15:40:11'>2022-08-08 15:49</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:11.8k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#GameMaster"><span class="toc-text">GameMaster</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#deeprev"><span class="toc-text">deeprev</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easyre"><span class="toc-text">easyre</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Easyre"><span class="toc-text">Easyre</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sub-401F2F"><span class="toc-text">sub_401F2F</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sub-4017E5"><span class="toc-text">sub_4017E5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#re3"><span class="toc-text">re3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sub-2490"><span class="toc-text">sub_2490</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#loc-21F9"><span class="toc-text">loc_21F9</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMC"><span class="toc-text">SMC</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#find-basic"><span class="toc-text">find_basic</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="GameMaster"><a href="#GameMaster" class="headerlink" title="GameMaster"></a>GameMaster</h1><p>老样子先查壳</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805153034.png"></p>
<p>一个C#的程序，可以用dnspy反编译</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805153335.png"></p>
<p>画圈部分是读取gamemessage文件，其他的都是游戏的初始化之类的</p>
<p>当我们按下ESC ,会进入verifyCode(arrayList, game)函数</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805153548.png"></p>
<p>进去发现将输入的字符变成字符串，然后进入goldFunc</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805153611.png"></p>
<p>进去发现是对我们的输入进行比较，然后进行相应的操作，类似小时候玩的GTA里面作弊码</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805153658.png"></p>
<p>简单分析一下，这里的操作主要有对读取的gamemessage文件先进行xor34，然后进行AES解密，我们可以自己解密，也可以重新利用反汇编代码。dnspy可以导入工程到vs里。把一些没用的比较都删了，只留下对文件操作的部分</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">using System<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Collections<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>IO<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Runtime<span class="token punctuation">.</span>Serialization<span class="token punctuation">.</span>Formatters<span class="token punctuation">.</span>Binary<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Security<span class="token punctuation">.</span>Cryptography<span class="token punctuation">;</span>
using System<span class="token punctuation">.</span>Text<span class="token punctuation">;</span>
using Blackjack<span class="token punctuation">;</span>

namespace Game
<span class="token punctuation">&#123;</span>
	internal class Program
	<span class="token punctuation">&#123;</span>
        private <span class="token keyword">static</span> byte<span class="token punctuation">[</span><span class="token punctuation">]</span> memory<span class="token punctuation">;</span>
        private <span class="token keyword">static</span> byte<span class="token punctuation">[</span><span class="token punctuation">]</span> m<span class="token punctuation">;</span>

        private <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
		<span class="token punctuation">&#123;</span>
			ConfigurationManager<span class="token punctuation">.</span>AppSettings<span class="token punctuation">.</span><span class="token function">Set</span><span class="token punctuation">(</span><span class="token string">"microsoft:WorkflowComponentModel:DisableActivitySurrogateSelectorTypeCheck"</span><span class="token punctuation">,</span> <span class="token string">"true"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			FileStream fileStream <span class="token operator">=</span> File<span class="token punctuation">.</span><span class="token function">OpenRead</span><span class="token punctuation">(</span><span class="token string">"gamemessage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>fileStream<span class="token punctuation">.</span>Length<span class="token punctuation">;</span>
			Program<span class="token punctuation">.</span>memory <span class="token operator">=</span> new byte<span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span>
			fileStream<span class="token punctuation">.</span>Position <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>
			fileStream<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span>Program<span class="token punctuation">.</span>memory<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Program<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>Length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>
			<span class="token punctuation">&#123;</span>
				byte<span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> Program<span class="token punctuation">.</span>memory<span class="token punctuation">;</span>
                array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^=</span> <span class="token number">34</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
			byte<span class="token punctuation">[</span><span class="token punctuation">]</span> key <span class="token operator">=</span> new byte<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">115</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">111</span><span class="token punctuation">,</span><span class="token number">114</span><span class="token punctuation">,</span><span class="token number">109</span><span class="token punctuation">,</span><span class="token number">105</span><span class="token punctuation">,</span><span class="token number">110</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">,</span><span class="token number">33</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
			ICryptoTransform cryptoTransform <span class="token operator">=</span> new RijndaelManaged<span class="token punctuation">&#123;</span>Key <span class="token operator">=</span> key<span class="token punctuation">,</span>Mode <span class="token operator">=</span> CipherMode<span class="token punctuation">.</span>ECB<span class="token punctuation">,</span> Padding <span class="token operator">=</span> PaddingMode <span class="token punctuation">.</span>Zeros<span class="token punctuation">&#125;</span><span class="token punctuation">.</span><span class="token function">CreateDecryptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			Program<span class="token punctuation">.</span>m <span class="token operator">=</span> cryptoTransform<span class="token punctuation">.</span><span class="token function">TransformFinalBlock</span><span class="token punctuation">(</span>Program<span class="token punctuation">.</span>memory<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Program<span class="token punctuation">.</span>memory<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">;</span>
			File<span class="token punctuation">.</span><span class="token function">WriteAllBytes</span><span class="token punctuation">(</span><span class="token string">"aa.out"</span><span class="token punctuation">,</span> Program<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>	
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>		<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805154534.png"></p>
<p>这是解密完的样子，里面搜到MZ标志，发现有可执行文件特征</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805154641.png"></p>
<p>把前面都删了，将可执行文件分离出来</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805154741.png"></p>
<p>又是一个C#文件，拖入dnspy分析</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805155037.png"></p>
<p>num,num2,num3是环境变量，然后传入check，传出一个array2数组，与first比较<img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805155041.png"></p>
<p>分析一波check</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220805155144.png"></p>
<p>通过变化生成KeyStream，然后与first比较，这里可以通过Z3反求num,num2,num3</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">:</span>
    num <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    keystream <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">40</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">29</span> <span class="token operator">^</span> x <span class="token operator">>></span> <span class="token number">28</span> <span class="token operator">^</span> x <span class="token operator">>></span> <span class="token number">25</span> <span class="token operator">^</span> x <span class="token operator">>></span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> x <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">30</span> <span class="token operator">^</span> y <span class="token operator">>></span> <span class="token number">27</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">31</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">30</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">29</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">28</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">26</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token number">1</span>

        keystream<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>keystream<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xff</span>
    <span class="token keyword">return</span> keystream

<span class="token keyword">def</span> <span class="token function">getxyz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
    <span class="token comment">#x = 156324965</span>
    <span class="token comment">#y = 868387187</span>
    z <span class="token operator">=</span> BitVec<span class="token punctuation">(</span><span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span>
    num <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    keystream <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">40</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">29</span> <span class="token operator">^</span> x <span class="token operator">>></span> <span class="token number">28</span> <span class="token operator">^</span> x <span class="token operator">>></span> <span class="token number">25</span> <span class="token operator">^</span> x <span class="token operator">>></span> <span class="token number">23</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> x <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        y <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">30</span> <span class="token operator">^</span> y <span class="token operator">>></span> <span class="token number">27</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> y <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        z <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">31</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">30</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">29</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">28</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">26</span> <span class="token operator">^</span> z <span class="token operator">>></span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> z <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            num <span class="token operator">+=</span> <span class="token number">1</span>

        keystream<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>keystream<span class="token punctuation">[</span>num<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x <span class="token operator">>></span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z <span class="token operator">>></span> <span class="token number">32</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>y <span class="token operator">>></span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">101</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">80</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">213</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">163</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">26</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">59</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">38</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">19</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">6</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">173</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">189</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">198</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">166</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">140</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">183</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">42</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">247</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">223</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">106</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">20</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">145</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">37</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">24</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">7</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">22</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">191</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">28</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">110</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">29</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">179</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">227</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">31</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">62</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">33</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">9</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">34</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">13</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">35</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">17</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">36</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">65</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">37</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">22</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">37</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>keystream<span class="token punctuation">[</span><span class="token number">39</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token comment">#getxyz()</span>
key<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">156324965</span><span class="token punctuation">,</span><span class="token number">868387187</span><span class="token punctuation">,</span><span class="token number">3131229747</span><span class="token punctuation">]</span>

encflag<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">60</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">86</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">251</span><span class="token punctuation">,</span><span class="token number">167</span><span class="token punctuation">,</span><span class="token number">108</span><span class="token punctuation">,</span><span class="token number">116</span><span class="token punctuation">,</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token number">207</span><span class="token punctuation">,</span><span class="token number">223</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">103</span><span class="token punctuation">,</span><span class="token number">34</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">251</span><span class="token punctuation">,</span><span class="token number">227</span><span class="token punctuation">]</span>
Key<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">12</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		Key<span class="token punctuation">[</span>i <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>key<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>></span> j <span class="token operator">*</span> <span class="token number">8</span> <span class="token operator">&amp;</span> <span class="token number">255</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>Key<span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	encflag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>encflag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">^</span>Key<span class="token punctuation">[</span>i<span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>Key<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>encflag<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>num,num2,num3都是八字节，64位注意一下。得到num&#x3D;156324965，num2&#x3D;868387187,num3&#x3D;3131229747,然后传入ParseKey生成key,最后就是一个很简单xor。</p>
<h1 id="deeprev"><a href="#deeprev" class="headerlink" title="deeprev"></a>deeprev</h1><p>这题是谷歌ctf2022的模板题，我是直接对着那题的wp复现的</p>
<p><a target="_blank" rel="noopener" href="https://ctf.harrisongreen.me/2022/googlectf/eldar/">https://ctf.harrisongreen.me/2022/googlectf/eldar/</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Author: hgarrereyn</span>
<span class="token comment"># Desc: Lifter solution for GoogleCTF 2022 eldar</span>

<span class="token keyword">import</span> lief
<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Any
<span class="token keyword">from</span> capstone <span class="token keyword">import</span> <span class="token operator">*</span>



md <span class="token operator">=</span> Cs<span class="token punctuation">(</span>CS_ARCH_X86<span class="token punctuation">,</span> CS_MODE_64<span class="token punctuation">)</span>

b <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">try</span><span class="token punctuation">:</span>
    b <span class="token operator">=</span> lief<span class="token punctuation">.</span>ELF<span class="token punctuation">.</span>parse<span class="token punctuation">(</span><span class="token string">'./deeprev'</span><span class="token punctuation">)</span>
<span class="token keyword">except</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">'Must have the ./eldar binary in cwd'</span><span class="token punctuation">)</span>

rela <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> b<span class="token punctuation">.</span>sections <span class="token keyword">if</span> x<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'.rela.dyn'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>rela<span class="token punctuation">)</span>
dynsym <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> b<span class="token punctuation">.</span>sections <span class="token keyword">if</span> x<span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">'.dynsym'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>


<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Symbol</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx<span class="token punctuation">:</span> <span class="token builtin">int</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f's</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>
        
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Reloc</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx<span class="token punctuation">:</span> <span class="token builtin">int</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'r</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">Ref</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    val<span class="token punctuation">:</span> Any
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'&amp;</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>val<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">SymAddr</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sym<span class="token punctuation">:</span> Symbol
    field<span class="token punctuation">:</span> <span class="token builtin">str</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>sym<span class="token punctuation">&#125;</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>field<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">RelocAddr</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    reloc<span class="token punctuation">:</span> Reloc
    field<span class="token punctuation">:</span> <span class="token builtin">str</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>reloc<span class="token punctuation">&#125;</span></span><span class="token string">.</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>field<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span>

    <span class="token keyword">def</span> <span class="token function">vaddr</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        off <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">match</span> self<span class="token punctuation">.</span>field<span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token string">'r_address'</span><span class="token punctuation">:</span>off <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">case</span> <span class="token string">'r_info'</span><span class="token punctuation">:</span> off <span class="token operator">=</span> <span class="token number">8</span>
            <span class="token keyword">case</span> <span class="token string">'r_addend'</span><span class="token punctuation">:</span> off <span class="token operator">=</span> <span class="token number">16</span>
        
        <span class="token keyword">return</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>reloc<span class="token punctuation">.</span>idx <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> off <span class="token operator">+</span> rela<span class="token punctuation">.</span>virtual_address
    
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">FlagAddr</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx<span class="token punctuation">:</span> <span class="token builtin">int</span>
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'flag[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">]'</span></span>

<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">OutAddr</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx<span class="token punctuation">:</span> <span class="token builtin">int</span>
        
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'out[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">]'</span></span>
    
<span class="token decorator annotation punctuation">@dataclass</span>
<span class="token keyword">class</span> <span class="token class-name">ArrAddr</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx<span class="token punctuation">:</span> <span class="token builtin">int</span>
        
    <span class="token keyword">def</span> <span class="token function">__repr__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'arr[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>self<span class="token punctuation">.</span>idx<span class="token punctuation">&#125;</span></span><span class="token string">]'</span></span>

BaseAddr <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'baseaddr'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
FailAddr <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'fail'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">format_addr</span><span class="token punctuation">(</span>addr<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> addr <span class="token operator">>=</span> rela<span class="token punctuation">.</span>virtual_address <span class="token keyword">and</span> addr <span class="token operator">&lt;</span> rela<span class="token punctuation">.</span>virtual_address <span class="token operator">+</span> rela<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
        offset <span class="token operator">=</span> addr <span class="token operator">-</span> rela<span class="token punctuation">.</span>virtual_address
        r_offset <span class="token operator">=</span> <span class="token punctuation">(</span>offset <span class="token operator">//</span> <span class="token number">24</span><span class="token punctuation">)</span>
        r_rem <span class="token operator">=</span> offset <span class="token operator">%</span> <span class="token number">24</span>
        
        <span class="token keyword">if</span> r_offset <span class="token operator">>=</span> <span class="token number">3</span> <span class="token keyword">and</span> r_offset <span class="token operator">&lt;=</span> <span class="token number">88</span><span class="token punctuation">:</span>
            arr_idx <span class="token operator">=</span> <span class="token punctuation">(</span>r_offset <span class="token operator">-</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token punctuation">(</span>r_rem <span class="token operator">//</span> <span class="token number">8</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> ArrAddr<span class="token punctuation">(</span>arr_idx<span class="token punctuation">)</span>
        <span class="token keyword">elif</span> r_offset <span class="token operator">==</span> <span class="token number">89</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> OutAddr<span class="token punctuation">(</span>r_rem<span class="token punctuation">)</span>
        
        <span class="token keyword">match</span> r_rem<span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">return</span> RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_address'</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token keyword">return</span> RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_info'</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token keyword">return</span> RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_addend'</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span> <span class="token keyword">return</span> RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> r_rem<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> addr <span class="token operator">></span> dynsym<span class="token punctuation">.</span>virtual_address <span class="token keyword">and</span> addr <span class="token operator">&lt;</span> dynsym<span class="token punctuation">.</span>virtual_address <span class="token operator">+</span> dynsym<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
        offset <span class="token operator">=</span> addr <span class="token operator">-</span> dynsym<span class="token punctuation">.</span>virtual_address
        r_offset <span class="token operator">=</span> <span class="token punctuation">(</span>offset <span class="token operator">//</span> <span class="token number">24</span><span class="token punctuation">)</span>
        r_rem <span class="token operator">=</span> offset <span class="token operator">%</span> <span class="token number">24</span>
        
        <span class="token keyword">match</span> r_rem<span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">return</span> SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'st_name'</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token keyword">return</span> Symbol<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token keyword">return</span> SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'st_size'</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span> <span class="token keyword">return</span> SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span>r_offset<span class="token punctuation">)</span><span class="token punctuation">,</span> r_rem<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> addr <span class="token operator">>=</span> <span class="token number">0x404040</span> <span class="token keyword">and</span> addr <span class="token operator">&lt;</span> <span class="token number">0x404040</span><span class="token operator">+</span><span class="token number">33</span><span class="token punctuation">:</span>
        off <span class="token operator">=</span> addr<span class="token operator">-</span><span class="token number">0x404040</span>
        <span class="token keyword">return</span> FlagAddr<span class="token punctuation">(</span>off<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> addr <span class="token operator">==</span> <span class="token number">0x804000</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> BaseAddr<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> addr <span class="token operator">==</span> <span class="token number">0x404064</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> FailAddr<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> addr

<span class="token keyword">def</span> <span class="token function">to_sym</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
    <span class="token keyword">return</span> Symbol<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

Rel <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'REL'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span><span class="token string">'val'</span><span class="token punctuation">,</span><span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Copy <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'CPY'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span> <span class="token string">'symbol'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
R64 <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'R64'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span><span class="token string">'symbol'</span><span class="token punctuation">,</span><span class="token string">'addend'</span><span class="token punctuation">,</span><span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
R32 <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'R32'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span><span class="token string">'symbol'</span><span class="token punctuation">,</span><span class="token string">'addend'</span><span class="token punctuation">,</span><span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">parse</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">list</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Loading relocations...'</span><span class="token punctuation">)</span>
    relocs <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>relocations<span class="token punctuation">)</span>
    
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[*] Parsing...'</span><span class="token punctuation">)</span>
    instructions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>relocs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> relocs<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">match</span> r<span class="token punctuation">.</span><span class="token builtin">type</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment"># R64</span>
                instructions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>R64<span class="token punctuation">(</span>format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">,</span> to_sym<span class="token punctuation">(</span>r<span class="token punctuation">.</span>symbol<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>addend<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token comment"># CPY</span>
                instructions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Copy<span class="token punctuation">(</span>format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">,</span> to_sym<span class="token punctuation">(</span>r<span class="token punctuation">.</span>symbol<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token comment"># REL</span>
                instructions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Rel<span class="token punctuation">(</span>format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">,</span> format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>addend<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token comment"># R32</span>
                instructions<span class="token punctuation">.</span>append<span class="token punctuation">(</span>R32<span class="token punctuation">(</span>format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>address<span class="token punctuation">)</span><span class="token punctuation">,</span> to_sym<span class="token punctuation">(</span>r<span class="token punctuation">.</span>symbol<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> format_addr<span class="token punctuation">(</span>r<span class="token punctuation">.</span>addend<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span>
                
    <span class="token keyword">return</span> instructions

Mov <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'mov'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token string">'sz'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Add <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">,</span> <span class="token string">'addend'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_mov_add</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    
    sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    curr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">8</span>
    sizes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>curr<span class="token punctuation">)</span>

    <span class="token keyword">for</span> instr <span class="token keyword">in</span> instructions<span class="token punctuation">:</span>
        c <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>curr<span class="token punctuation">)</span>
        <span class="token keyword">match</span> instr<span class="token punctuation">:</span>
            <span class="token keyword">case</span> Rel<span class="token punctuation">(</span>SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'st_size'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> val<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                c<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> val
        sizes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
    
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> Rel<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> val<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> Mov<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
            <span class="token keyword">case</span> Copy<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> Mov<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> sizes<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">[</span>sym<span class="token punctuation">.</span>idx<span class="token punctuation">]</span><span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
            <span class="token keyword">case</span> R64<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> add<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span> <span class="token operator">=</span> Add<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> sym<span class="token punctuation">,</span> add<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

<span class="token keyword">def</span> <span class="token function">remove_sizes</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Sizes are now nops</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'st_size'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token keyword">if</span> s <span class="token operator">!=</span> <span class="token number">3</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

<span class="token keyword">def</span> <span class="token function">lift_indirect</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                Mov<span class="token punctuation">(</span>RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>rel_1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_addend'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span>sidx_1<span class="token punctuation">)</span><span class="token punctuation">,</span> sz_1<span class="token punctuation">,</span> ridx_1<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>dst_2<span class="token punctuation">,</span> sym_2<span class="token punctuation">,</span> _<span class="token punctuation">,</span> ridx_2<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>rel_3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_addend'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sz_3<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>
                <span class="token punctuation">(</span>rel_1 <span class="token operator">==</span> ridx_2<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>rel_3 <span class="token operator">==</span> ridx_2<span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                    Add<span class="token punctuation">(</span>dst_2<span class="token punctuation">,</span> sym_2<span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span>sidx_1<span class="token punctuation">)</span><span class="token punctuation">,</span> ridx_1<span class="token punctuation">)</span>
                <span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

Block <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'block'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'arr'</span><span class="token punctuation">,</span> <span class="token string">'flag'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
Output <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'output'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'out'</span><span class="token punctuation">,</span> <span class="token string">'arr'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_block</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
 
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>arr<span class="token punctuation">,</span>_<span class="token punctuation">,</span>ridx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>flag<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                R32<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                    Block<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
                <span class="token punctuation">]</span>
        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

Reset <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'reset'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
ShuffleBlock <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'shuffleblock'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'f1'</span><span class="token punctuation">,</span> <span class="token string">'f2'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_reset</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">256</span><span class="token punctuation">:</span>
        good <span class="token operator">=</span> <span class="token boolean">True</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            op <span class="token operator">=</span> instructions<span class="token punctuation">[</span>idx<span class="token operator">+</span>i<span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token operator">==</span> Mov<span class="token punctuation">:</span>
                dst<span class="token punctuation">,</span> src<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _ <span class="token operator">=</span> op
                <span class="token keyword">if</span> dst <span class="token operator">!=</span> ArrAddr<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">or</span> src <span class="token operator">!=</span> Ref<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    good <span class="token operator">=</span> <span class="token boolean">False</span>
                    <span class="token keyword">break</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                good <span class="token operator">=</span> <span class="token boolean">False</span>
                <span class="token keyword">break</span>

        <span class="token keyword">if</span> good<span class="token punctuation">:</span>
            instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>Reset<span class="token punctuation">(</span>instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>ridx<span class="token punctuation">)</span><span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

<span class="token keyword">def</span> <span class="token function">lift_shuffle_block</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">256</span><span class="token punctuation">:</span>
        good <span class="token operator">=</span> <span class="token boolean">True</span>

        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            op <span class="token operator">=</span> instructions<span class="token punctuation">[</span>idx<span class="token operator">+</span>i<span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token operator">==</span> Block<span class="token punctuation">:</span>
                arr<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> ridx <span class="token operator">=</span> op
                <span class="token keyword">if</span> arr <span class="token operator">!=</span> Ref<span class="token punctuation">(</span>ArrAddr<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    good <span class="token operator">=</span> <span class="token boolean">False</span>
                    <span class="token keyword">break</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                good <span class="token operator">=</span> <span class="token boolean">False</span>
                <span class="token keyword">break</span>

        <span class="token keyword">if</span> good<span class="token punctuation">:</span>
            instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">256</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>ShuffleBlock<span class="token punctuation">(</span>instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>flag<span class="token punctuation">,</span> instructions<span class="token punctuation">[</span>idx<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>flag<span class="token punctuation">,</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">.</span>ridx<span class="token punctuation">)</span><span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

Output <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'output'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'out'</span><span class="token punctuation">,</span> <span class="token string">'arr'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_output</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>arr<span class="token punctuation">,</span>_<span class="token punctuation">,</span>ridx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                R32<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                R32<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>out<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">,</span>_<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>Output<span class="token punctuation">(</span>out<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">]</span>
        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

MultAdd <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'multadd'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'out'</span><span class="token punctuation">,</span> <span class="token string">'val'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_multadd</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token comment"># block prefix</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> out<span class="token punctuation">,</span> _<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">:</span>
                k <span class="token operator">=</span> <span class="token number">0</span>
                double <span class="token operator">=</span> <span class="token boolean">False</span>

                ptr <span class="token operator">=</span> idx <span class="token operator">+</span> <span class="token number">3</span>

                good <span class="token operator">=</span> <span class="token boolean">True</span>
                <span class="token keyword">while</span> ptr <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span><span class="token punctuation">:</span>
                        <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            double <span class="token operator">=</span> <span class="token boolean">True</span>
                        <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            double <span class="token operator">=</span> <span class="token boolean">False</span>
                        <span class="token keyword">case</span> Add<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            k <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">if</span> double <span class="token keyword">else</span> <span class="token punctuation">(</span>k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token keyword">case</span> Add<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">:</span>
                            ptr <span class="token operator">+=</span> <span class="token number">1</span>
                            <span class="token keyword">break</span>
                        <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span>
                            good <span class="token operator">=</span> <span class="token boolean">False</span>
                            <span class="token keyword">break</span>

                    ptr <span class="token operator">+=</span> <span class="token number">1</span>
                
                <span class="token keyword">if</span> good<span class="token punctuation">:</span>
                    instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>ptr<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                        MultAdd<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> out<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
                    <span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">return</span> instructions

Trunc <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'trunc'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'val'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_truncate</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span>
            <span class="token punctuation">]</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                    Trunc<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0xffffff</span><span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">]</span>
        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

ArraySlots <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'arr'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_array_slots</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
   
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token number">1300</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>BaseAddr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                ptr <span class="token operator">=</span> idx<span class="token operator">+</span><span class="token number">1</span>
                <span class="token keyword">while</span> ptr <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    op <span class="token operator">=</span> instructions<span class="token punctuation">[</span>ptr<span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token operator">!=</span> Mov <span class="token keyword">or</span> op<span class="token punctuation">.</span>dst <span class="token operator">!=</span> BaseAddr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    ptr <span class="token operator">+=</span> <span class="token number">1</span>

                start <span class="token operator">=</span> idx
                end <span class="token operator">=</span> ptr

                data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

                <span class="token comment"># Check for movs into array.</span>
                vstart <span class="token operator">=</span> RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>ridx<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_address'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>vaddr<span class="token punctuation">(</span><span class="token punctuation">)</span>
                offset <span class="token operator">=</span> <span class="token number">0</span>
                <span class="token keyword">while</span> end <span class="token operator">+</span> offset <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span> <span class="token keyword">and</span> offset <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    op <span class="token operator">=</span> instructions<span class="token punctuation">[</span>end <span class="token operator">+</span> offset<span class="token punctuation">]</span>
                    <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span> <span class="token operator">==</span> Mov <span class="token keyword">and</span> <span class="token builtin">type</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>dst<span class="token punctuation">)</span> <span class="token keyword">is</span> RelocAddr <span class="token keyword">and</span> op<span class="token punctuation">.</span>dst<span class="token punctuation">.</span>vaddr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> vstart <span class="token operator">+</span> <span class="token punctuation">(</span>offset <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>op<span class="token punctuation">.</span>src<span class="token punctuation">.</span>val<span class="token punctuation">)</span>
                    <span class="token keyword">else</span><span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    offset <span class="token operator">+=</span> <span class="token number">1</span>

                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>
                    data <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>   
                    instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>end<span class="token operator">+</span>offset<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                        ArraySlots<span class="token punctuation">(</span>data<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
                    <span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

Shellcode <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'shellcode'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span> <span class="token string">'code'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_shellcode</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                ArraySlots<span class="token punctuation">(</span>values<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>rel2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_address'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>SymAddr<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'st_name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>RelocAddr<span class="token punctuation">(</span>Reloc<span class="token punctuation">(</span>rel6<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'r_address'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span>
            <span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rel2 <span class="token operator">==</span> ridx<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>rel6 <span class="token operator">==</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                    Shellcode<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>x <span class="token operator">&amp;</span> <span class="token number">0xffffffffffffffff</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_bytes<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">'little'</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> values<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
                <span class="token punctuation">]</span>
        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions

Aop <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">'aop'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'dst'</span><span class="token punctuation">,</span> <span class="token string">'op'</span><span class="token punctuation">,</span> <span class="token string">'val'</span><span class="token punctuation">,</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token string">'ridx'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">lift_aop</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    idx <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> idx <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">match</span> instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">case</span> <span class="token punctuation">[</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> val<span class="token punctuation">,</span> _<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Shellcode<span class="token punctuation">(</span>_<span class="token punctuation">,</span> data<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Mov<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>Symbol<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span><span class="token punctuation">,</span>
                Add<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> dst2<span class="token punctuation">,</span> Symbol<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">)</span>
            <span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">24</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>dst <span class="token operator">==</span> dst2<span class="token punctuation">)</span><span class="token punctuation">:</span>
                op <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>md<span class="token punctuation">.</span>disasm<span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

                t <span class="token operator">=</span> op<span class="token punctuation">.</span>mnemonic
                k <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>op<span class="token punctuation">.</span>op_str<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">', '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>

                instructions<span class="token punctuation">[</span>idx<span class="token punctuation">:</span>idx<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
                    Aop<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> t<span class="token punctuation">,</span> val<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span>
                <span class="token punctuation">]</span>

        idx <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> instructions






<span class="token keyword">def</span> <span class="token function">dump</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> op <span class="token keyword">in</span> instructions<span class="token punctuation">:</span>
        <span class="token keyword">match</span> op<span class="token punctuation">:</span>
            <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>SymAddr<span class="token punctuation">(</span>sym<span class="token punctuation">,</span> <span class="token string">'st_name'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> ridx<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">type</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token keyword">is</span> <span class="token builtin">int</span><span class="token punctuation">:</span>
                name <span class="token operator">=</span> val <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span>
                info <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
                other <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xff</span>
                shndx <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffff</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: setinfo </span><span class="token interpolation"><span class="token punctuation">&#123;</span>sym<span class="token punctuation">&#125;</span></span><span class="token string">, name=0x</span><span class="token interpolation"><span class="token punctuation">&#123;</span>name<span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">, info=0x</span><span class="token interpolation"><span class="token punctuation">&#123;</span>info<span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">, other=0x</span><span class="token interpolation"><span class="token punctuation">&#123;</span>other<span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">, shndx=0x</span><span class="token interpolation"><span class="token punctuation">&#123;</span>shndx<span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>BaseAddr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Ref<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> _<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: [ARRAY SLOT]'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> src<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: mov </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>src<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Mov<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> src<span class="token punctuation">,</span> sz<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: mov(</span><span class="token interpolation"><span class="token punctuation">&#123;</span>sz<span class="token punctuation">&#125;</span></span><span class="token string">) </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>src<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Add<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> src<span class="token punctuation">,</span> add<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: add </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>src<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>add<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> R32<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> src<span class="token punctuation">,</span> add<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: r32 </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>src<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>add<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Block<span class="token punctuation">(</span>arr<span class="token punctuation">,</span> flag<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: shuffle </span><span class="token interpolation"><span class="token punctuation">&#123;</span>arr<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>flag<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Output<span class="token punctuation">(</span>out<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: output </span><span class="token interpolation"><span class="token punctuation">&#123;</span>out<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>arr<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> ShuffleBlock<span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: shuffleblock </span><span class="token interpolation"><span class="token punctuation">&#123;</span>f1<span class="token punctuation">&#125;</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">&#123;</span>f2<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> MultAdd<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> val<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: madd </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string"> += (</span><span class="token interpolation"><span class="token punctuation">&#123;</span>val<span class="token punctuation">&#125;</span></span><span class="token string"> * </span><span class="token interpolation"><span class="token punctuation">&#123;</span>k<span class="token punctuation">&#125;</span></span><span class="token string">)'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Aop<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> op<span class="token punctuation">,</span> val<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: aop </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string"> += (</span><span class="token interpolation"><span class="token punctuation">&#123;</span>val<span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>op<span class="token punctuation">&#125;</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>k<span class="token punctuation">&#125;</span></span><span class="token string">)'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Reset<span class="token punctuation">(</span>ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: reset'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Trunc<span class="token punctuation">(</span>val<span class="token punctuation">,</span> k<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: trunc </span><span class="token interpolation"><span class="token punctuation">&#123;</span>val<span class="token punctuation">&#125;</span></span><span class="token string"> &amp;= 0x</span><span class="token interpolation"><span class="token punctuation">&#123;</span>k<span class="token punctuation">:</span><span class="token format-spec">x</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> ArraySlots<span class="token punctuation">(</span>values<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: array [</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token string">", "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">hex</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> values<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">]'</span></span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> Shellcode<span class="token punctuation">(</span>dst<span class="token punctuation">,</span> code<span class="token punctuation">,</span> ridx<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[</span><span class="token interpolation"><span class="token punctuation">&#123;</span>ridx<span class="token punctuation">:</span><span class="token format-spec">04d</span><span class="token punctuation">&#125;</span></span><span class="token string">] :: exec </span><span class="token interpolation"><span class="token punctuation">&#123;</span>dst<span class="token punctuation">&#125;</span></span><span class="token string"> &lt;- </span><span class="token interpolation"><span class="token punctuation">&#123;</span>code<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">)</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> md<span class="token punctuation">.</span>disasm<span class="token punctuation">(</span>code<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">if</span> i<span class="token punctuation">.</span>mnemonic <span class="token operator">==</span> <span class="token string">'ret'</span><span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"    0x%x:\t%s\t%s"</span> <span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>address<span class="token punctuation">,</span> i<span class="token punctuation">.</span>mnemonic<span class="token punctuation">,</span> i<span class="token punctuation">.</span>op_str<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0x8040e4'</span><span class="token punctuation">,</span> <span class="token string">'s5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0x8040cc'</span><span class="token punctuation">,</span> <span class="token string">'s4'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'-'</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">)</span>
            <span class="token keyword">case</span> <span class="token keyword">_</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>op<span class="token punctuation">)</span>

LIFTS <span class="token operator">=</span> <span class="token punctuation">[</span>
    lift_mov_add<span class="token punctuation">,</span>
    remove_sizes<span class="token punctuation">,</span>
    lift_indirect<span class="token punctuation">,</span>
    lift_block<span class="token punctuation">,</span>
    lift_reset<span class="token punctuation">,</span>
    lift_shuffle_block<span class="token punctuation">,</span>
    lift_output<span class="token punctuation">,</span>
    lift_multadd<span class="token punctuation">,</span>
    lift_truncate<span class="token punctuation">,</span>
    lift_array_slots<span class="token punctuation">,</span>
    lift_shellcode<span class="token punctuation">,</span>
    lift_aop<span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">lift</span><span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> lift_fn <span class="token keyword">in</span> LIFTS<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'[*] </span><span class="token interpolation"><span class="token punctuation">&#123;</span>lift_fn<span class="token punctuation">.</span>__name__<span class="token punctuation">&#125;</span></span><span class="token string">...'</span></span><span class="token punctuation">)</span>
        instructions <span class="token operator">=</span> lift_fn<span class="token punctuation">(</span>instructions<span class="token punctuation">)</span>
    <span class="token keyword">return</span> instructions

instructions <span class="token operator">=</span> parse<span class="token punctuation">(</span>b<span class="token punctuation">)</span>
instructions <span class="token operator">=</span> lift<span class="token punctuation">(</span>instructions<span class="token punctuation">)</span>
dump<span class="token punctuation">(</span>instructions<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这题主要是把opcode和data都放到了重定位表里，而lief解析重定位数据和符号引用非常好。跑出来大概有1300行左右的伪代码，然后再转成汇编的样子。</p>
<p>因为伪代码到汇编的转换只需要1300行就够了，后面都是无用指令，所以lift_array_slots函数需要把循环条件缩小到1300行就行了，要不然会去翻译十万行指令，比较浪费时间</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">.rela.dyn           RELA           804272    24fd08    4272      0.767243  ALLOC                         LOAD           
[*] Loading relocations...
[*] Parsing...
[*] lift_mov_add...
[*] remove_sizes...
[*] lift_indirect...
[*] lift_block...
[*] lift_reset...
[*] lift_shuffle_block...
[*] lift_output...
[*] lift_multadd...
[*] lift_truncate...
[*] lift_array_slots...
[*] lift_shellcode...
[*] lift_aop...
REL(dst&#x3D;baseaddr(), val&#x3D;0, ridx&#x3D;3)
REL(dst&#x3D;baseaddr(), val&#x3D;0, ridx&#x3D;4)
[0005] :: mov s2, &amp;flag[0]
[0007] :: mov(1) s4, s2
[0008] :: [ARRAY SLOT]
[0009] :: mov arr[15], &amp;1585408084625667200
[0010] :: mov arr[16], &amp;195

xor	byte ptr [s4], 0x16

[0011] :: mov s3, &amp;arr[15]
[0012] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0013] :: add arr[15], s3, 0
[0014] :: mov s2, &amp;r101002.r_address
[0016] :: mov(24) arr[15], s2
[0017] :: [ARRAY SLOT]
[0018] :: mov arr[42], &amp;141015791240320
[0019] :: mov arr[43], &amp;195

add byte ptr [s4],0

[0020] :: mov s3, &amp;arr[42]
[0021] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0022] :: add arr[42], s3, 0
[0023] :: mov arr[42], s2
[0024] :: mov s2, &amp;s4
[0026] :: mov(1) arr[0], s2
[0027] :: mov s2, &amp;flag[1]
[0028] :: mov s4, s2
[0029] :: [ARRAY SLOT]
[0030] :: mov arr[78], &amp;1657465678663595136
[0031] :: mov arr[79], &amp;195

xor	byte ptr [s4], 0x17

[0032] :: mov s3, &amp;arr[78]
[0033] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0034] :: add arr[78], s3, 0
[0035] :: mov s2, &amp;r101002.r_address
[0037] :: mov(24) arr[78], s2
[0038] :: [ARRAY SLOT]
[0039] :: mov arr[105], &amp;72198609829168256
[0040] :: mov arr[106], &amp;195

add byte ptr [s4],1

[0041] :: mov s3, &amp;arr[105]
[0042] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0043] :: add arr[105], s3, 0
[0044] :: mov arr[105], s2
[0045] :: mov s2, &amp;s4
[0047] :: mov(1) arr[0], s2
[0048] :: mov s2, &amp;flag[2]
[0049] :: mov s4, s2
[0050] :: [ARRAY SLOT]
[0051] :: mov arr[141], &amp;1153062520398099584
[0052] :: mov arr[142], &amp;195

xor	byte ptr [s4], 0x10

[0053] :: mov s3, &amp;arr[141]
[0054] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0055] :: add arr[141], s3, 0
[0056] :: mov s2, &amp;r101002.r_address
[0058] :: mov(24) arr[141], s2
[0059] :: [ARRAY SLOT]
[0060] :: mov arr[168], &amp;144256203867096192
[0061] :: mov arr[169], &amp;195

add byte ptr [s4],2

[0062] :: mov s3, &amp;arr[168]
[0063] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0064] :: add arr[168], s3, 0
[0065] :: mov arr[168], s2
[0066] :: mov s2, &amp;s4
[0068] :: mov(1) arr[0], s2
[0069] :: mov s2, &amp;flag[3]
[0070] :: mov s4, s2
[0071] :: [ARRAY SLOT]
[0072] :: mov arr[204], &amp;1297177708473955456
[0073] :: mov arr[205], &amp;195

xor	byte ptr [s4], 0x12

[0074] :: mov s3, &amp;arr[204]
[0075] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0076] :: add arr[204], s3, 0
[0077] :: mov s2, &amp;r101002.r_address
[0079] :: mov(24) arr[204], s2
[0080] :: [ARRAY SLOT]
[0081] :: mov arr[231], &amp;216313797905024128
[0082] :: mov arr[232], &amp;195

add byte ptr [s4],3

[0083] :: mov s3, &amp;arr[231]
[0084] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0085] :: add arr[231], s3, 0
[0086] :: mov arr[231], s2
[0087] :: mov s2, &amp;s4
[0089] :: mov(1) arr[0], s2
[0090] :: mov s2, &amp;flag[4]
[0091] :: mov s4, s2
[0092] :: exec r92.r_address &lt;- 803425cc40800010c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x10
--------------------
[0101] :: array [0x4008040cc250480, 0xc3, 0x0]
[0104] :: mov s3, &amp;r101.r_address
[0105] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0106] :: add r101.r_address, s3, 0
[0107] :: mov r101.r_address, s2
[0108] :: mov s2, &amp;s4
[0110] :: mov(1) arr[0], s2
[0111] :: mov s2, &amp;flag[5]
[0112] :: mov s4, s2
[0113] :: exec r113.r_address &lt;- 803425cc40800011c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x11
--------------------
[0122] :: array [0x5008040cc250480, 0xc3, 0x0]
[0125] :: mov s3, &amp;r122.r_address
[0126] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0127] :: add r122.r_address, s3, 0
[0128] :: mov r122.r_address, s2
[0129] :: mov s2, &amp;s4
[0131] :: mov(1) arr[0], s2
[0132] :: mov s2, &amp;flag[6]
[0133] :: mov s4, s2
[0134] :: exec r134.r_address &lt;- 803425cc40800012c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x12
--------------------
[0143] :: array [0x6008040cc250480, 0xc3, 0x0]
[0146] :: mov s3, &amp;r143.r_address
[0147] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0148] :: add r143.r_address, s3, 0
[0149] :: mov r143.r_address, s2
[0150] :: mov s2, &amp;s4
[0152] :: mov(1) arr[0], s2
[0153] :: mov s2, &amp;flag[7]
[0154] :: mov s4, s2
[0155] :: exec r155.r_address &lt;- 803425cc40800013c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x13
--------------------
[0164] :: array [0x7008040cc250480, 0xc3, 0x0]
[0167] :: mov s3, &amp;r164.r_address
[0168] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0169] :: add r164.r_address, s3, 0
[0170] :: mov r164.r_address, s2
[0171] :: mov s2, &amp;s4
[0173] :: mov(1) arr[0], s2
[0174] :: mov s2, &amp;flag[8]
[0175] :: mov s4, s2
[0176] :: exec r176.r_address &lt;- 803425cc40800014c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x14
--------------------
[0185] :: array [0x8008040cc250480, 0xc3, 0x0]
[0188] :: mov s3, &amp;r185.r_address
[0189] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0190] :: add r185.r_address, s3, 0
[0191] :: mov r185.r_address, s2
[0192] :: mov s2, &amp;s4
[0194] :: mov(1) arr[1], s2
[0195] :: mov s2, &amp;flag[9]
[0196] :: mov s4, s2
[0197] :: exec r197.r_address &lt;- 803425cc40800015c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x15
--------------------
[0206] :: array [0x9008040cc250480, 0xc3, 0x0]
[0209] :: mov s3, &amp;r206.r_address
[0210] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0211] :: add r206.r_address, s3, 0
[0212] :: mov r206.r_address, s2
[0213] :: mov s2, &amp;s4
[0215] :: mov(1) arr[1], s2
[0216] :: mov s2, &amp;flag[10]
[0217] :: mov s4, s2
[0218] :: exec r218.r_address &lt;- 803425cc40800016c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x16
--------------------
[0227] :: array [0xa008040cc250480, 0xc3, 0x0]
[0230] :: mov s3, &amp;r227.r_address
[0231] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0232] :: add r227.r_address, s3, 0
[0233] :: mov r227.r_address, s2
[0234] :: mov s2, &amp;s4
[0236] :: mov(1) arr[1], s2
[0237] :: mov s2, &amp;flag[11]
[0238] :: mov s4, s2
[0239] :: exec r239.r_address &lt;- 803425cc40800017c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x17
--------------------
[0248] :: array [0xb008040cc250480, 0xc3, 0x0]
[0251] :: mov s3, &amp;r248.r_address
[0252] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0253] :: add r248.r_address, s3, 0
[0254] :: mov r248.r_address, s2
[0255] :: mov s2, &amp;s4
[0257] :: mov(1) arr[1], s2
[0258] :: mov s2, &amp;flag[12]
[0259] :: mov s4, s2
[0260] :: exec r260.r_address &lt;- 803425cc40800018c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x18
--------------------
[0269] :: array [0xc008040cc250480, 0xc3, 0x0]
[0272] :: mov s3, &amp;r269.r_address
[0273] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0274] :: add r269.r_address, s3, 0
[0275] :: mov r269.r_address, s2
[0276] :: mov s2, &amp;s4
[0278] :: mov(1) arr[1], s2
[0279] :: mov s2, &amp;flag[13]
[0280] :: mov s4, s2
[0281] :: exec r281.r_address &lt;- 803425cc40800019c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x19
--------------------
[0290] :: array [0xd008040cc250480, 0xc3, 0x0]
[0293] :: mov s3, &amp;r290.r_address
[0294] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0295] :: add r290.r_address, s3, 0
[0296] :: mov r290.r_address, s2
[0297] :: mov s2, &amp;s4
[0299] :: mov(1) arr[1], s2
[0300] :: mov s2, &amp;flag[14]
[0301] :: mov s4, s2
[0302] :: exec r302.r_address &lt;- 803425cc40800024c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x24
--------------------
[0311] :: array [0xe008040cc250480, 0xc3, 0x0]
[0314] :: mov s3, &amp;r311.r_address
[0315] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0316] :: add r311.r_address, s3, 0
[0317] :: mov r311.r_address, s2
[0318] :: mov s2, &amp;s4
[0320] :: mov(1) arr[1], s2
[0321] :: mov s2, &amp;flag[15]
[0322] :: mov s4, s2
[0323] :: exec r323.r_address &lt;- 803425cc4080002cc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x2c
--------------------
[0332] :: array [0xf008040cc250480, 0xc3, 0x0]
[0335] :: mov s3, &amp;r332.r_address
[0336] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0337] :: add r332.r_address, s3, 0
[0338] :: mov r332.r_address, s2
[0339] :: mov s2, &amp;s4
[0341] :: mov(1) arr[1], s2
[0342] :: mov s2, &amp;flag[16]
[0343] :: mov s4, s2
[0344] :: exec r344.r_address &lt;- 803425cc40800026c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x26
--------------------
[0353] :: array [0x10008040cc250480, 0xc3, 0x0]
[0356] :: mov s3, &amp;r353.r_address
[0357] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0358] :: add r353.r_address, s3, 0
[0359] :: mov r353.r_address, s2
[0360] :: mov s2, &amp;s4
[0362] :: mov(1) arr[2], s2
[0363] :: mov s2, &amp;flag[17]
[0364] :: mov s4, s2
[0365] :: exec r365.r_address &lt;- 803425cc4080001ec3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x1e
--------------------
[0374] :: array [0x11008040cc250480, 0xc3, 0x0]
[0377] :: mov s3, &amp;r374.r_address
[0378] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0379] :: add r374.r_address, s3, 0
[0380] :: mov r374.r_address, s2
[0381] :: mov s2, &amp;s4
[0383] :: mov(1) arr[2], s2
[0384] :: mov s2, &amp;flag[18]
[0385] :: mov s4, s2
[0386] :: exec r386.r_address &lt;- 803425cc4080001fc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x1f
--------------------
[0395] :: array [0x12008040cc250480, 0xc3, 0x0]
[0398] :: mov s3, &amp;r395.r_address
[0399] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0400] :: add r395.r_address, s3, 0
[0401] :: mov r395.r_address, s2
[0402] :: mov s2, &amp;s4
[0404] :: mov(1) arr[2], s2
[0405] :: mov s2, &amp;flag[19]
[0406] :: mov s4, s2
[0407] :: exec r407.r_address &lt;- 803425cc40800020c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x20
--------------------
[0416] :: array [0x13008040cc250480, 0xc3, 0x0]
[0419] :: mov s3, &amp;r416.r_address
[0420] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0421] :: add r416.r_address, s3, 0
[0422] :: mov r416.r_address, s2
[0423] :: mov s2, &amp;s4
[0425] :: mov(1) arr[2], s2
[0426] :: mov s2, &amp;flag[20]
[0427] :: mov s4, s2
[0428] :: exec r428.r_address &lt;- 803425cc40800020c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x20
--------------------
[0437] :: array [0x14008040cc250480, 0xc3, 0x0]
[0440] :: mov s3, &amp;r437.r_address
[0441] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0442] :: add r437.r_address, s3, 0
[0443] :: mov r437.r_address, s2
[0444] :: mov s2, &amp;s4
[0446] :: mov(1) arr[2], s2
[0447] :: mov s2, &amp;flag[21]
[0448] :: mov s4, s2
[0449] :: exec r449.r_address &lt;- 803425cc40800021c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x21
--------------------
[0458] :: array [0x15008040cc250480, 0xc3, 0x0]
[0461] :: mov s3, &amp;r458.r_address
[0462] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0463] :: add r458.r_address, s3, 0
[0464] :: mov r458.r_address, s2
[0465] :: mov s2, &amp;s4
[0467] :: mov(1) arr[2], s2
[0468] :: mov s2, &amp;flag[22]
[0469] :: mov s4, s2
[0470] :: exec r470.r_address &lt;- 803425cc40800023c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x23
--------------------
[0479] :: array [0x16008040cc250480, 0xc3, 0x0]
[0482] :: mov s3, &amp;r479.r_address
[0483] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0484] :: add r479.r_address, s3, 0
[0485] :: mov r479.r_address, s2
[0486] :: mov s2, &amp;s4
[0488] :: mov(1) arr[2], s2
[0489] :: mov s2, &amp;flag[23]
[0490] :: mov s4, s2
[0491] :: exec r491.r_address &lt;- 803425cc40800027c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x27
--------------------
[0500] :: array [0x17008040cc250480, 0xc3, 0x0]
[0503] :: mov s3, &amp;r500.r_address
[0504] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0505] :: add r500.r_address, s3, 0
[0506] :: mov r500.r_address, s2
[0507] :: mov s2, &amp;s4
[0509] :: mov(1) arr[2], s2
[0510] :: mov s2, &amp;flag[24]
[0511] :: mov s4, s2
[0512] :: exec r512.r_address &lt;- 803425cc40800024c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x24
--------------------
[0521] :: array [0x18008040cc250480, 0xc3, 0x0]
[0524] :: mov s3, &amp;r521.r_address
[0525] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0526] :: add r521.r_address, s3, 0
[0527] :: mov r521.r_address, s2
[0528] :: mov s2, &amp;s4
[0530] :: mov(1) arr[3], s2
[0531] :: mov s2, &amp;flag[25]
[0532] :: mov s4, s2
[0533] :: exec r533.r_address &lt;- 803425cc40800025c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x25
--------------------
[0542] :: array [0x19008040cc250480, 0xc3, 0x0]
[0545] :: mov s3, &amp;r542.r_address
[0546] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0547] :: add r542.r_address, s3, 0
[0548] :: mov r542.r_address, s2
[0549] :: mov s2, &amp;s4
[0551] :: mov(1) arr[3], s2
[0552] :: mov s2, &amp;flag[26]
[0553] :: mov s4, s2
[0554] :: exec r554.r_address &lt;- 803425cc40800026c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x26
--------------------
[0563] :: array [0x1a008040cc250480, 0xc3, 0x0]
[0566] :: mov s3, &amp;r563.r_address
[0567] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0568] :: add r563.r_address, s3, 0
[0569] :: mov r563.r_address, s2
[0570] :: mov s2, &amp;s4
[0572] :: mov(1) arr[3], s2
[0573] :: mov s2, &amp;flag[27]
[0574] :: mov s4, s2
[0575] :: exec r575.r_address &lt;- 803425cc40800027c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [s4], 0x27
--------------------
[0584] :: array [0x1b008040cc250480, 0xc3, 0x0]
[0587] :: mov s3, &amp;r584.r_address
[0588] :: setinfo s3, name&#x3D;0x1a, info&#x3D;0x1, other&#x3D;0x0, shndx&#x3D;0x0
[0589] :: add r584.r_address, s3, 0
[0590] :: mov r584.r_address, s2
[0591] :: mov s2, &amp;s4
[0593] :: mov(1) arr[3], s2
[0594] :: mov s4, &amp;0
[0595] :: mov fail(), &amp;0
[0596] :: mov s5, &amp;0
[0597] :: mov s2, &amp;arr[0]
[0599] :: mov s6, s2
[0600] :: exec r600.r_address &lt;- 803425fc40800070c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x70
--------------------
[0609] :: mov s2, &amp;s6
[0611] :: add s5, s5, s2
[0614] :: mov s6, &amp;0
[0615] :: mov s2, &amp;arr[0]
[0616] :: mov s6, s2
[0617] :: exec r617.r_address &lt;- 803425fc4080007cc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x7c
--------------------
[0626] :: mov s2, &amp;s6
[0628] :: add s5, s5, s2
[0631] :: mov s6, &amp;0
[0632] :: mov s2, &amp;arr[0]
[0633] :: mov s6, s2
[0634] :: exec r634.r_address &lt;- 803425fc40800073c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x73
--------------------
[0643] :: mov s2, &amp;s6
[0645] :: add s5, s5, s2
[0648] :: mov s6, &amp;0
[0649] :: mov s2, &amp;arr[0]
[0650] :: mov s6, s2
[0651] :: exec r651.r_address &lt;- 803425fc40800078c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x78
--------------------
[0660] :: mov s2, &amp;s6
[0662] :: add s5, s5, s2
[0665] :: mov s6, &amp;0
[0666] :: mov s2, &amp;arr[0]
[0667] :: mov s6, s2
[0668] :: exec r668.r_address &lt;- 803425fc4080006fc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x6f
--------------------
[0677] :: mov s2, &amp;s6
[0679] :: add s5, s5, s2
[0682] :: mov s6, &amp;0
[0683] :: mov s2, &amp;arr[0]
[0684] :: mov s6, s2
[0685] :: exec r685.r_address &lt;- 803425fc40800027c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x27
--------------------
[0694] :: mov s2, &amp;s6
[0696] :: add s5, s5, s2
[0699] :: mov s6, &amp;0
[0700] :: mov s2, &amp;arr[0]
[0701] :: mov s6, s2
[0702] :: exec r702.r_address &lt;- 803425fc4080002ac3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x2a
--------------------
[0711] :: mov s2, &amp;s6
[0713] :: add s5, s5, s2
[0716] :: mov s6, &amp;0
[0717] :: mov s2, &amp;arr[0]
[0718] :: mov s6, s2
[0719] :: exec r719.r_address &lt;- 803425fc4080002cc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x2c
--------------------
[0728] :: mov s2, &amp;s6
[0730] :: add s5, s5, s2
[0733] :: mov s6, &amp;0
[0734] :: mov s2, &amp;arr[1]
[0735] :: mov s6, s2
[0736] :: exec r736.r_address &lt;- 803425fc4080007fc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x7f
--------------------
[0745] :: mov s2, &amp;s6
[0747] :: add s5, s5, s2
[0750] :: mov s6, &amp;0
[0751] :: mov s2, &amp;arr[1]
[0752] :: mov s6, s2
[0753] :: exec r753.r_address &lt;- 803425fc40800035c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x35
--------------------
[0762] :: mov s2, &amp;s6
[0764] :: add s5, s5, s2
[0767] :: mov s6, &amp;0
[0768] :: mov s2, &amp;arr[1]
[0769] :: mov s6, s2
[0770] :: exec r770.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x2d
--------------------
[0779] :: mov s2, &amp;s6
[0781] :: add s5, s5, s2
[0784] :: mov s6, &amp;0
[0785] :: mov s2, &amp;arr[1]
[0786] :: mov s6, s2
[0787] :: exec r787.r_address &lt;- 803425fc40800032c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x32
--------------------
[0796] :: mov s2, &amp;s6
[0798] :: add s5, s5, s2
[0801] :: mov s6, &amp;0
[0802] :: mov s2, &amp;arr[1]
[0803] :: mov s6, s2
[0804] :: exec r804.r_address &lt;- 803425fc40800037c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x37
--------------------
[0813] :: mov s2, &amp;s6
[0815] :: add s5, s5, s2
[0818] :: mov s6, &amp;0
[0819] :: mov s2, &amp;arr[1]
[0820] :: mov s6, s2
[0821] :: exec r821.r_address &lt;- 803425fc4080003bc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x3b
--------------------
[0830] :: mov s2, &amp;s6
[0832] :: add s5, s5, s2
[0835] :: mov s6, &amp;0
[0836] :: mov s2, &amp;arr[1]
[0837] :: mov s6, s2
[0838] :: exec r838.r_address &lt;- 803425fc40800022c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x22
--------------------
[0847] :: mov s2, &amp;s6
[0849] :: add s5, s5, s2
[0852] :: mov s6, &amp;0
[0853] :: mov s2, &amp;arr[1]
[0854] :: mov s6, s2
[0855] :: exec r855.r_address &lt;- 803425fc40800059c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x59
--------------------
[0864] :: mov s2, &amp;s6
[0866] :: add s5, s5, s2
[0869] :: mov s6, &amp;0
[0870] :: mov s2, &amp;arr[2]
[0871] :: mov s6, s2
[0872] :: exec r872.r_address &lt;- 803425fc40800053c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x53
--------------------
[0881] :: mov s2, &amp;s6
[0883] :: add s5, s5, s2
[0886] :: mov s6, &amp;0
[0887] :: mov s2, &amp;arr[2]
[0888] :: mov s6, s2
[0889] :: exec r889.r_address &lt;- 803425fc4080008ec3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x8e
--------------------
[0898] :: mov s2, &amp;s6
[0900] :: add s5, s5, s2
[0903] :: mov s6, &amp;0
[0904] :: mov s2, &amp;arr[2]
[0905] :: mov s6, s2
[0906] :: exec r906.r_address &lt;- 803425fc4080003dc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x3d
--------------------
[0915] :: mov s2, &amp;s6
[0917] :: add s5, s5, s2
[0920] :: mov s6, &amp;0
[0921] :: mov s2, &amp;arr[2]
[0922] :: mov s6, s2
[0923] :: exec r923.r_address &lt;- 803425fc4080002ac3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x2a
--------------------
[0932] :: mov s2, &amp;s6
[0934] :: add s5, s5, s2
[0937] :: mov s6, &amp;0
[0938] :: mov s2, &amp;arr[2]
[0939] :: mov s6, s2
[0940] :: exec r940.r_address &lt;- 803425fc40800059c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x59
--------------------
[0949] :: mov s2, &amp;s6
[0951] :: add s5, s5, s2
[0954] :: mov s6, &amp;0
[0955] :: mov s2, &amp;arr[2]
[0956] :: mov s6, s2
[0957] :: exec r957.r_address &lt;- 803425fc40800027c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x27
--------------------
[0966] :: mov s2, &amp;s6
[0968] :: add s5, s5, s2
[0971] :: mov s6, &amp;0
[0972] :: mov s2, &amp;arr[2]
[0973] :: mov s6, s2
[0974] :: exec r974.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x2d
--------------------
[0983] :: mov s2, &amp;s6
[0985] :: add s5, s5, s2
[0988] :: mov s6, &amp;0
[0989] :: mov s2, &amp;arr[2]
[0990] :: mov s6, s2
[0991] :: exec r991.r_address &lt;- 803425fc40800029c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x29
--------------------
[1000] :: mov s2, &amp;s6
[1002] :: add s5, s5, s2
[1005] :: mov s6, &amp;0
[1006] :: mov s2, &amp;arr[3]
[1007] :: mov s6, s2
[1008] :: exec r1008.r_address &lt;- 803425fc40800034c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x34
--------------------
[1017] :: mov s2, &amp;s6
[1019] :: add s5, s5, s2
[1022] :: mov s6, &amp;0
[1023] :: mov s2, &amp;arr[3]
[1024] :: mov s6, s2
[1025] :: exec r1025.r_address &lt;- 803425fc4080002dc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x2d
--------------------
[1034] :: mov s2, &amp;s6
[1036] :: add s5, s5, s2
[1039] :: mov s6, &amp;0
[1040] :: mov s2, &amp;arr[3]
[1041] :: mov s6, s2
[1042] :: exec r1042.r_address &lt;- 803425fc40800061c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x61
--------------------
[1051] :: mov s2, &amp;s6
[1053] :: add s5, s5, s2
[1056] :: mov s6, &amp;0
[1057] :: mov s2, &amp;arr[3]
[1058] :: mov s6, s2
[1059] :: exec r1059.r_address &lt;- 803425fc40800032c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x8040fc], 0x32
--------------------
[1068] :: mov s2, &amp;s6
[1070] :: add s5, s5, s2
[1073] :: mov s6, &amp;0
[1074] :: mov s2, &amp;flag[28]
 s2 &#x3D; flag[28]
[1075] :: mov s6, s2
 s6 &#x3D; s2 &#x3D; flag[28]
[1076] :: mov s2, &amp;flag[29]
 s2 &#x3D; flag[29]
[1077] :: mov s7, s2
 s7 &#x3D; s2 &#x3D; flag[29]
[1078] :: mov s8, &amp;0
 s8 &#x3D; 0
[1079] :: mov s2, &amp;s8
 s2 &#x3D; s8 &#x3D;0
[1080] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; 0
[1083] :: mov s2, &amp;s6
 s2 &#x3D; s6
[1084] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; flag[28]
[1087] :: mov s9, &amp;0
 s9 &#x3D; 0
[1088] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; 0
[1089] :: add s9, s9, s2
 s9 &#x3D; s9 + s2 &#x3D; 0
[1092] :: mov s2, &amp;s7
 s2 &#x3D; s7 &#x3D; flag[29]
[1093] :: add s9, s9, s2
 s9 &#x3D; s9 + s2 &#x3D; flag[29]
[1096] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; flag[29]
[1097] :: add s10, s8, s2
 s10 &#x3D; s8 + s2 &#x3D; flag[28] + flag[29]
[1100] :: exec r1100.r_address &lt;- 8034255c4180006cc3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x80415c], 0x6c
--------------------
[1109] :: mov s2, &amp;s10
[1111] :: add s5, s5, s2
[1114] :: mov s6, &amp;0
[1115] :: mov s7, &amp;0
[1116] :: mov s8, &amp;0
[1117] :: mov s9, &amp;0
[1118] :: mov s10, &amp;0
[1119] :: mov s2, &amp;flag[28]
 s2 &#x3D; flag[28]
[1120] :: mov s6, s2
 s6 &#x3D; s2 &#x3D; flag[28]
[1121] :: mov s2, &amp;flag[29]
 s2 &#x3D; flag[29]
[1122] :: mov s7, s2
 s7 &#x3D; s2 &#x3D; flag[29]
[1123] :: mov s8, &amp;0
 s8 &#x3D; 0
[1124] :: mov s2, &amp;s8
 s2 &#x3D; s8 &#x3D;0
[1125] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; 0
[1128] :: mov s2, &amp;s6
 s2 &#x3D; s6
[1129] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; flag[28]
[1132] :: mov s2, &amp;s8
 s2 &#x3D; s8 &#x3D; flag[28]
[1133] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; flag[28] + flag[28]
[1136] :: mov s9, &amp;0
 s9 &#x3D; 0
[1137] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; 0
[1138] :: add s9, s9, s2
 s9 &#x3D; s9 + s2 &#x3D; 0
[1141] :: mov s2, &amp;s7
 s2 &#x3D; s7 &#x3D; flag[29]
[1142] :: add s9, s9, s2
 s9 &#x3D; s9 + s2 &#x3D; flag[29]
[1145] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; flag[29]
[1146] :: add s10, s8, s2
 s10 &#x3D; s8 + s2 &#x3D; 2*flag[28] + flag[29]
[1149] :: exec r1149.r_address &lt;- 8034255c418000a1c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x80415c], 0xa1
--------------------
[1158] :: mov s2, &amp;s10
[1160] :: add s5, s5, s2
[1163] :: mov s6, &amp;0
[1164] :: mov s7, &amp;0
[1165] :: mov s8, &amp;0
[1166] :: mov s9, &amp;0
[1167] :: mov s10, &amp;0
[1168] :: mov s2, &amp;flag[30]
 s2 &#x3D; flag[30]
[1169] :: mov s6, s2
 s6 &#x3D; s2 &#x3D; flag[30]
[1170] :: mov s2, &amp;flag[31]
 s2 &#x3D; flag[31]
[1171] :: mov s7, s2
 s7 &#x3D; s2 &#x3D; flag[31]
[1172] :: mov s8, &amp;0
 s8 &#x3D; 0
[1173] :: mov s2, &amp;s8
 s2 &#x3D; s8 &#x3D; 0
[1174] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; 0
[1177] :: mov s2, &amp;s6
 s2 &#x3D; s6 &#x3D; flag[30]
[1178] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; flag[30]
[1181] :: mov s9, &amp;0
 s9 &#x3D; 0
[1182] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; 0
[1183] :: add s9, s9, s2 
 s9 &#x3D; s9 + s2 &#x3D; 0
[1186] :: mov s2, &amp;s7
 s2 &#x3D; s7 &#x3D; flag[31]
[1187] :: add s9, s9, s2
 s9 &#x3D; s9 + s2 &#x3D; flag[31]
[1190] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; flag[31]
[1191] :: add s10, s8, s2
 s10 &#x3D; s8 + s2 &#x3D; flag[31] + flag[30]
[1194] :: exec r1194.r_address &lt;- 8034255c418000b1c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x80415c], 0xb1
--------------------
[1203] :: mov s2, &amp;s10
[1205] :: add s5, s5, s2
[1208] :: mov s6, &amp;0
[1209] :: mov s7, &amp;0
[1210] :: mov s8, &amp;0
[1211] :: mov s9, &amp;0
[1212] :: mov s10, &amp;0
[1213] :: mov s2, &amp;flag[30]
 s2 &#x3D; flag[30]
[1214] :: mov s6, s2
 s6 &#x3D; s2 &#x3D; flag[30]
[1215] :: mov s2, &amp;flag[31]
 s2 &#x3D; flag[31]
[1216] :: mov s7, s2
 s7 &#x3D; s2 &#x3D; flag[31]
[1217] :: mov s8, &amp;0
 s8 &#x3D; 0
[1218] :: mov s2, &amp;s8
 s2 &#x3D; s8 &#x3D; 0
[1219] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; 0 
[1222] :: mov s2, &amp;s6
 s2 &#x3D; s6 &#x3D; flag[30]
[1223] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; flag[30]
[1226] :: mov s2, &amp;s8
 s2 &#x3D; s8
[1227] :: add s8, s8, s2
 s8 &#x3D; s8 + s2 &#x3D; 2*flag[30] 
[1230] :: mov s9, &amp;0
 s9 &#x3D; 0
[1231] :: mov s2, &amp;s9
 s2 &#x3D; s9 &#x3D; 0 
[1232] :: add s9, s9, s2
 s9 &#x3D; s9 + s2 &#x3D; 0
[1235] :: mov s2, &amp;s7
 s2&#x3D; s7
[1236] :: add s9, s9, s2
 s9&#x3D; s9 + s2 &#x3D; flag[31]
[1239] :: mov s2, &amp;s9
 s2 &#x3D;s9
[1240] :: add s10, s8, s2
 s10 &#x3D; s8 + s2 &#x3D; 2*flag[30] + flag[31]
[1243] :: exec r1243.r_address &lt;- 8034255c418000e5c3000000000000000000000000000000
--------------------
    0x0:	xor	byte ptr [0x80415c], 0xe5
--------------------
[1252] :: mov s2, &amp;s10
[1254] :: add s5, s5, s2
[1257] :: mov s6, &amp;0
[1258] :: mov s7, &amp;0
[1259] :: mov s8, &amp;0
[1260] :: mov s9, &amp;0
[1261] :: mov s10, &amp;0
[1262] :: mov s2, &amp;s5
[1264] :: mov(1) fail(), s2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>我直接ctrl+c停止的，后面打印的都没有用，当然也可以修改脚本里面的dump函数</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806000538.png"></p>
<p>195的十六进制是C3,也就是汇编指令的ret<img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806000654.png"></p>
<p>所以怀疑这一段常数都是机器码，转成十六进制看看</p>
<p>1585408084625667200转成16进制1600 8040 CC25 3480，小端序转一下803425CC40800016</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806001009.png"></p>
<p>和这条比较像，27对应的是xor 0x27，那么16应该对应的是xor 16</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806001755.png"></p>
<p>141015791240320转成十六进制800425CC4080</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806003507.png"></p>
<p>最后总结一下前面的机器码的功能</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">xor      byte ptr [s4], 0x16
add      byte ptr [s4],0
xor      byte ptr [s4], 0x17
add      byte ptr [s4],1
xor      byte ptr [s4], 0x10
add      byte ptr [s4],2
xor	     byte ptr [s4], 0x12
add      byte ptr [s4],3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>伪代码大致可以分为三部分：第一部分对输入前28个字节进行异或和加常数；第二部分异或固定值来进行比较；第三部分可以通过题目提示进行hash爆破</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">keystream<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">]</span>
enc<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>keystream<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>enc<span class="token punctuation">)</span><span class="token punctuation">)</span>
t<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">28</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>keystream<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
   t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span>enc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">^</span>keystream<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>t<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>得到flag{366c950370fec47e34581a0，然后爆破hash</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib

xor<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>xor<span class="token punctuation">)</span><span class="token punctuation">)</span>
encflag<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>encflag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span>encflag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token operator">^</span>xor<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>

s <span class="token operator">=</span> <span class="token string">"flag&#123;366c950370fec47e34581a0"</span>
l <span class="token operator">=</span> <span class="token string">"1234567890abcdef"</span>
<span class="token keyword">for</span> a <span class="token keyword">in</span> l<span class="token punctuation">:</span>
    <span class="token keyword">for</span> b <span class="token keyword">in</span> l<span class="token punctuation">:</span>
        <span class="token keyword">for</span> c <span class="token keyword">in</span> l<span class="token punctuation">:</span>
            flag <span class="token operator">=</span> s<span class="token operator">+</span>a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span><span class="token string">"&#125;"</span>
            sha <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> sha<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"f860464d767610bb"</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
                <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>当然我们也可以分析flag最后一部分，详细解析都在上面的伪代码里</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806011555.png"></p>
<p>其实就是一个方程组求解，可以用z3</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
s <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
flag_end <span class="token operator">=</span> <span class="token punctuation">[</span>BitVec<span class="token punctuation">(</span><span class="token string">'f%d'</span><span class="token operator">%</span>i<span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag_end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> flag_end<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0x6c</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>flag_end<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> flag_end<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xa1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag_end<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> flag_end<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xb1</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>flag_end<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> flag_end<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0xe5</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

t<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> t<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="easyre"><a href="#easyre" class="headerlink" title="easyre"></a>easyre</h1><h2 id="Easyre"><a href="#Easyre" class="headerlink" title="Easyre"></a>Easyre</h2><p>这个文件是没有符号的，我们可以利用插件finger去恢复一下</p>
<p>安装教程：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/256461">https://www.anquanke.com/post/id/256461</a></p>
<p>跑了一段时间可以恢复大部分的函数</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806141240.png"></p>
<p>首先分析一下sub_402150</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806141323.png"></p>
<p>这里是释放一个elf文件，名字为re3，我们可以自己dump，可以动调然后提取文件，elf的长度存放在dword_4C2070中</p>
<p>在fork函数执行完毕后，如果创建新进程成功，则出现两个进程，一个是子进程，一个是父进程。在子进程中，fork函数返回0，在父进程中，fork返回新创建子进程的进程ID。我们可以通过fork返回的值来判断当前进程是子进程还是父进程。</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806161708.png"></p>
<p>父进程执行sub_401F2F后就删除了释放的文件，而子进程会执行sub_44CC50和sub_44B680操作</p>
<h3 id="sub-401F2F"><a href="#sub-401F2F" class="headerlink" title="sub_401F2F"></a>sub_401F2F</h3><p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806184936.png"></p>
<p>有些函数一开始识别不出来，需要进去进行分析底层调用，上图为修改完的效果</p>
<p>关于ptrace的一些介绍<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-265924.htm#msg_header_h2_1">https://bbs.pediy.com/thread-265924.htm#msg_header_h2_1</a></p>
<p>这里使用ptrace函数实现父进程与子进程之间的通信</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">long</span> ptrace（<span class="token keyword">enum</span> <span class="token class-name">_ptrace_request</span> request<span class="token punctuation">,</span><span class="token class-name">pid_t</span> pid<span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span> addr <span class="token punctuation">,</span><span class="token keyword">void</span> <span class="token operator">*</span>data）<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ptrace最重要的就是第一个参数</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806185144.png"></p>
<h3 id="sub-4017E5"><a href="#sub-4017E5" class="headerlink" title="sub_4017E5"></a>sub_4017E5</h3><p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806212737.png"></p>
<p>这里只是把a39872382055541数据提取出来由字符串转为数字，然后存放到v6数组里</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806212819.png"></p>
<p>一共有39条数据，sub_401F2F的v8指向这个数组</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806212934.png"></p>
<p>有些数据直接静态分析不好分析，我们还是利用动调比较方便</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806213249.png"></p>
<p>sub_401F2F的主要操作就是先把某组数据转成数字存放在数组里，然后复制子进程的寄存器到父进程，还有就是一些数据，通过读取的数据比对0xCAFEB055BFCC和0xCAFE1055BFC走不同的条件语句，我们先分析一下子进程附件。</p>
<h2 id="re3"><a href="#re3" class="headerlink" title="re3"></a>re3</h2><p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806213837.png"></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806214020.png"></p>
<p>子进程一进来有很多无法识别的数据，我以为这一块被SMC了，结果ida按c后可以正常识别，再p创建函数，成功F5</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806214926.png"></p>
<h3 id="sub-2490"><a href="#sub-2490" class="headerlink" title="sub_2490"></a>sub_2490</h3><p>这个函数是对输入的一些判断</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806215246.png"></p>
<p>一个25*25的数组，判断输入是否是0或1的ASCII，然后成立后减48转成0或1的数字，再存入byte_55C0</p>
<h3 id="loc-21F9"><a href="#loc-21F9" class="headerlink" title="loc_21F9"></a>loc_21F9</h3><p>这也是个函数，但是有加密，无法直接识别为指令，参数有sub_2490操作后的数组，还有v9和v8</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806215704.png"></p>
<p>突然发现这一块的数字似曾相识，好像在哪见过！原来是easyre附件的if判断那一块出现过</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806215755.png"></p>
<p>这里通过int 3断点向父进程发生通知，这个时候父进程就会进入条件语句执行sub_401BB1了</p>
<p>函数末尾还有个int 3</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806220057.png"></p>
<p>这个数据对应的是父进程if语句中的else部分，此时我的大脑中的想法就是:</p>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">1、父进程创建子进程，父进程处于wait状态
2、子进程得到输入，遇到int 3 ，向父进程发送通知
3、父进程接收到通知，执行SMC
4、SMC结束后，子进程再次遇到int 3,向父进程发送通知
5、父进程结束SMC，执行else部分<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="SMC"><a href="#SMC" class="headerlink" title="SMC"></a>SMC</h2><p>现在我们只要知道SMC的加密过程，就可以写脚本解密，或者直接动调解密</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806220718.png"></p>
<p>smc在父进程中，我们分析一下加密逻辑</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806235411.png"></p>
<p>首先分析一下sub_401AC2函数，发现是把re3里面的SMC数据部分取到easyre中</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806235349.png"></p>
<p>动调完发现SMC的逻辑就是把re3的数据xor 上面分析的a39872382055541MD5后的结果</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220806235928.png"></p>
<p>我们可以先尝试把所有的MD5都提取出来,先在转完16进制函数后下个断点，然后编辑断点</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807001052.png"></p>
<p>已经提取到数据了，接下来就是手工patch子进程</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">xorKey <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">8723</span><span class="token punctuation">:</span> <span class="token number">2533025110152939745</span><span class="token punctuation">,</span> <span class="token number">8739</span><span class="token punctuation">:</span> <span class="token number">5590097037203163468</span><span class="token punctuation">,</span> <span class="token number">8755</span><span class="token punctuation">:</span> <span class="token number">17414346542877855401</span><span class="token punctuation">,</span> <span class="token number">8771</span><span class="token punctuation">:</span> <span class="token number">17520503086133755340</span><span class="token punctuation">,</span> <span class="token number">8787</span><span class="token punctuation">:</span> <span class="token number">12492599841064285544</span><span class="token punctuation">,</span> <span class="token number">8803</span><span class="token punctuation">:</span> <span class="token number">12384833368350302160</span><span class="token punctuation">,</span> <span class="token number">8819</span><span class="token punctuation">:</span> <span class="token number">11956541642520230699</span><span class="token punctuation">,</span> <span class="token number">8835</span><span class="token punctuation">:</span> <span class="token number">12628929057681570616</span><span class="token punctuation">,</span> <span class="token number">8851</span><span class="token punctuation">:</span> <span class="token number">910654967627959011</span><span class="token punctuation">,</span> <span class="token number">8867</span><span class="token punctuation">:</span> <span class="token number">5684234031469876551</span><span class="token punctuation">,</span> <span class="token number">8883</span><span class="token punctuation">:</span> <span class="token number">6000358478182005051</span><span class="token punctuation">,</span> <span class="token number">8899</span><span class="token punctuation">:</span> <span class="token number">3341586462889168127</span><span class="token punctuation">,</span> <span class="token number">8915</span><span class="token punctuation">:</span> <span class="token number">11094889238442167020</span><span class="token punctuation">,</span> <span class="token number">8931</span><span class="token punctuation">:</span> <span class="token number">17237527861538956365</span><span class="token punctuation">,</span> <span class="token number">8947</span><span class="token punctuation">:</span> <span class="token number">17178915143649401084</span><span class="token punctuation">,</span> <span class="token number">8963</span><span class="token punctuation">:</span> <span class="token number">11176844209899222046</span><span class="token punctuation">,</span> <span class="token number">8979</span><span class="token punctuation">:</span> <span class="token number">18079493192679046363</span><span class="token punctuation">,</span> <span class="token number">8995</span><span class="token punctuation">:</span> <span class="token number">7090159446630928781</span><span class="token punctuation">,</span> <span class="token number">9011</span><span class="token punctuation">:</span> <span class="token number">863094436381699168</span><span class="token punctuation">,</span> <span class="token number">9027</span><span class="token punctuation">:</span> <span class="token number">6906972144372600884</span><span class="token punctuation">,</span> <span class="token number">9043</span><span class="token punctuation">:</span> <span class="token number">16780793948225765908</span><span class="token punctuation">,</span> <span class="token number">9059</span><span class="token punctuation">:</span> <span class="token number">7086655467811962655</span><span class="token punctuation">,</span> <span class="token number">9075</span><span class="token punctuation">:</span> <span class="token number">13977154540038163446</span><span class="token punctuation">,</span> <span class="token number">9091</span><span class="token punctuation">:</span> <span class="token number">7066662532691991888</span><span class="token punctuation">,</span> <span class="token number">9107</span><span class="token punctuation">:</span> <span class="token number">15157921356638311270</span><span class="token punctuation">,</span> <span class="token number">9123</span><span class="token punctuation">:</span> <span class="token number">12585839823593393444</span><span class="token punctuation">,</span> <span class="token number">9139</span><span class="token punctuation">:</span> <span class="token number">1360651393631625694</span><span class="token punctuation">,</span> <span class="token number">9155</span><span class="token punctuation">:</span> <span class="token number">2139328426318955142</span><span class="token punctuation">,</span> <span class="token number">9171</span><span class="token punctuation">:</span> <span class="token number">2478274715212481947</span><span class="token punctuation">,</span> <span class="token number">9187</span><span class="token punctuation">:</span> <span class="token number">12876028885252459748</span><span class="token punctuation">,</span> <span class="token number">9203</span><span class="token punctuation">:</span> <span class="token number">18132176846268847269</span><span class="token punctuation">,</span> <span class="token number">9219</span><span class="token punctuation">:</span> <span class="token number">17242441603067001509</span><span class="token punctuation">,</span> <span class="token number">9235</span><span class="token punctuation">:</span> <span class="token number">8492111998925944081</span><span class="token punctuation">,</span> <span class="token number">9251</span><span class="token punctuation">:</span> <span class="token number">14679986489201789069</span><span class="token punctuation">,</span> <span class="token number">9267</span><span class="token punctuation">:</span> <span class="token number">13188777131396593592</span><span class="token punctuation">,</span> <span class="token number">9283</span><span class="token punctuation">:</span> <span class="token number">5298970373130621883</span><span class="token punctuation">,</span> <span class="token number">9299</span><span class="token punctuation">:</span> <span class="token number">525902164359904478</span><span class="token punctuation">,</span> <span class="token number">9315</span><span class="token punctuation">:</span> <span class="token number">2117701741234018776</span><span class="token punctuation">,</span> <span class="token number">9331</span><span class="token punctuation">:</span> <span class="token number">9158760851580517972</span><span class="token punctuation">&#125;</span>

addr <span class="token operator">=</span> <span class="token number">0x2213</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> get_qword<span class="token punctuation">(</span>addr<span class="token punctuation">)</span>
    key <span class="token operator">=</span> xorKey<span class="token punctuation">[</span>addr<span class="token punctuation">]</span>
    dec <span class="token operator">=</span> data <span class="token operator">^</span> key
    idc<span class="token punctuation">.</span>patch_qword<span class="token punctuation">(</span>addr<span class="token punctuation">,</span> dec<span class="token punctuation">)</span>
    addr <span class="token operator">+=</span> <span class="token number">16</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>修复完有些地方需要我们nop掉，才能正常F5，同时把最后的int 3 也nop了，因为我们用不到了</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807003449.png"></p>
<p>这是一个数织游戏，我们只要找到对应的数据，通过网站就可以跑</p>
<p>我们的比较应该是一个25*25的矩阵</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807013937.png"></p>
<p>这里对矩阵做了一些操作，直接dump就行了</p>
<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">row
5  1  3  2  1  1
1  1  1  1  1  1  1  1
3  1  3  1  4  1 1
1  1  1  2  1  1  1  1
1  4  1  3  2  1 3

4  4  4  1  1  1
1 2 2 1 2 1 2 1
1 1 1 1 3 4 3 1
1 1 1 1 1 1 1 1 1 1
3 1 3 1 4 1 1
2
1 1 4 1 1 4
8 1 1 1 1 2 1
1 1 1 1 1 1 1 4
2 2 1 2 1 1 1 1 1 1
2 5 1 1 3

12 2 1 1 1 1
2 1 1 1 1 1 1 1 1
4 7 2 1 1 1 1
1 1 2 1 1 1 1 1 1
12 2
1 1 1 1
4 2 1 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-markdown" data-language="markdown"><code class="language-markdown">col
5 5 3 1 3
1 1 1 1 1 1 1 1 1 1
1 1 5 1 3 1 1
1 2 4 5 1
5 2 1 1 1 1 1 
1 1 1 1 5
1 2 6 1 3
2 2 1 1 1 1 1
2 5 1 3 1 1
1 1 1 1 1 1 1 3 1
2 1 1 1 1 1 1
2 5 3 1
3 5 1 1 1
1 1 1 1 1 1 1 1
1 1 1 3 5 5
1 3 5 1 1 1
1 1 3
5 1 2 4 1
1 1 4 3
1 1 2 4 1
5 4 3
2 5 4 1
5 3 1 1 1
1 2 1 1 1 4 1
1 1 1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807014545.png"></p>
<p>最后的效果FLAG{I LOVE PLAY ctf_QWB2022}</p>
<h1 id="find-basic"><a href="#find-basic" class="headerlink" title="find_basic"></a>find_basic</h1><p>首先运行看看</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807151206.png"></p>
<p>特殊字符串:basic secret，等会去IDA看看</p>
<p>搜到了，但是无法交叉引用到主函数逻辑，观察代码发现这题使用了类似虚拟保护的switch混淆执行逻辑分析</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807152057.png"></p>
<p>每个handler自己又作为分发器</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220807152236.png"></p>
<p>结构都比较类似，handler的结构体为</p>
<pre class="line-numbers language-assembly" data-language="assembly"><code class="language-assembly">.text:5661743E                 cmp     dl, 0E0h             判断控制码
.text:56617441                 jnz     short sub_5661745C   跳转到下一个handler或者分发器
.text:56617443                 popa						 	弹出通用寄存器
.text:56617444                 popf							弹出标志寄存器
.text:56617445                 push    0               ; buf
.text:56617447                 push    eax             ; stream
.text:56617448                 call    j__setvbuf			该handler实际执行的指令
.text:5661744D                 jmp     short loc_56617454   跳转到下一个handler或者分发器<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在开始调试</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808103658.png"></p>
<p>我们逐个函数分析，首先把cl赋值0X3F，然后进入函数sub_5658D4FA</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808103815.png"></p>
<p>进去继续分析sub_5658D7D6和sub_5658D782</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808103908.png"></p>
<p>off_5661506C的值自增1就没了</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104004.png"></p>
<p>这个函数就是获取一个rand值，然后v3判断是否大于随机数，貌似只是一段垃圾代码，交叉引用发现这个函数被调用多次，我改个名字randfunc，方便之后分析的识别</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104207.png"></p>
<p>这里把上层的ecd，也就是0x3F传进来就行比较，一直单步调试，走到0x3F的判断语句</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104257.png"></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104336.png"></p>
<p>好像并没有执行什么东西，然后继续走就到了这</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104426.png"></p>
<p>sub_5658D360没啥用，也是一个rand函数</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104456.png"></p>
<p>下面一个函数有点变化，貌似和sub_5658D7D6对应，这里是-1</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808104512.png"></p>
<p>当我单步步过sub_5658D360，会发生报错，怀疑是死循环，建议patch掉循环，然后就又回到了main了</p>
<p>到这我怀疑每一次的比较都类似opcode和function的对应，也就是之前说的加了switch混淆的vm，下面的opcode也是类似的分析方法</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808105830.png"></p>
<p>这里执行完会打印——–obf_xx_find v1.0———</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808110222.png"></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808110245.png"></p>
<p>这就是对应的打印basic secret:</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808110446.png"></p>
<p>0E对应的是scanf，此时程序卡住，等待我们输入，同时可以得知eax是存flag的地址</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808111213.png"></p>
<p>现在我可以在flag上下断点，看谁访问了他</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808111459.png"></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808111552.png"></p>
<p>cl为3A的时候触发了flag，把flag[0]取出来乘上42B45h<img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808111805.png"></p>
<p>这里把我们的flag[0]*0x42B45然后减去0x1A93D7E，类似汇编里面cmp的功能，我们通过这个等式反求一下flag[0],0x1A93D7E&#x2F;0x42B45&#x3D;0x66,也就是f的ASCII码。</p>
<p>同理我们再给flag[1]也下上断点，并把数据记录下来</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808112311.png"></p>
<p>这里发现又是flag[0]*0x1E4E0,然后又加上了edx，而edx是flag[1]*0x3B10F</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/master/QQ%E6%88%AA%E5%9B%BE20220808112457.png"></p>
<p>减去0x24FE394，整理第二轮就是flag[1]*0x3B10F+flag[0]*0x1E4E0&#x3D;&#x3D;0x24FE394,验证一下flag[1]为0x6c，确实是l的ASCII码</p>
<p>下面就慢慢调就行了，流程太多就不贴出来了，原理一样</p>
<p>也可以用trace，具体教程可以参考这位师傅<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Wt4y137qG?spm_id_from=333.337.search-card.all.click&vd_source=b9e4755863227a308257fcc956a9e9e7">https://www.bilibili.com/video/BV1Wt4y137qG?spm_id_from=333.337.search-card.all.click&amp;vd_source=b9e4755863227a308257fcc956a9e9e7</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
flag <span class="token operator">=</span> <span class="token punctuation">[</span>BitVec<span class="token punctuation">(</span><span class="token string">'flag[%d]'</span> <span class="token operator">%</span> i<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x1c</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
solver <span class="token operator">=</span> Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x1c</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
 solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">>=</span> <span class="token number">32</span><span class="token punctuation">)</span>
 solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token number">127</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'f'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'l'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'g'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'&#123;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'&#125;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x42b45</span> <span class="token operator">-</span> <span class="token number">0x1a93d7e</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3b10f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1e4e0</span> <span class="token operator">-</span> <span class="token number">0x24fe394</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x31fc4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdb038</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1390f</span> <span class="token operator">-</span> <span class="token number">0xbb9e67</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x32494</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe5a07</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xa4e6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x6ba7</span> <span class="token operator">-</span> <span class="token number">0x1052718</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe0c3f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x43e32</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3f49d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xc094</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb7eff</span> <span class="token operator">-</span> <span class="token number">0x7fb225</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x33e5b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x157f8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xd4eb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc9ad6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x9c95</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd8c2e</span> <span class="token operator">-</span> <span class="token number">0x6a31d</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x6d8c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffedd66</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x46fd4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc79bb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbe7f5</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x14cde</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc4acd</span> <span class="token operator">+</span> <span class="token number">0x3083b63</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x129fd</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2a3cd</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x52a1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x87de</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x357c1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbe625</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffec17b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x8039</span> <span class="token operator">-</span> <span class="token number">0xd3b6ed</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe590f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc6bb7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2aec8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd58b1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span> <span class="token number">0xfffcf131</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc0fae</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcf46a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbbb98</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc9913</span> <span class="token operator">+</span> <span class="token number">0x7a4d9d3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3cb6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc5201</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdec99</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x195a8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbcea6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd4f63</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3852e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x36c09</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdffc6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffbb8f</span> <span class="token operator">+</span> <span class="token number">0x27b7033</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb7a1c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff35fe</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe5693</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdb9f4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xbd38</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x25b89</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3074d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe5f6f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1400e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0xfffcd14c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x4036d</span> <span class="token operator">+</span> <span class="token number">0xa8256</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2da7a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbfd56</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff0011</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffce077</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span> <span class="token number">0x34d5d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb8def</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff2d4e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x237a3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x386e1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0xfb89</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2e485</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x42574</span> <span class="token operator">-</span> <span class="token number">0x24df62a</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x21c5e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x32144</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x420e3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3f6d0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1a459</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc900e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3fd03</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x43d16</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe4105</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd400a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffc29b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2f9f0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x19432</span> <span class="token operator">-</span> <span class="token number">0x6f9b293</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffca694</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffce151</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x30418</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2f6aa</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0x1b619</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x22e4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe1384</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffa664</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x13e07</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc46de</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x79d6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x4372b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3d1d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x4d41</span> <span class="token operator">-</span> <span class="token number">0x176513c</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x29b04</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd2684</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd9a2f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd79fc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2594e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x41c45</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc9c57</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc5f95</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffec65c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffb642</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcb527</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2792e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe1bb7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x445a1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd25cc</span> <span class="token operator">+</span> <span class="token number">0x5338cd6</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd399c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff3edb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x26b94</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcee81</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffefe93</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcdfa4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe2a42</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x10ba4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x38e1d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x14c1e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffce4a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd2a4b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x41fc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffedbac</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeab6a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe4e59</span> <span class="token operator">+</span> <span class="token number">0x299ff72</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdc67b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffb1fc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff59be</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3684</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span> <span class="token number">0x202c2</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2e43</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff3a46</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x6a23</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xebfb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbb78a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xd44a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x385eb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffee046</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeb282</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffde639</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd6738</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff1aa3</span> <span class="token operator">+</span> <span class="token number">0x4728350</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x28c9c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdc4ae</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x278ad</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x326ca</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd423d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc96fc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeeb1a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc2ee0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x106be</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span> <span class="token number">0xffff5d67</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x27</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbc3b6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd163c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb9b47</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1e6ed</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc6c6f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3b32b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2feea</span> <span class="token operator">+</span> <span class="token number">0x48d1119</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc2bb3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffce76f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffca692</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdf4bc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x192f9</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe5a1e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffed4f3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff94f8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc717e</span><span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffed29b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd28d9</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x218df</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x28e00</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdd0af</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x25d22</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x42ebb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff1382</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x7404</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe2dff</span> <span class="token operator">+</span> <span class="token number">0x60245a5</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x21061</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbcb01</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff7442</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x24568</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0x1b201</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2d232</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x13777</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffee013</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc7505</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0x264ed</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x33b4f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x286d8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x33e8b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x21529</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb7c1a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd07a3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff8453</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x9754</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd603d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span> <span class="token number">0xfffdd85b</span> <span class="token operator">-</span> <span class="token number">0x254e142</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe206e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2f048</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc19fa</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x370d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd9c2f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdb413</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x30e0a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe07f8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffedfd5</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffee6f6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x46247</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2b8ed</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2d291</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdc54d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc5b55</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb8061</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x43913</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffe191</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd276e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe5841</span> <span class="token operator">+</span> <span class="token number">0xce53e7</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffed971</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x46741</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbac8c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeb4e7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1026b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe7d86</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd5fec</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x48ddb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc6bc1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x37ece</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x41105</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe6667</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe75b2</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x61b0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffd602</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbce29</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff07d7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x34c8e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x32996</span><span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x49530</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x33822</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffce161</span> <span class="token operator">+</span> <span class="token number">0x42666b</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe06e8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd0441</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x16357</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1d95f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0xffff89d3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffba022</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x46180</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff4240</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x199c5</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff442c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc2fac</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x32600</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1d03a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x19435</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd1667</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x35d1d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x96c4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2fa24</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xb20c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0xebee</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x428a6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffceb8a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x22784</span> <span class="token operator">-</span> <span class="token number">0x3604a63</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1e3e2</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1cfb9</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xc3f7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x94cd</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc7fd0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x21165</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcfb41</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff819d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbeb76</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x16751</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xe1a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x238a0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x28f99</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x45bc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffcb18</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x32d58</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffe4bc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeea95</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x44f3a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xb047</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcfc36</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1719</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1b011</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffea265</span> <span class="token operator">-</span> <span class="token number">0x2918269</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbf307</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff2847</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcfd31</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x40f96</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2b265</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc7802</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1b103</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x42452</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3c5d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x15b55</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeb722</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1d9a9</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x28df</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc89eb</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0xfffe1221</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x4462a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x23353</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3c514</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x316a4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x176e1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xcf0e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x46b55</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffbcc1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xf2a7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1d33c</span> <span class="token operator">-</span> <span class="token number">0x5df35b6</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbf624</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffec87a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x19aaa</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x5f14</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0xfffcfc43</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbe879</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdfc92</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffc258</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd02fd</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x12560</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xae46</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffeb6f5</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x30c11</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffcb4ae</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2a00a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc76de</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x4162</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe95b2</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe60e7</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff908d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb7f42</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1c31</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff900c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2ad6e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd7c6d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xc499</span> <span class="token operator">+</span> <span class="token number">0x83646cd</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x26b02</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffb92e5</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x30dd1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe4c7b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span> <span class="token number">0xffff0433</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x276b1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc241e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe3fdc</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffee787</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x230c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd53f8</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffc108c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffffbac1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff0bdb</span><span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbc5e2</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xa1f6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1e758</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1725f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3387e</span><span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x87b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd8475</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3776a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff4515</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x1a454</span><span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbf3a1</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x25174</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbccc2</span> <span class="token operator">+</span> <span class="token number">0x52dfb3f</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
solver<span class="token punctuation">.</span>add<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2f139</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x21b53</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2ad74</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffba19b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">0x1ac4e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">27</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x2208e</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdd738</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffdfb9f</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe4b65</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x10937</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffbfdf3</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3cc1a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe93ee</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe3b8a</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffe792c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3e9ff</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x128e6</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x574b</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x16707</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3fe4c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffed658</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x3cc8c</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x458b4</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffd74d0</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x22e02</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xffff098d</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0x30b99</span> <span class="token operator">+</span> flag<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token number">0xfffba5e9</span> <span class="token operator">-</span> <span class="token number">0x38186f4</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
flag_str <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">if</span> solver<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> sat<span class="token punctuation">:</span>
 m <span class="token operator">=</span> solver<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
 <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x1c</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag_str <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>as_long<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag_str<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>后来看Chamd5的大哥直接写了一个去混淆的脚本，等有空再看看了。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>强网杯先复现到这里，还有三道题还没复现，看做出来的人不是很多，应该有些难度，等后面有时间再搞了，最近有点忙。这四道题复现下来给我的收获挺多的，学会了一些插件的使用还有就是做题上面的思路的改变，混淆在ctf逆向中也越来越多了，得弄个专题专门学习一下混淆。不得不说，强网杯的体验还是可以的，虽然只写出来两题。今年比去年好一点，去年只有110多名，今年39名，差一点就进总决赛了，明年加油。</p>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 767778848@qq.com </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '6c49373fe3729f3c2b02',
            clientSecret: '4b38338216282f43430b6118f27ae24e4732ecec',
            repo: 'Whitebird0.github.io',
            owner: 'Whitebird0',
            admin: ['Whitebird0'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2020-2022 Whitebird
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
