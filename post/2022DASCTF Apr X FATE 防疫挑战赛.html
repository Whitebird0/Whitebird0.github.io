<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>2022DASCTF Apr X FATE 防疫挑战赛 | Whitebird&#39;s Home</title>
  <meta name="keywords" content=" CTF ">
  <meta name="description" content="2022DASCTF Apr X FATE 防疫挑战赛 | Whitebird&#39;s Home">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta property="og:type" content="website">
<meta property="og:title" content="tags">
<meta property="og:url" content="https://whitebird0.github.io/tags/index.html">
<meta property="og:site_name" content="Whitebird&#39;s Home">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-11-23T15:31:14.000Z">
<meta property="article:modified_time" content="2021-11-23T15:31:33.805Z">
<meta property="article:author" content="Whitebird">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/github.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<meta name="generator" content="Hexo 5.4.2"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/"
   class="avatar_target">
    <img class="avatar"
         src="/img/avatar.jpg"/>
</a>
<div class="author">
    <span>Whitebird</span>
</div>

<div class="icon">
    
        
            <a title="github"
               href="https://github.com/Whitebird0"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="csdn"
               href="https://blog.csdn.net/jxnu_666?type=blog"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-csdn"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="email"
               href="mailto:767778848@qq.com"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-email"></use>
                    </svg>
                
            </a>
        
    
        
            <a title="qq"
               href="http://wpa.qq.com/msgrd?v=3&uin=767778848&site=qq&menu=yes"
               target="_blank">
                
                    <svg class="iconfont-svg" aria-hidden="true">
                        <use xlink:href="#icon-qq"></use>
                    </svg>
                
            </a>
        
    
</div>




<ul>
    <li>
        <div class="all active" data-rel="全部文章">全部文章
            
                <small>(28)</small>
            
        </div>
    </li>
    
        
            
                <li>
                    <div data-rel="CTF">
                        
                        CTF
                        <small>(6)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Reverse">
                        
                        Reverse
                        <small>(8)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Android开发">
                        
                        Android开发
                        <small>(10)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Android逆向">
                        
                        Android逆向
                        <small>(3)</small>
                        
                    </div>
                    
                </li>
            
        
    
        
            
                <li>
                    <div data-rel="Windows内核">
                        
                        Windows内核
                        <small>(1)</small>
                        
                    </div>
                    
                </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
        
            
            
    </div>
    <div>
        
            <a class="about  hasFriend  site_url"
               
               href="/about">关于</a>
        
        <a style="width: 50%"
                
                                           class="friends">友链</a>
        
    </div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="28">
<input type="hidden" id="yelog_site_word_count" value="167.3k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://www.codetea.top/">Codetea</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" autocomplete="off"/>
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Android</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CTF</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Reverse</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Windows内核</a>
            </li>
        
    </div>

</div>

    
    <div id="local-search-result">

    </div>
    
    <nav id="title-list-nav">
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/Android%E7%B3%BB%E7%BB%9F%E6%B2%99%E7%9B%92%E5%AE%9A%E5%88%B6%E4%B8%93%E9%A2%98.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android系统沙盒定制">Android系统沙盒定制</span>
            <span class="post-date" title="2023-09-15 12:40:21">2023/09/15</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/unidbg%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向学习笔记——Unidbg学习与实战">Android逆向学习笔记——Unidbg学习与实战</span>
            <span class="post-date" title="2023-07-01 09:00:15">2023/07/01</span>
        </a>
        
        
        <a  class="全部文章 Android逆向 "
           href="/post/Frida%E7%9A%84Python%E5%BA%93%E4%BD%BF%E7%94%A8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android逆向学习笔记——使用Python库调用Frida">Android逆向学习笔记——使用Python库调用Frida</span>
            <span class="post-date" title="2023-06-01 09:00:15">2023/06/01</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/NDK%E5%BC%80%E5%8F%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记——NDK开发">Android开发学习笔记——NDK开发</span>
            <span class="post-date" title="2023-03-31 09:00:14">2023/03/31</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code1.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(1)——初识安卓">Android开发学习笔记(1)——初识安卓</span>
            <span class="post-date" title="2023-03-30 09:00:21">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code2.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(2)——探究活动">Android开发学习笔记(2)——探究活动</span>
            <span class="post-date" title="2023-03-30 09:00:20">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code3.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(3)——UI开发">Android开发学习笔记(3)——UI开发</span>
            <span class="post-date" title="2023-03-30 09:00:19">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code4.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(4)——探究碎片">Android开发学习笔记(4)——探究碎片</span>
            <span class="post-date" title="2023-03-30 09:00:18">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code5.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(5)——详解广播机制">Android开发学习笔记(5)——详解广播机制</span>
            <span class="post-date" title="2023-03-30 09:00:17">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code6.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(6)——数据存储全方案">Android开发学习笔记(6)——数据存储全方案</span>
            <span class="post-date" title="2023-03-30 09:00:16">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code7.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(7)——跨程序共享数据">Android开发学习笔记(7)——跨程序共享数据</span>
            <span class="post-date" title="2023-03-30 09:00:15">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code8.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(8)——运用手机多媒体">Android开发学习笔记(8)——运用手机多媒体</span>
            <span class="post-date" title="2023-03-30 09:00:14">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 Android开发 "
           href="/post/the_first_code9.html"
           data-tag="Android"
           data-author="" >
            <span class="post-title" title="Android开发学习笔记(9)——网络技术">Android开发学习笔记(9)——网络技术</span>
            <span class="post-date" title="2023-03-30 09:00:13">2023/03/30</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022%E5%B9%B4%E6%B1%9F%E8%A5%BF%E7%9C%81%E2%80%9C%E8%B5%A3%E8%82%B2%E6%9D%AF%E2%80%9D%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022年江西省“赣育杯”网络安全大赛初赛 Re WriteUp">2022年江西省“赣育杯”网络安全大赛初赛 Re WriteUp</span>
            <span class="post-date" title="2022-10-08 22:40:21">2022/10/08</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/qwb.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第六届强网杯全国网络安全挑战赛 Re WriteUp">第六届强网杯全国网络安全挑战赛 Re WriteUp</span>
            <span class="post-date" title="2022-08-08 15:49:21">2022/08/08</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/bluecup.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第六届蓝帽杯初赛CTF题目 Re WriteUp">第六届蓝帽杯初赛CTF题目 Re WriteUp</span>
            <span class="post-date" title="2022-07-13 22:49:21">2022/07/13</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/CISCN2022.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="第十五届全国大学生信息安全竞赛创新实践能力赛CISCN">第十五届全国大学生信息安全竞赛创新实践能力赛CISCN</span>
            <span class="post-date" title="2022-06-03 20:49:21">2022/06/03</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022DASCTF%20Apr%20X%20FATE%20%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022DASCTF Apr X FATE 防疫挑战赛">2022DASCTF Apr X FATE 防疫挑战赛</span>
            <span class="post-date" title="2022-06-01 20:49:21">2022/06/01</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/PE%E6%98%A0%E5%83%8F%E5%88%87%E6%8D%A2.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——PE映像切换">逆向工程核心原理——PE映像切换</span>
            <span class="post-date" title="2022-04-02 10:49:21">2022/04/02</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E5%8F%8D%E8%B0%83%E8%AF%95%E6%8A%80%E6%9C%AF.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——反调试技术">逆向工程核心原理——反调试技术</span>
            <span class="post-date" title="2022-03-28 10:30:21">2022/03/28</span>
        </a>
        
        
        <a  class="全部文章 CTF "
           href="/post/2022-3-26-2022DASCTF-X-SU-Re-WriteUp.html"
           data-tag="CTF"
           data-author="" >
            <span class="post-title" title="2022DASCTF X SU Re WriteUp">2022DASCTF X SU Re WriteUp</span>
            <span class="post-date" title="2022-03-26 20:49:21">2022/03/26</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/SEH.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——SEH原理分析">逆向工程核心原理——SEH原理分析</span>
            <span class="post-date" title="2022-03-19 10:49:21">2022/03/19</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/TLS%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——TLS回调函数">逆向工程核心原理——TLS回调函数</span>
            <span class="post-date" title="2022-03-15 22:49:21">2022/03/15</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E5%85%A8%E5%B1%80API%E9%92%A9%E5%8F%96-IE%E9%93%BE%E6%8E%A5%E6%8E%A7%E5%88%B6.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——全局API钩取">逆向工程核心原理——全局API钩取</span>
            <span class="post-date" title="2022-03-11 16:49:21">2022/03/11</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E8%AE%A1%E7%AE%97%E5%99%A8%E6%98%BE%E7%A4%BA%E4%B8%AD%E6%96%87%E6%95%B0%E5%AD%97.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——IAT_HOOK">逆向工程核心原理——IAT_HOOK</span>
            <span class="post-date" title="2022-03-08 22:49:21">2022/03/08</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9PE%E5%8A%A0%E8%BD%BDDLL.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——通过修改PE加载DLL">逆向工程核心原理——通过修改PE加载DLL</span>
            <span class="post-date" title="2022-02-28 22:49:21">2022/02/28</span>
        </a>
        
        
        <a  class="全部文章 Reverse "
           href="/post/DLL%E6%B3%A8%E5%85%A5.html"
           data-tag="Reverse"
           data-author="" >
            <span class="post-title" title="逆向工程核心原理——DLL注入">逆向工程核心原理——DLL注入</span>
            <span class="post-date" title="2022-02-26 00:49:21">2022/02/26</span>
        </a>
        
        
        <a  class="全部文章 Windows内核 "
           href="/post/%E6%AE%B5%E4%B8%8E%E9%A1%B5%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5.html"
           data-tag="Windows内核"
           data-author="" >
            <span class="post-title" title="Windows内核基础知识-段选择子与段描述符">Windows内核基础知识-段选择子与段描述符</span>
            <span class="post-date" title="2021-10-03 12:40:21">2021/10/03</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>

    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-2022DASCTF Apr X FATE 防疫挑战赛" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">2022DASCTF Apr X FATE 防疫挑战赛</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="CTF">CTF</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color4">CTF</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2023-03-31 00:57:26'>2022-06-01 20:49</time>
        
    </div>
    <div class="article-meta">
        
        <span>字数:2.7k</span>
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
        <span class="top-comment" title="跳转至评论区">
            <a href="#comments">
                评论:<span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </a>
        </span>
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#2022DASCTF-Apr-X-FATE-%E9%98%B2%E7%96%AB%E6%8C%91%E6%88%98%E8%B5%9B"><span class="toc-text">2022DASCTF Apr X FATE 防疫挑战赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Crackme"><span class="toc-text">Crackme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E4%BA%A4%E6%98%93"><span class="toc-text">奇怪的交易</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link"><span class="toc-text"></span></a></li></ol></li></ol></li></ol></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="2022DASCTF-Apr-X-FATE-防疫挑战赛"><a href="#2022DASCTF-Apr-X-FATE-防疫挑战赛" class="headerlink" title="2022DASCTF Apr X FATE 防疫挑战赛"></a>2022DASCTF Apr X FATE 防疫挑战赛</h1><h2 id="Crackme"><a href="#Crackme" class="headerlink" title="Crackme"></a>Crackme</h2><p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220521-215657@2x.png"></p>
<p>首先随便输入字符串，看看有什么反应，出现Wrong!!!的MessageBox，可以尝试去IDA搜索字符串，通过交叉引用找到逻辑函数，分析一下。</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220519-101401@2x.png"></p>
<p>首先是key的长度是8位，flag的长度是32位，然后就是key的前四位进行某种操作sub_403510(后面会分析)，然后同理对key的后四位进行同样的操作，最后是整个key，只不过三次的函数参数都不同，分析一下sub_403510函数</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220519-100429@2x.png"></p>
<p>这里用到了windows的密码库，对应的API都可以在msdn上查到，主要注意CryptCreateHash的第二个参数，它决定了使用那种加密方式，<a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/win32/seccrypto/alg-id">查询网址</a></p>
<p>因此三次加密分别是md5、sha、md5，这些都是可以经过网站在线解密的，只不过需要动调获取密文。</p>
<p>继续返回主函数分析，最后有个对flag的加密，然后就是加密后的flag与密文进行对比，我们分析一下sub_4036E0(),参数如下</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220521-221756@2x.png"></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220521-222425@2x.png"></p>
<p>其中CryptDeriveKey第二个参数标识要为其生成密钥的对称加密算法的 <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/windows/desktop/SecCrypto/alg-id">ALG_ID</a>结构，也就是对传入的flag进行加密，加密方式查询后为AES</p>
<p>然后我们就通过动调去拿数据，但是程序带有反调试，需要我们去进行反反调试，没有发现常见的反调试，在字符串中搜索Thread,发现ZwSetInformationThread，交叉引用过去</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-075904@2x.png"></p>
<p>这里是自己实现的反调试，<a target="_blank" rel="noopener" href="https://ctf-wiki.org/reverse/windows/anti-debug/zwsetinformationthread/">相关介绍</a></p>
<p>注意到该处 ZwSetInformationThread 函数的第 2 个参数为 ThreadHideFromDebugger，其值为 0x11。调试执行到该函数时，若发现第 2 个参数值为 0x11，跳过或者将 0x11 修改为其他值即可</p>
<p>我这里直接patch成0x9了</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-080156@2x.png"></p>
<p>然后在第一次memcmp处下断点，获取key前四位md5后的值</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-080456@2x.png"></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-080549@2x.png"></p>
<p>直接找个网站解一下试试</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-080702@2x.png"></p>
<p>前四个字符为NocT,同理获取第二次sha加密的密文</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-080802@2x.png"></p>
<p><a target="_blank" rel="noopener" href="https://crackstation.net/">在线解密sha1</a></p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-081129@2x.png"></p>
<p>所以现在的key为NocTuRne,之后就是模拟调用win32 的aes解密api来解密的过程了,先调出密文</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-082059@2x.png"></p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">unsigned</span> <span class="token keyword">char</span> ida_chars<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span>
<span class="token punctuation">&#123;</span>
  <span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> 
  <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> 
  <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> 
  <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> 
  <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0xB4</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>解密脚本</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;Windows.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;wincrypt.h></span></span>
 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    BYTE pbData<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>  <span class="token comment">//key_buf,key被md5后</span>
    BYTE flag_encrypt<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0x5B</span><span class="token punctuation">,</span> <span class="token number">0x9C</span><span class="token punctuation">,</span> <span class="token number">0xEE</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x3B</span><span class="token punctuation">,</span> <span class="token number">0xB7</span><span class="token punctuation">,</span> <span class="token number">0xD7</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xF3</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xC6</span><span class="token punctuation">,</span> <span class="token number">0xB2</span><span class="token punctuation">,</span> <span class="token number">0x1F</span><span class="token punctuation">,</span> <span class="token number">0xE8</span><span class="token punctuation">,</span> <span class="token number">0xDE</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0x1B</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0x6A</span><span class="token punctuation">,</span> <span class="token number">0xD4</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0xFC</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xE6</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0xDA</span><span class="token punctuation">,</span> <span class="token number">0x0D</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xEA</span><span class="token punctuation">,</span> <span class="token number">0x7B</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x6C</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xAF</span><span class="token punctuation">,</span> <span class="token number">0xB4</span><span class="token punctuation">,</span><span class="token number">0x0</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    DWORD dwDataLen <span class="token operator">=</span> <span class="token number">0x10</span><span class="token punctuation">;</span>
    DWORD ddwDataLen<span class="token punctuation">;</span>
    DWORD<span class="token operator">*</span> pdwDataLen <span class="token operator">=</span> <span class="token operator">&amp;</span>ddwDataLen<span class="token punctuation">;</span>
    <span class="token operator">*</span>pdwDataLen <span class="token operator">=</span> <span class="token number">0x20</span><span class="token punctuation">;</span>
 
 
    BOOL v6<span class="token punctuation">;</span> <span class="token comment">// [esp+4h] [ebp-18h]</span>
    HCRYPTKEY phKey<span class="token punctuation">;</span> <span class="token comment">// [esp+Ch] [ebp-10h] BYREF</span>
    HCRYPTPROV phProv<span class="token punctuation">;</span> <span class="token comment">// [esp+10h] [ebp-Ch] BYREF</span>
    HCRYPTHASH phHash<span class="token punctuation">;</span> <span class="token comment">// [esp+14h] [ebp-8h] BYREF</span>
 
    phProv <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    phHash <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    phKey <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    v6 <span class="token operator">=</span> <span class="token function">CryptAcquireContextA</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>phProv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0x18u</span><span class="token punctuation">,</span> <span class="token number">0xF0000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>v6<span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        v6 <span class="token operator">=</span> <span class="token function">CryptCreateHash</span><span class="token punctuation">(</span>phProv<span class="token punctuation">,</span> <span class="token number">0x8003u</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>phHash<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>v6<span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            v6 <span class="token operator">=</span> <span class="token function">CryptHashData</span><span class="token punctuation">(</span>phHash<span class="token punctuation">,</span> pbData<span class="token punctuation">,</span> dwDataLen<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>v6<span class="token punctuation">)</span>
            <span class="token punctuation">&#123;</span>
                v6 <span class="token operator">=</span> <span class="token function">CryptDeriveKey</span><span class="token punctuation">(</span>phProv<span class="token punctuation">,</span> <span class="token number">0x660Eu</span><span class="token punctuation">,</span> phHash<span class="token punctuation">,</span> <span class="token number">1u</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>phKey<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// key的md5值再生成aes密钥</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>v6<span class="token punctuation">)</span>
                    v6 <span class="token operator">=</span> <span class="token function">CryptDecrypt</span><span class="token punctuation">(</span>phKey<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> flag_encrypt<span class="token punctuation">,</span> pdwDataLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> flag_encrypt<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>phKey<span class="token punctuation">)</span>
        <span class="token function">CryptDestroyKey</span><span class="token punctuation">(</span>phKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>phHash<span class="token punctuation">)</span>
        <span class="token function">CryptDestroyHash</span><span class="token punctuation">(</span>phHash<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>phProv<span class="token punctuation">)</span>
        <span class="token function">CryptReleaseContext</span><span class="token punctuation">(</span>phProv<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> v6<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/WX20220522-082402@2x.png"></p>
<h2 id="奇怪的交易"><a href="#奇怪的交易" class="headerlink" title="奇怪的交易"></a>奇怪的交易</h2><p>首先先查看文件信息，发现有upx壳，直接在kali用upx -d脱了</p>
<p>打开文件，发现一堆py开头的函数，推测是py打包的elf文件</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-191955@2x.png"></p>
<p>利用python pyinstxtractor.py 文件名 指令获取解包后的文件，此时的pyc文件并不能直接被网站或者脚本反编译，需要修复头部的若干内容,这16个字节从struct.pyc中获得，然后进行反编译</p>
<h6 id=""><a href="#" class="headerlink" title=""></a><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-192523@2x.png"></h6><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># visit https://tool.lu/pyc/ for more information</span>
<span class="token comment"># Version: Python 3.10</span>

<span class="token keyword">from</span> cup <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'\xe8\xaf\xb7\xe8\xbe\x93\xe5\x85\xa5flag'</span><span class="token punctuation">)</span>
    pub_key <span class="token operator">=</span> <span class="token punctuation">[</span>
        0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25L<span class="token punctuation">,</span>
        0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68BL<span class="token punctuation">]</span>
    m <span class="token operator">=</span> libnum<span class="token punctuation">.</span>s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pub_key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pub_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    ᘡ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    ᘙ <span class="token operator">=</span> <span class="token punctuation">[</span>
        0xD28ED952L<span class="token punctuation">,</span>
        <span class="token number">1472742623</span><span class="token punctuation">,</span>
        0xD91BA938L<span class="token punctuation">,</span>
        0xF9F3BD2DL<span class="token punctuation">,</span>
        0x8EF8E43DL<span class="token punctuation">,</span>
        <span class="token number">617653972</span><span class="token punctuation">,</span>
        <span class="token number">1474514999</span><span class="token punctuation">,</span>
        <span class="token number">1471783658</span><span class="token punctuation">,</span>
        <span class="token number">1012864704</span><span class="token punctuation">,</span>
        0xD7821910L<span class="token punctuation">,</span>
        <span class="token number">993855884</span><span class="token punctuation">,</span>
        <span class="token number">438456717</span><span class="token punctuation">,</span>
        0xC83555B7L<span class="token punctuation">,</span>
        0xE8DFF468L<span class="token punctuation">,</span>
        <span class="token number">198959101</span><span class="token punctuation">,</span>
        0xC5B84FEBL<span class="token punctuation">,</span>
        0xD9F837C6L<span class="token punctuation">,</span>
        <span class="token number">613157871</span><span class="token punctuation">,</span>
        0x8EFA4EDDL<span class="token punctuation">,</span>
        <span class="token number">97286225</span><span class="token punctuation">,</span>
        0x8B4B608CL<span class="token punctuation">,</span>
        <span class="token number">1471645170</span><span class="token punctuation">,</span>
        0xC0B62792L<span class="token punctuation">,</span>
        <span class="token number">583597118</span><span class="token punctuation">,</span>
        0xAAB1C22DL<span class="token punctuation">,</span>
        0xBDB9C266L<span class="token punctuation">,</span>
        <span class="token number">1384330715</span><span class="token punctuation">,</span>
        0xAE9F9816L<span class="token punctuation">,</span>
        0xD1F40B3CL<span class="token punctuation">,</span>
        0x8206DDC3L<span class="token punctuation">,</span>
        0xC4E0BADCL<span class="token punctuation">,</span>
        0xE407BD26L<span class="token punctuation">,</span>
        <span class="token number">145643141</span><span class="token punctuation">,</span>
        0x8016C6A5L<span class="token punctuation">,</span>
        0xAF4AB9D3L<span class="token punctuation">,</span>
        <span class="token number">506798154</span><span class="token punctuation">,</span>
        <span class="token number">994590281</span><span class="token punctuation">,</span>
        0x85082A0BL<span class="token punctuation">,</span>
        0xCA0BC95AL<span class="token punctuation">,</span>
        0xA7BE567CL<span class="token punctuation">,</span>
        <span class="token number">1105937096</span><span class="token punctuation">,</span>
        <span class="token number">1789727804</span><span class="token punctuation">,</span>
        0xDFEFB591L<span class="token punctuation">,</span>
        0x93346B38L<span class="token punctuation">,</span>
        <span class="token number">1162286478</span><span class="token punctuation">,</span>
        <span class="token number">680814033</span><span class="token punctuation">,</span>
        0xAEE1A7A2L<span class="token punctuation">,</span>
        0x80E574AEL<span class="token punctuation">,</span>
        0xF154F55FL<span class="token punctuation">,</span>
        <span class="token number">2121620700</span><span class="token punctuation">,</span>
        0xFCBDA653L<span class="token punctuation">,</span>
        0x8E902444L<span class="token punctuation">,</span>
        0xCA742E12L<span class="token punctuation">,</span>
        0xB8424071L<span class="token punctuation">,</span>
        0xB4B15EC2L<span class="token punctuation">,</span>
        0x943BFA09L<span class="token punctuation">,</span>
        0xBC97CD93L<span class="token punctuation">,</span>
        <span class="token number">1285603712</span><span class="token punctuation">,</span>
        <span class="token number">798920280</span><span class="token punctuation">,</span>
        0x8B58328FL<span class="token punctuation">,</span>
        0xF9822360L<span class="token punctuation">,</span>
        0xD1FD15EEL<span class="token punctuation">,</span>
        <span class="token number">1077514121</span><span class="token punctuation">,</span>
        <span class="token number">1436444106</span><span class="token punctuation">,</span>
        0xA2D6C17EL<span class="token punctuation">,</span>
        <span class="token number">1507202797</span><span class="token punctuation">,</span>
        <span class="token number">500756149</span><span class="token punctuation">,</span>
        <span class="token number">198754565</span><span class="token punctuation">,</span>
        0x8E014807L<span class="token punctuation">,</span>
        <span class="token number">880454148</span><span class="token punctuation">,</span>
        <span class="token number">1970517398</span><span class="token punctuation">,</span>
        0xBFC6EE25L<span class="token punctuation">,</span>
        <span class="token number">1161840191</span><span class="token punctuation">,</span>
        <span class="token number">560498076</span><span class="token punctuation">,</span>
        <span class="token number">1782600856</span><span class="token punctuation">,</span>
        0x9D93FEBEL<span class="token punctuation">,</span>
        <span class="token number">1285196205</span><span class="token punctuation">,</span>
        <span class="token number">788797746</span><span class="token punctuation">,</span>
        <span class="token number">1195724574</span><span class="token punctuation">,</span>
        0xF2174A07L<span class="token punctuation">,</span>
        <span class="token number">103427523</span><span class="token punctuation">,</span>
        0x952BFE83L<span class="token punctuation">,</span>
        0xF730AC4CL<span class="token punctuation">,</span>
        <span class="token number">617564657</span><span class="token punctuation">,</span>
        <span class="token number">978211984</span><span class="token punctuation">,</span>
        <span class="token number">1781482121</span><span class="token punctuation">,</span>
        0x8379D23AL<span class="token punctuation">,</span>
        0xEAD737EEL<span class="token punctuation">,</span>
        0xE41555FBL<span class="token punctuation">,</span>
        <span class="token number">659557668</span><span class="token punctuation">,</span>
        0x99F3B244L<span class="token punctuation">,</span>
        <span class="token number">1561884856</span><span class="token punctuation">,</span>
        0x842C31A4L<span class="token punctuation">,</span>
        <span class="token number">1189296962</span><span class="token punctuation">,</span>
        <span class="token number">169145316</span><span class="token punctuation">,</span>
        0xA5CE044CL<span class="token punctuation">,</span>
        <span class="token number">1323893433</span><span class="token punctuation">,</span>
        <span class="token number">824667876</span><span class="token punctuation">,</span>
        <span class="token number">408202876</span><span class="token punctuation">,</span>
        0xE0178482L<span class="token punctuation">,</span>
        0xF412BBBCL<span class="token punctuation">,</span>
        <span class="token number">1508996065</span><span class="token punctuation">,</span>
        <span class="token number">162419237</span><span class="token punctuation">,</span>
        0xDE740B00L<span class="token punctuation">,</span>
        0xB7CB64FDL<span class="token punctuation">,</span>
        0xEBCADB1FL<span class="token punctuation">,</span>
        0x8EAE2326L<span class="token punctuation">,</span>
        0x933C216CL<span class="token punctuation">,</span>
        0xD7D1F649L<span class="token punctuation">,</span>
        <span class="token number">481927014</span><span class="token punctuation">,</span>
        0xA448AC16L<span class="token punctuation">,</span>
        0xBC082807L<span class="token punctuation">,</span>
        <span class="token number">1261069441</span><span class="token punctuation">,</span>
        <span class="token number">2063238535</span><span class="token punctuation">,</span>
        0x8474A61DL<span class="token punctuation">,</span>
        <span class="token number">101459755</span><span class="token punctuation">,</span>
        0xBC5654D1L<span class="token punctuation">,</span>
        <span class="token number">1721190841</span><span class="token punctuation">,</span>
        <span class="token number">1078395785</span><span class="token punctuation">,</span>
        <span class="token number">176506553</span><span class="token punctuation">,</span>
        0xD3C5280FL<span class="token punctuation">,</span>
        <span class="token number">1566142515</span><span class="token punctuation">,</span>
        <span class="token number">1938949000</span><span class="token punctuation">,</span>
        <span class="token number">1499289517</span><span class="token punctuation">,</span>
        0xC59872F8L<span class="token punctuation">,</span>
        <span class="token number">829714860</span><span class="token punctuation">,</span>
        0xE51502A2L<span class="token punctuation">,</span>
        <span class="token number">952932374</span><span class="token punctuation">,</span>
        <span class="token number">1283577465</span><span class="token punctuation">,</span>
        <span class="token number">2045007203</span><span class="token punctuation">,</span>
        0xEBE6A798L<span class="token punctuation">,</span>
        0xE09575CDL<span class="token punctuation">,</span>
        0xADDF4157L<span class="token punctuation">,</span>
        0xC4770191L<span class="token punctuation">,</span>
        <span class="token number">482297421</span><span class="token punctuation">,</span>
        <span class="token number">1734231412</span><span class="token punctuation">,</span>
        0xDAC71054L<span class="token punctuation">,</span>
        0x99807E43L<span class="token punctuation">,</span>
        0xA88D74B1L<span class="token punctuation">,</span>
        0xCB77E028L<span class="token punctuation">,</span>
        <span class="token number">1533519803</span><span class="token punctuation">,</span>
        0xEEEBC3B6L<span class="token punctuation">,</span>
        0xE7E680E5L<span class="token punctuation">,</span>
        <span class="token number">272960248</span><span class="token punctuation">,</span>
        <span class="token number">317508587</span><span class="token punctuation">,</span>
        0xC4B10CDCL<span class="token punctuation">,</span>
        0x91776399L<span class="token punctuation">,</span>
        <span class="token number">27470488</span><span class="token punctuation">,</span>
        <span class="token number">1666674386</span><span class="token punctuation">,</span>
        <span class="token number">1737927609</span><span class="token punctuation">,</span>
        <span class="token number">750987808</span><span class="token punctuation">,</span>
        0x8E364D8FL<span class="token punctuation">,</span>
        0xA0985A77L<span class="token punctuation">,</span>
        <span class="token number">562925334</span><span class="token punctuation">,</span>
        0x837D6DC3L<span class="token punctuation">]</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
        ᘞ <span class="token operator">=</span> <span class="token number">0</span>
        ᘡ<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ᘞ<span class="token punctuation">)</span>
        i <span class="token operator">+=</span> <span class="token number">4</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
            ᘝ <span class="token operator">=</span> <span class="token punctuation">[</span>
                <span class="token number">54</span><span class="token punctuation">,</span>
                <span class="token number">54</span><span class="token punctuation">,</span>
                <span class="token number">54</span><span class="token punctuation">,</span>
                <span class="token number">54</span><span class="token punctuation">]</span>
            ᘠ <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ᘡ<span class="token punctuation">)</span>
            res <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>ᘠ<span class="token punctuation">,</span> ᘡ<span class="token punctuation">,</span> ᘝ<span class="token punctuation">)</span>
            <span class="token keyword">if</span> ᘡ <span class="token operator">==</span> ᘙ<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'You are right!'</span><span class="token punctuation">)</span>
                <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
                quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Why not drink a cup of tea and have a rest?'</span><span class="token punctuation">)</span>
    <span class="token keyword">continue</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>逻辑存在问题，需要我们通过pycdump获取python的字节码，手撸字节码，补充逻辑</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">import</span> dis<span class="token punctuation">,</span>marshal
<span class="token operator">>></span><span class="token operator">></span> f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'a.pyc'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> co<span class="token operator">=</span>marshal<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> dis<span class="token punctuation">.</span>dis<span class="token punctuation">(</span>co<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以读取字节码</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-202608@2x.png"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># visit https://tool.lu/pyc/ for more information</span>
<span class="token comment"># Version: Python 3.10</span>

<span class="token keyword">from</span> cup <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    flag <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'请输入flag'</span><span class="token punctuation">)</span>
    pub_key <span class="token operator">=</span> <span class="token punctuation">[</span>
        0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25L<span class="token punctuation">,</span>
        0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68BL<span class="token punctuation">]</span>
    m <span class="token operator">=</span> libnum<span class="token punctuation">.</span>s2n<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pub_key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> pub_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    flag1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    encodeflag <span class="token operator">=</span> <span class="token punctuation">[</span>
        0xD28ED952L<span class="token punctuation">,</span>
        <span class="token number">1472742623</span><span class="token punctuation">,</span>
        0xD91BA938L<span class="token punctuation">,</span>
        0xF9F3BD2DL<span class="token punctuation">,</span>
        0x8EF8E43DL<span class="token punctuation">,</span>
        <span class="token number">617653972</span><span class="token punctuation">,</span>
        <span class="token number">1474514999</span><span class="token punctuation">,</span>
        <span class="token number">1471783658</span><span class="token punctuation">,</span>
        <span class="token number">1012864704</span><span class="token punctuation">,</span>
        0xD7821910L<span class="token punctuation">,</span>
        <span class="token number">993855884</span><span class="token punctuation">,</span>
        <span class="token number">438456717</span><span class="token punctuation">,</span>
        0xC83555B7L<span class="token punctuation">,</span>
        0xE8DFF468L<span class="token punctuation">,</span>
        <span class="token number">198959101</span><span class="token punctuation">,</span>
        0xC5B84FEBL<span class="token punctuation">,</span>
        0xD9F837C6L<span class="token punctuation">,</span>
        <span class="token number">613157871</span><span class="token punctuation">,</span>
        0x8EFA4EDDL<span class="token punctuation">,</span>
        <span class="token number">97286225</span><span class="token punctuation">,</span>
        0x8B4B608CL<span class="token punctuation">,</span>
        <span class="token number">1471645170</span><span class="token punctuation">,</span>
        0xC0B62792L<span class="token punctuation">,</span>
        <span class="token number">583597118</span><span class="token punctuation">,</span>
        0xAAB1C22DL<span class="token punctuation">,</span>
        0xBDB9C266L<span class="token punctuation">,</span>
        <span class="token number">1384330715</span><span class="token punctuation">,</span>
        0xAE9F9816L<span class="token punctuation">,</span>
        0xD1F40B3CL<span class="token punctuation">,</span>
        0x8206DDC3L<span class="token punctuation">,</span>
        0xC4E0BADCL<span class="token punctuation">,</span>
        0xE407BD26L<span class="token punctuation">,</span>
        <span class="token number">145643141</span><span class="token punctuation">,</span>
        0x8016C6A5L<span class="token punctuation">,</span>
        0xAF4AB9D3L<span class="token punctuation">,</span>
        <span class="token number">506798154</span><span class="token punctuation">,</span>
        <span class="token number">994590281</span><span class="token punctuation">,</span>
        0x85082A0BL<span class="token punctuation">,</span>
        0xCA0BC95AL<span class="token punctuation">,</span>
        0xA7BE567CL<span class="token punctuation">,</span>
        <span class="token number">1105937096</span><span class="token punctuation">,</span>
        <span class="token number">1789727804</span><span class="token punctuation">,</span>
        0xDFEFB591L<span class="token punctuation">,</span>
        0x93346B38L<span class="token punctuation">,</span>
        <span class="token number">1162286478</span><span class="token punctuation">,</span>
        <span class="token number">680814033</span><span class="token punctuation">,</span>
        0xAEE1A7A2L<span class="token punctuation">,</span>
        0x80E574AEL<span class="token punctuation">,</span>
        0xF154F55FL<span class="token punctuation">,</span>
        <span class="token number">2121620700</span><span class="token punctuation">,</span>
        0xFCBDA653L<span class="token punctuation">,</span>
        0x8E902444L<span class="token punctuation">,</span>
        0xCA742E12L<span class="token punctuation">,</span>
        0xB8424071L<span class="token punctuation">,</span>
        0xB4B15EC2L<span class="token punctuation">,</span>
        0x943BFA09L<span class="token punctuation">,</span>
        0xBC97CD93L<span class="token punctuation">,</span>
        <span class="token number">1285603712</span><span class="token punctuation">,</span>
        <span class="token number">798920280</span><span class="token punctuation">,</span>
        0x8B58328FL<span class="token punctuation">,</span>
        0xF9822360L<span class="token punctuation">,</span>
        0xD1FD15EEL<span class="token punctuation">,</span>
        <span class="token number">1077514121</span><span class="token punctuation">,</span>
        <span class="token number">1436444106</span><span class="token punctuation">,</span>
        0xA2D6C17EL<span class="token punctuation">,</span>
        <span class="token number">1507202797</span><span class="token punctuation">,</span>
        <span class="token number">500756149</span><span class="token punctuation">,</span>
        <span class="token number">198754565</span><span class="token punctuation">,</span>
        0x8E014807L<span class="token punctuation">,</span>
        <span class="token number">880454148</span><span class="token punctuation">,</span>
        <span class="token number">1970517398</span><span class="token punctuation">,</span>
        0xBFC6EE25L<span class="token punctuation">,</span>
        <span class="token number">1161840191</span><span class="token punctuation">,</span>
        <span class="token number">560498076</span><span class="token punctuation">,</span>
        <span class="token number">1782600856</span><span class="token punctuation">,</span>
        0x9D93FEBEL<span class="token punctuation">,</span>
        <span class="token number">1285196205</span><span class="token punctuation">,</span>
        <span class="token number">788797746</span><span class="token punctuation">,</span>
        <span class="token number">1195724574</span><span class="token punctuation">,</span>
        0xF2174A07L<span class="token punctuation">,</span>
        <span class="token number">103427523</span><span class="token punctuation">,</span>
        0x952BFE83L<span class="token punctuation">,</span>
        0xF730AC4CL<span class="token punctuation">,</span>
        <span class="token number">617564657</span><span class="token punctuation">,</span>
        <span class="token number">978211984</span><span class="token punctuation">,</span>
        <span class="token number">1781482121</span><span class="token punctuation">,</span>
        0x8379D23AL<span class="token punctuation">,</span>
        0xEAD737EEL<span class="token punctuation">,</span>
        0xE41555FBL<span class="token punctuation">,</span>
        <span class="token number">659557668</span><span class="token punctuation">,</span>
        0x99F3B244L<span class="token punctuation">,</span>
        <span class="token number">1561884856</span><span class="token punctuation">,</span>
        0x842C31A4L<span class="token punctuation">,</span>
        <span class="token number">1189296962</span><span class="token punctuation">,</span>
        <span class="token number">169145316</span><span class="token punctuation">,</span>
        0xA5CE044CL<span class="token punctuation">,</span>
        <span class="token number">1323893433</span><span class="token punctuation">,</span>
        <span class="token number">824667876</span><span class="token punctuation">,</span>
        <span class="token number">408202876</span><span class="token punctuation">,</span>
        0xE0178482L<span class="token punctuation">,</span>
        0xF412BBBCL<span class="token punctuation">,</span>
        <span class="token number">1508996065</span><span class="token punctuation">,</span>
        <span class="token number">162419237</span><span class="token punctuation">,</span>
        0xDE740B00L<span class="token punctuation">,</span>
        0xB7CB64FDL<span class="token punctuation">,</span>
        0xEBCADB1FL<span class="token punctuation">,</span>
        0x8EAE2326L<span class="token punctuation">,</span>
        0x933C216CL<span class="token punctuation">,</span>
        0xD7D1F649L<span class="token punctuation">,</span>
        <span class="token number">481927014</span><span class="token punctuation">,</span>
        0xA448AC16L<span class="token punctuation">,</span>
        0xBC082807L<span class="token punctuation">,</span>
        <span class="token number">1261069441</span><span class="token punctuation">,</span>
        <span class="token number">2063238535</span><span class="token punctuation">,</span>
        0x8474A61DL<span class="token punctuation">,</span>
        <span class="token number">101459755</span><span class="token punctuation">,</span>
        0xBC5654D1L<span class="token punctuation">,</span>
        <span class="token number">1721190841</span><span class="token punctuation">,</span>
        <span class="token number">1078395785</span><span class="token punctuation">,</span>
        <span class="token number">176506553</span><span class="token punctuation">,</span>
        0xD3C5280FL<span class="token punctuation">,</span>
        <span class="token number">1566142515</span><span class="token punctuation">,</span>
        <span class="token number">1938949000</span><span class="token punctuation">,</span>
        <span class="token number">1499289517</span><span class="token punctuation">,</span>
        0xC59872F8L<span class="token punctuation">,</span>
        <span class="token number">829714860</span><span class="token punctuation">,</span>
        0xE51502A2L<span class="token punctuation">,</span>
        <span class="token number">952932374</span><span class="token punctuation">,</span>
        <span class="token number">1283577465</span><span class="token punctuation">,</span>
        <span class="token number">2045007203</span><span class="token punctuation">,</span>
        0xEBE6A798L<span class="token punctuation">,</span>
        0xE09575CDL<span class="token punctuation">,</span>
        0xADDF4157L<span class="token punctuation">,</span>
        0xC4770191L<span class="token punctuation">,</span>
        <span class="token number">482297421</span><span class="token punctuation">,</span>
        <span class="token number">1734231412</span><span class="token punctuation">,</span>
        0xDAC71054L<span class="token punctuation">,</span>
        0x99807E43L<span class="token punctuation">,</span>
        0xA88D74B1L<span class="token punctuation">,</span>
        0xCB77E028L<span class="token punctuation">,</span>
        <span class="token number">1533519803</span><span class="token punctuation">,</span>
        0xEEEBC3B6L<span class="token punctuation">,</span>
        0xE7E680E5L<span class="token punctuation">,</span>
        <span class="token number">272960248</span><span class="token punctuation">,</span>
        <span class="token number">317508587</span><span class="token punctuation">,</span>
        0xC4B10CDCL<span class="token punctuation">,</span>
        0x91776399L<span class="token punctuation">,</span>
        <span class="token number">27470488</span><span class="token punctuation">,</span>
        <span class="token number">1666674386</span><span class="token punctuation">,</span>
        <span class="token number">1737927609</span><span class="token punctuation">,</span>
        <span class="token number">750987808</span><span class="token punctuation">,</span>
        0x8E364D8FL<span class="token punctuation">,</span>
        0xA0985A77L<span class="token punctuation">,</span>
        <span class="token number">562925334</span><span class="token punctuation">,</span>
        0x837D6DC3L<span class="token punctuation">]</span>
    i <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">if</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
        x <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> ii <span class="token keyword">in</span> c<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> x<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token operator">+</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span>
        flag1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
        i<span class="token operator">=</span>i<span class="token operator">+</span><span class="token number">4</span>
        
        <span class="token keyword">if</span> <span class="token keyword">not</span> i <span class="token operator">&lt;</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>
            key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">]</span>
            <span class="token builtin">len</span> <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span>
            res <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">,</span> flag1<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
            <span class="token keyword">if</span> flag1 <span class="token operator">==</span> encodeflag<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'You are right!'</span><span class="token punctuation">)</span>
                <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
                quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Why not drink a cup of tea and have a rest?'</span><span class="token punctuation">)</span>
    <span class="token keyword">continue</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>已经修复完了，但是我们不知道encrypt的加密方式，因为这个是来自cup这个包，这个包是作者自己导入的</p>
<p>关于pyinstaller<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-271253.htm">打包这篇博客写的很详细</a></p>
<p>有-key参数的逆向，将py编译成pyc，然后部分压缩成pyz，程序再通过对pyc和pyz的调用，那么问题来了，cup这个包在pyz文件夹中，但是我们pyinstxtractor后，文件是空的，因为我们需要有相同的python环境，本程序的python环境是3.10</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-210207@2x.png"></p>
<p>我又下了个python3.10</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-213218@2x.png"></p>
<p>我们反编译archive.pyc可以看出pyinstxtractor使用tinyAes加密我们的cup包，有现成的解密脚本可以套</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> tinyaes
<span class="token keyword">import</span> zlib
 
CRYPT_BLOCK_SIZE <span class="token operator">=</span> <span class="token number">16</span>
 
<span class="token comment"># 从crypt_key.pyc获取key，也可自行反编译获取</span>
key <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">(</span><span class="token string">'0000000000000tea'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span>
 
inf <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'cup.pyc.encrypted'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token comment"># 打开加密文件</span>
outf <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output.pyc'</span><span class="token punctuation">,</span> <span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token comment"># 输出文件</span>
 
<span class="token comment"># 按加密块大小进行读取</span>
iv <span class="token operator">=</span> inf<span class="token punctuation">.</span>read<span class="token punctuation">(</span>CRYPT_BLOCK_SIZE<span class="token punctuation">)</span>
 
cipher <span class="token operator">=</span> tinyaes<span class="token punctuation">.</span>AES<span class="token punctuation">(</span>key<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
 
<span class="token comment"># 解密</span>
plaintext <span class="token operator">=</span> zlib<span class="token punctuation">.</span>decompress<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>CTR_xcrypt_buffer<span class="token punctuation">(</span>inf<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment"># 补pyc头(最后自己补也行)</span>
outf<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b'\x6f\x0d\x0d\x0a\0\0\0\0\0\0\0\0\0\0\0\0'</span><span class="token punctuation">)</span>
 
<span class="token comment"># 写入解密数据</span>
outf<span class="token punctuation">.</span>write<span class="token punctuation">(</span>plaintext<span class="token punctuation">)</span>
 
inf<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
outf<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>密钥需要我们反汇编crypto_key.pyc文件</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-213859@2x.png"></p>
<p>现在就需要解包</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-213953@2x.png"></p>
<p>反编译后是一个没有任何修改的xxtea</p>
<p><img src="https://raw.githubusercontent.com/Whitebird0/tuchuang/main/QQ20220531-220500@2x.png"></p>
<p>所以我们先解xxtea，得到rsa加密的密文，再解rsa</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">DELTA</span> <span class="token expression"><span class="token number">0x9e3779b9</span></span><span class="token comment">//0x61C88647</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">3532577106</span><span class="token punctuation">,</span> <span class="token number">1472742623</span><span class="token punctuation">,</span> <span class="token number">3642468664</span><span class="token punctuation">,</span> <span class="token number">4193500461</span><span class="token punctuation">,</span> <span class="token number">2398676029</span><span class="token punctuation">,</span> <span class="token number">617653972</span><span class="token punctuation">,</span> <span class="token number">1474514999</span><span class="token punctuation">,</span> <span class="token number">1471783658</span><span class="token punctuation">,</span> <span class="token number">1012864704</span><span class="token punctuation">,</span> <span class="token number">3615627536</span><span class="token punctuation">,</span> <span class="token number">993855884</span><span class="token punctuation">,</span> <span class="token number">438456717</span><span class="token punctuation">,</span> 
	<span class="token number">3358938551</span><span class="token punctuation">,</span> <span class="token number">3906991208</span><span class="token punctuation">,</span> <span class="token number">198959101</span><span class="token punctuation">,</span> <span class="token number">3317190635</span><span class="token punctuation">,</span> <span class="token number">3656923078</span><span class="token punctuation">,</span> <span class="token number">613157871</span><span class="token punctuation">,</span> <span class="token number">2398768861</span><span class="token punctuation">,</span> <span class="token number">97286225</span><span class="token punctuation">,</span> <span class="token number">2336972940</span><span class="token punctuation">,</span> <span class="token number">1471645170</span><span class="token punctuation">,</span> <span class="token number">3233163154</span><span class="token punctuation">,</span> <span class="token number">583597118</span><span class="token punctuation">,</span> <span class="token number">2863776301</span><span class="token punctuation">,</span> 
	<span class="token number">3183067750</span><span class="token punctuation">,</span> <span class="token number">1384330715</span><span class="token punctuation">,</span> <span class="token number">2929694742</span><span class="token punctuation">,</span> <span class="token number">3522431804</span><span class="token punctuation">,</span> <span class="token number">2181488067</span><span class="token punctuation">,</span> <span class="token number">3303062236</span><span class="token punctuation">,</span> <span class="token number">3825712422</span><span class="token punctuation">,</span> <span class="token number">145643141</span><span class="token punctuation">,</span> <span class="token number">2148976293</span><span class="token punctuation">,</span> <span class="token number">2940910035</span><span class="token punctuation">,</span> <span class="token number">506798154</span><span class="token punctuation">,</span> <span class="token number">994590281</span><span class="token punctuation">,</span> <span class="token number">2231904779</span><span class="token punctuation">,</span> 
	<span class="token number">3389770074</span><span class="token punctuation">,</span> <span class="token number">2814269052</span><span class="token punctuation">,</span> <span class="token number">1105937096</span><span class="token punctuation">,</span> <span class="token number">1789727804</span><span class="token punctuation">,</span> <span class="token number">3757028753</span><span class="token punctuation">,</span> <span class="token number">2469686072</span><span class="token punctuation">,</span> <span class="token number">1162286478</span><span class="token punctuation">,</span> <span class="token number">680814033</span><span class="token punctuation">,</span> <span class="token number">2934024098</span><span class="token punctuation">,</span> <span class="token number">2162521262</span><span class="token punctuation">,</span> <span class="token number">4048876895</span><span class="token punctuation">,</span> <span class="token number">2121620700</span><span class="token punctuation">,</span> <span class="token number">4240287315</span><span class="token punctuation">,</span>
	 <span class="token number">2391811140</span><span class="token punctuation">,</span> <span class="token number">3396611602</span><span class="token punctuation">,</span> <span class="token number">3091349617</span><span class="token punctuation">,</span> <span class="token number">3031523010</span><span class="token punctuation">,</span> <span class="token number">2486958601</span><span class="token punctuation">,</span> <span class="token number">3164065171</span><span class="token punctuation">,</span> <span class="token number">1285603712</span><span class="token punctuation">,</span> <span class="token number">798920280</span><span class="token punctuation">,</span> <span class="token number">2337813135</span><span class="token punctuation">,</span> <span class="token number">4186055520</span><span class="token punctuation">,</span> <span class="token number">3523024366</span><span class="token punctuation">,</span> <span class="token number">1077514121</span><span class="token punctuation">,</span> <span class="token number">1436444106</span><span class="token punctuation">,</span>
	  <span class="token number">2731983230</span><span class="token punctuation">,</span> <span class="token number">1507202797</span><span class="token punctuation">,</span> <span class="token number">500756149</span><span class="token punctuation">,</span> <span class="token number">198754565</span><span class="token punctuation">,</span> <span class="token number">2382448647</span><span class="token punctuation">,</span> <span class="token number">880454148</span><span class="token punctuation">,</span> <span class="token number">1970517398</span><span class="token punctuation">,</span> <span class="token number">3217485349</span><span class="token punctuation">,</span> <span class="token number">1161840191</span><span class="token punctuation">,</span> <span class="token number">560498076</span><span class="token punctuation">,</span> <span class="token number">1782600856</span><span class="token punctuation">,</span> <span class="token number">2643721918</span><span class="token punctuation">,</span> <span class="token number">1285196205</span><span class="token punctuation">,</span> 
	  <span class="token number">788797746</span><span class="token punctuation">,</span> <span class="token number">1195724574</span><span class="token punctuation">,</span> <span class="token number">4061612551</span><span class="token punctuation">,</span> <span class="token number">103427523</span><span class="token punctuation">,</span> <span class="token number">2502688387</span><span class="token punctuation">,</span> <span class="token number">4147162188</span><span class="token punctuation">,</span> <span class="token number">617564657</span><span class="token punctuation">,</span> <span class="token number">978211984</span><span class="token punctuation">,</span> <span class="token number">1781482121</span><span class="token punctuation">,</span> <span class="token number">2205798970</span><span class="token punctuation">,</span> <span class="token number">3939973102</span><span class="token punctuation">,</span> <span class="token number">3826603515</span><span class="token punctuation">,</span> <span class="token number">659557668</span><span class="token punctuation">,</span> 
	  <span class="token number">2582884932</span><span class="token punctuation">,</span> <span class="token number">1561884856</span><span class="token punctuation">,</span> <span class="token number">2217488804</span><span class="token punctuation">,</span> <span class="token number">1189296962</span><span class="token punctuation">,</span> <span class="token number">169145316</span><span class="token punctuation">,</span> <span class="token number">2781742156</span><span class="token punctuation">,</span> <span class="token number">1323893433</span><span class="token punctuation">,</span> <span class="token number">824667876</span><span class="token punctuation">,</span> <span class="token number">408202876</span><span class="token punctuation">,</span> <span class="token number">3759637634</span><span class="token punctuation">,</span> <span class="token number">4094868412</span><span class="token punctuation">,</span> <span class="token number">1508996065</span><span class="token punctuation">,</span> <span class="token number">162419237</span><span class="token punctuation">,</span>
	   <span class="token number">3732146944</span><span class="token punctuation">,</span> <span class="token number">3083560189</span><span class="token punctuation">,</span> <span class="token number">3955940127</span><span class="token punctuation">,</span> <span class="token number">2393776934</span><span class="token punctuation">,</span> <span class="token number">2470191468</span><span class="token punctuation">,</span> <span class="token number">3620861513</span><span class="token punctuation">,</span> <span class="token number">481927014</span><span class="token punctuation">,</span> <span class="token number">2756226070</span><span class="token punctuation">,</span> <span class="token number">3154651143</span><span class="token punctuation">,</span> <span class="token number">1261069441</span><span class="token punctuation">,</span> <span class="token number">2063238535</span><span class="token punctuation">,</span> <span class="token number">2222237213</span><span class="token punctuation">,</span> <span class="token number">101459755</span><span class="token punctuation">,</span>
	    <span class="token number">3159774417</span><span class="token punctuation">,</span> <span class="token number">1721190841</span><span class="token punctuation">,</span> <span class="token number">1078395785</span><span class="token punctuation">,</span> <span class="token number">176506553</span><span class="token punctuation">,</span> <span class="token number">3552913423</span><span class="token punctuation">,</span> <span class="token number">1566142515</span><span class="token punctuation">,</span> <span class="token number">1938949000</span><span class="token punctuation">,</span> <span class="token number">1499289517</span><span class="token punctuation">,</span> <span class="token number">3315102456</span><span class="token punctuation">,</span> <span class="token number">829714860</span><span class="token punctuation">,</span> <span class="token number">3843359394</span><span class="token punctuation">,</span> <span class="token number">952932374</span><span class="token punctuation">,</span> <span class="token number">1283577465</span><span class="token punctuation">,</span>
		 <span class="token number">2045007203</span><span class="token punctuation">,</span> <span class="token number">3957761944</span><span class="token punctuation">,</span> <span class="token number">3767891405</span><span class="token punctuation">,</span> <span class="token number">2917089623</span><span class="token punctuation">,</span> <span class="token number">3296133521</span><span class="token punctuation">,</span> <span class="token number">482297421</span><span class="token punctuation">,</span> <span class="token number">1734231412</span><span class="token punctuation">,</span> <span class="token number">3670478932</span><span class="token punctuation">,</span> <span class="token number">2575334979</span><span class="token punctuation">,</span> <span class="token number">2827842737</span><span class="token punctuation">,</span> <span class="token number">3413631016</span><span class="token punctuation">,</span> <span class="token number">1533519803</span><span class="token punctuation">,</span> 
	<span class="token number">4008428470</span><span class="token punctuation">,</span> <span class="token number">3890643173</span><span class="token punctuation">,</span> <span class="token number">272960248</span><span class="token punctuation">,</span> <span class="token number">317508587</span><span class="token punctuation">,</span> <span class="token number">3299937500</span><span class="token punctuation">,</span> <span class="token number">2440520601</span><span class="token punctuation">,</span> <span class="token number">27470488</span><span class="token punctuation">,</span> <span class="token number">1666674386</span><span class="token punctuation">,</span> <span class="token number">1737927609</span><span class="token punctuation">,</span> <span class="token number">750987808</span><span class="token punctuation">,</span> <span class="token number">2385923471</span><span class="token punctuation">,</span> <span class="token number">2694339191</span><span class="token punctuation">,</span> <span class="token number">562925334</span><span class="token punctuation">,</span> 
	<span class="token number">2206035395</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
	<span class="token keyword">unsigned</span> <span class="token keyword">int</span> key<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">unsigned</span> <span class="token keyword">int</span> y<span class="token punctuation">,</span>z<span class="token punctuation">,</span>p<span class="token punctuation">,</span>rounds<span class="token punctuation">,</span>e<span class="token punctuation">;</span>
    <span class="token keyword">int</span> n <span class="token operator">=</span> <span class="token number">155</span><span class="token punctuation">;</span>  <span class="token comment">//</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    rounds <span class="token operator">=</span> <span class="token number">6</span> <span class="token operator">+</span> <span class="token number">52</span><span class="token operator">/</span>n<span class="token punctuation">;</span>
    y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    sum <span class="token operator">=</span> <span class="token punctuation">(</span>rounds<span class="token operator">*</span>DELTA<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">;</span>
     <span class="token keyword">do</span>                
     <span class="token punctuation">&#123;</span>
        e <span class="token operator">=</span> sum <span class="token operator">>></span> <span class="token number">2</span> <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>p<span class="token operator">=</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>p<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">;</span>p<span class="token operator">--</span><span class="token punctuation">)</span>    
        <span class="token punctuation">&#123;</span>
            z <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v<span class="token punctuation">[</span>p<span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z<span class="token operator">>></span><span class="token number">5</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>z<span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p<span class="token operator">^</span>e<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>z<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>y <span class="token operator">^</span> sum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">;</span>
            y <span class="token operator">=</span> v<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        z <span class="token operator">=</span> v<span class="token punctuation">[</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span><span class="token punctuation">(</span>p<span class="token operator">^</span>e<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">^</span>z<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>y <span class="token operator">^</span> sum<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>y<span class="token operator">&lt;&lt;</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>z<span class="token operator">>></span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>z<span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>y<span class="token operator">>></span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0xffffffff</span><span class="token punctuation">;</span>
        y <span class="token operator">=</span> v<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        sum <span class="token operator">=</span> <span class="token punctuation">(</span>sum<span class="token operator">-</span>DELTA<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffffffff</span><span class="token punctuation">;</span>
     <span class="token punctuation">&#125;</span><span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">--</span>rounds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span>n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
       	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%u"</span><span class="token punctuation">,</span>v<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

#<span class="token number">825243185</span> <span class="token number">808661814</span> <span class="token number">892548151</span> <span class="token number">892941616</span> <span class="token number">892876857</span> <span class="token number">909129523</span> <span class="token number">960049970</span> <span class="token number">842217527</span> <span class="token number">825702707</span> <span class="token number">825636663</span> <span class="token number">825505848</span> <span class="token number">876163635</span> <span class="token number">876032567</span> <span class="token number">876033073</span> <span class="token number">959526968</span> <span class="token number">909260343</span> <span class="token number">943077682</span> <span class="token number">892352569</span> <span class="token number">892547384</span> <span class="token number">892876598</span> <span class="token number">892809273</span> <span class="token number">942748210</span> <span class="token number">926234676</span> <span class="token number">808465462</span> <span class="token number">926299448</span> <span class="token number">808858163</span> <span class="token number">892678966</span> <span class="token number">909391921</span> <span class="token number">943207731</span> <span class="token number">909653561</span> <span class="token number">858992688</span> <span class="token number">875706672</span> <span class="token number">808925233</span> <span class="token number">892548658</span> <span class="token number">808531512</span> <span class="token number">808793142</span> <span class="token number">909455416</span> <span class="token number">909391416</span> <span class="token number">875640629</span> <span class="token number">875639608</span> <span class="token number">842543668</span> <span class="token number">925906993</span> <span class="token number">808727608</span> <span class="token number">808990770</span> <span class="token number">892811058</span> <span class="token number">808465714</span> <span class="token number">959984178</span> <span class="token number">959854645</span> <span class="token number">858863412</span> <span class="token number">858796082</span> <span class="token number">858796345</span> <span class="token number">859058993</span> <span class="token number">808662073</span> <span class="token number">808465715</span> <span class="token number">875639088</span> <span class="token number">875968822</span> <span class="token number">943208249</span> <span class="token number">875770168</span> <span class="token number">842020660</span> <span class="token number">876032818</span> <span class="token number">959985205</span> <span class="token number">809054259</span> <span class="token number">892612916</span> <span class="token number">959723825</span> <span class="token number">942814774</span> <span class="token number">942814000</span> <span class="token number">859257144</span> <span class="token number">875574580</span> <span class="token number">926365753</span> <span class="token number">808662582</span> <span class="token number">909389878</span> <span class="token number">892613945</span> <span class="token number">942683445</span> <span class="token number">925906740</span> <span class="token number">842086705</span> <span class="token number">909260083</span> <span class="token number">909129015</span> <span class="token number">825505328</span> <span class="token number">959461173</span> <span class="token number">942748984</span> <span class="token number">825374769</span> <span class="token number">943273008</span> <span class="token number">909129523</span> <span class="token number">942684466</span> <span class="token number">842412854</span> <span class="token number">825504821</span> <span class="token number">808728114</span> <span class="token number">842347826</span> <span class="token number">876163383</span> <span class="token number">808991028</span> <span class="token number">859060281</span> <span class="token number">926496055</span> <span class="token number">858796339</span> <span class="token number">959853875</span> <span class="token number">875901237</span> <span class="token number">959853621</span> <span class="token number">876033078</span> <span class="token number">842281525</span> <span class="token number">925972786</span> <span class="token number">808794161</span> <span class="token number">959657010</span> <span class="token number">825700918</span> <span class="token number">909719609</span> <span class="token number">959788086</span> <span class="token number">959853874</span> <span class="token number">842084408</span> <span class="token number">875575608</span> <span class="token number">909717560</span> <span class="token number">959657527</span> <span class="token number">842348853</span> <span class="token number">959853105</span> <span class="token number">842610743</span> <span class="token number">959460401</span> <span class="token number">892352313</span> <span class="token number">808661553</span> <span class="token number">808990001</span> <span class="token number">925906487</span> <span class="token number">959657784</span> <span class="token number">942879025</span> <span class="token number">875901497</span> <span class="token number">926103350</span> <span class="token number">959657272</span> <span class="token number">875902263</span> <span class="token number">909195568</span> <span class="token number">926101555</span> <span class="token number">909325113</span> <span class="token number">892744498</span> <span class="token number">842610482</span> <span class="token number">892416053</span> <span class="token number">808464949</span> <span class="token number">858796089</span> <span class="token number">808989497</span> <span class="token number">842151736</span> <span class="token number">825832244</span> <span class="token number">875574839</span> <span class="token number">858863155</span> <span class="token number">859256117</span> <span class="token number">875640887</span> <span class="token number">892549173</span> <span class="token number">943272752</span> <span class="token number">876033589</span> <span class="token number">926299954</span> <span class="token number">808990516</span> <span class="token number">842086707</span> <span class="token number">892941366</span> <span class="token number">909455411</span> <span class="token number">892549177</span> <span class="token number">858862391</span> <span class="token number">825504820</span> <span class="token number">876032051</span> <span class="token number">808661305</span> <span class="token number">859123763</span> <span class="token number">926102329</span> <span class="token number">842018867</span> <span class="token number">57</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>中间还有一层是左移的操作，没想到怎么逆写算法，直接爆破吧</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">825243185</span><span class="token punctuation">,</span><span class="token number">808661814</span><span class="token punctuation">,</span><span class="token number">892548151</span><span class="token punctuation">,</span><span class="token number">892941616</span><span class="token punctuation">,</span><span class="token number">892876857</span><span class="token punctuation">,</span><span class="token number">909129523</span><span class="token punctuation">,</span><span class="token number">960049970</span><span class="token punctuation">,</span><span class="token number">842217527</span><span class="token punctuation">,</span><span class="token number">825702707</span><span class="token punctuation">,</span><span class="token number">825636663</span><span class="token punctuation">,</span><span class="token number">825505848</span><span class="token punctuation">,</span><span class="token number">876163635</span><span class="token punctuation">,</span><span class="token number">876032567</span><span class="token punctuation">,</span><span class="token number">876033073</span><span class="token punctuation">,</span><span class="token number">959526968</span><span class="token punctuation">,</span><span class="token number">909260343</span><span class="token punctuation">,</span><span class="token number">943077682</span><span class="token punctuation">,</span><span class="token number">892352569</span><span class="token punctuation">,</span><span class="token number">892547384</span><span class="token punctuation">,</span><span class="token number">892876598</span><span class="token punctuation">,</span><span class="token number">892809273</span><span class="token punctuation">,</span><span class="token number">942748210</span><span class="token punctuation">,</span><span class="token number">926234676</span><span class="token punctuation">,</span><span class="token number">808465462</span><span class="token punctuation">,</span><span class="token number">926299448</span><span class="token punctuation">,</span><span class="token number">808858163</span><span class="token punctuation">,</span><span class="token number">892678966</span><span class="token punctuation">,</span><span class="token number">909391921</span><span class="token punctuation">,</span><span class="token number">943207731</span><span class="token punctuation">,</span><span class="token number">909653561</span><span class="token punctuation">,</span><span class="token number">858992688</span><span class="token punctuation">,</span><span class="token number">875706672</span><span class="token punctuation">,</span><span class="token number">808925233</span><span class="token punctuation">,</span><span class="token number">892548658</span><span class="token punctuation">,</span><span class="token number">808531512</span><span class="token punctuation">,</span><span class="token number">808793142</span><span class="token punctuation">,</span><span class="token number">909455416</span><span class="token punctuation">,</span><span class="token number">909391416</span><span class="token punctuation">,</span><span class="token number">875640629</span><span class="token punctuation">,</span><span class="token number">875639608</span><span class="token punctuation">,</span><span class="token number">842543668</span><span class="token punctuation">,</span><span class="token number">925906993</span><span class="token punctuation">,</span><span class="token number">808727608</span><span class="token punctuation">,</span><span class="token number">808990770</span><span class="token punctuation">,</span><span class="token number">892811058</span><span class="token punctuation">,</span><span class="token number">808465714</span><span class="token punctuation">,</span><span class="token number">959984178</span><span class="token punctuation">,</span><span class="token number">959854645</span><span class="token punctuation">,</span><span class="token number">858863412</span><span class="token punctuation">,</span><span class="token number">858796082</span><span class="token punctuation">,</span><span class="token number">858796345</span><span class="token punctuation">,</span><span class="token number">859058993</span><span class="token punctuation">,</span><span class="token number">808662073</span><span class="token punctuation">,</span><span class="token number">808465715</span><span class="token punctuation">,</span><span class="token number">875639088</span><span class="token punctuation">,</span><span class="token number">875968822</span><span class="token punctuation">,</span><span class="token number">943208249</span><span class="token punctuation">,</span><span class="token number">875770168</span><span class="token punctuation">,</span><span class="token number">842020660</span><span class="token punctuation">,</span><span class="token number">876032818</span><span class="token punctuation">,</span><span class="token number">959985205</span><span class="token punctuation">,</span><span class="token number">809054259</span><span class="token punctuation">,</span><span class="token number">892612916</span><span class="token punctuation">,</span><span class="token number">959723825</span><span class="token punctuation">,</span><span class="token number">942814774</span><span class="token punctuation">,</span><span class="token number">942814000</span><span class="token punctuation">,</span><span class="token number">859257144</span><span class="token punctuation">,</span><span class="token number">875574580</span><span class="token punctuation">,</span><span class="token number">926365753</span><span class="token punctuation">,</span><span class="token number">808662582</span><span class="token punctuation">,</span><span class="token number">909389878</span><span class="token punctuation">,</span><span class="token number">892613945</span><span class="token punctuation">,</span><span class="token number">942683445</span><span class="token punctuation">,</span><span class="token number">925906740</span><span class="token punctuation">,</span><span class="token number">842086705</span><span class="token punctuation">,</span><span class="token number">909260083</span><span class="token punctuation">,</span><span class="token number">909129015</span><span class="token punctuation">,</span><span class="token number">825505328</span><span class="token punctuation">,</span><span class="token number">959461173</span><span class="token punctuation">,</span><span class="token number">942748984</span><span class="token punctuation">,</span><span class="token number">825374769</span><span class="token punctuation">,</span><span class="token number">943273008</span><span class="token punctuation">,</span><span class="token number">909129523</span><span class="token punctuation">,</span><span class="token number">942684466</span><span class="token punctuation">,</span><span class="token number">842412854</span><span class="token punctuation">,</span><span class="token number">825504821</span><span class="token punctuation">,</span><span class="token number">808728114</span><span class="token punctuation">,</span><span class="token number">842347826</span><span class="token punctuation">,</span><span class="token number">876163383</span><span class="token punctuation">,</span><span class="token number">808991028</span><span class="token punctuation">,</span><span class="token number">859060281</span><span class="token punctuation">,</span><span class="token number">926496055</span><span class="token punctuation">,</span><span class="token number">858796339</span><span class="token punctuation">,</span><span class="token number">959853875</span><span class="token punctuation">,</span><span class="token number">875901237</span><span class="token punctuation">,</span><span class="token number">959853621</span><span class="token punctuation">,</span><span class="token number">876033078</span><span class="token punctuation">,</span><span class="token number">842281525</span><span class="token punctuation">,</span><span class="token number">925972786</span><span class="token punctuation">,</span><span class="token number">808794161</span><span class="token punctuation">,</span><span class="token number">959657010</span><span class="token punctuation">,</span><span class="token number">825700918</span><span class="token punctuation">,</span><span class="token number">909719609</span><span class="token punctuation">,</span><span class="token number">959788086</span><span class="token punctuation">,</span><span class="token number">959853874</span><span class="token punctuation">,</span><span class="token number">842084408</span><span class="token punctuation">,</span><span class="token number">875575608</span><span class="token punctuation">,</span><span class="token number">909717560</span><span class="token punctuation">,</span><span class="token number">959657527</span><span class="token punctuation">,</span><span class="token number">842348853</span><span class="token punctuation">,</span><span class="token number">959853105</span><span class="token punctuation">,</span><span class="token number">842610743</span><span class="token punctuation">,</span><span class="token number">959460401</span><span class="token punctuation">,</span><span class="token number">892352313</span><span class="token punctuation">,</span><span class="token number">808661553</span><span class="token punctuation">,</span><span class="token number">808990001</span><span class="token punctuation">,</span><span class="token number">925906487</span><span class="token punctuation">,</span><span class="token number">959657784</span><span class="token punctuation">,</span><span class="token number">942879025</span><span class="token punctuation">,</span><span class="token number">875901497</span><span class="token punctuation">,</span><span class="token number">926103350</span><span class="token punctuation">,</span><span class="token number">959657272</span><span class="token punctuation">,</span><span class="token number">875902263</span><span class="token punctuation">,</span><span class="token number">909195568</span><span class="token punctuation">,</span><span class="token number">926101555</span><span class="token punctuation">,</span><span class="token number">909325113</span><span class="token punctuation">,</span><span class="token number">892744498</span><span class="token punctuation">,</span><span class="token number">842610482</span><span class="token punctuation">,</span><span class="token number">892416053</span><span class="token punctuation">,</span><span class="token number">808464949</span><span class="token punctuation">,</span><span class="token number">858796089</span><span class="token punctuation">,</span><span class="token number">808989497</span><span class="token punctuation">,</span><span class="token number">842151736</span><span class="token punctuation">,</span><span class="token number">825832244</span><span class="token punctuation">,</span><span class="token number">875574839</span><span class="token punctuation">,</span><span class="token number">858863155</span><span class="token punctuation">,</span><span class="token number">859256117</span><span class="token punctuation">,</span><span class="token number">875640887</span><span class="token punctuation">,</span><span class="token number">892549173</span><span class="token punctuation">,</span><span class="token number">943272752</span><span class="token punctuation">,</span><span class="token number">876033589</span><span class="token punctuation">,</span><span class="token number">926299954</span><span class="token punctuation">,</span><span class="token number">808990516</span><span class="token punctuation">,</span><span class="token number">842086707</span><span class="token punctuation">,</span><span class="token number">892941366</span><span class="token punctuation">,</span><span class="token number">909455411</span><span class="token punctuation">,</span><span class="token number">892549177</span><span class="token punctuation">,</span><span class="token number">858862391</span><span class="token punctuation">,</span><span class="token number">825504820</span><span class="token punctuation">,</span><span class="token number">876032051</span><span class="token punctuation">,</span><span class="token number">808661305</span><span class="token punctuation">,</span><span class="token number">859123763</span><span class="token punctuation">,</span>
   <span class="token number">926102329</span><span class="token punctuation">,</span><span class="token number">842018867</span><span class="token punctuation">]</span>
cc<span class="token operator">=</span><span class="token string">""</span>
x<span class="token operator">=</span><span class="token number">0</span>
arr <span class="token operator">=</span> <span class="token string">"0123456789"</span>

<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> cc
    <span class="token keyword">global</span> x
    <span class="token keyword">if</span> x<span class="token operator">==</span><span class="token number">154</span><span class="token punctuation">:</span><span class="token comment">#最后一位特殊考虑</span>
        <span class="token keyword">for</span> q <span class="token keyword">in</span> arr<span class="token punctuation">:</span>
            guess <span class="token operator">=</span> q
            s <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> ii <span class="token keyword">in</span> guess<span class="token punctuation">:</span>
                s <span class="token operator">=</span> <span class="token punctuation">(</span>s <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span>
            <span class="token keyword">if</span> s <span class="token operator">==</span> <span class="token number">57</span><span class="token punctuation">:</span>
                cc <span class="token operator">+=</span> guess
                <span class="token keyword">return</span>
    <span class="token keyword">for</span> q <span class="token keyword">in</span> arr<span class="token punctuation">:</span>
        <span class="token keyword">for</span> b <span class="token keyword">in</span> arr<span class="token punctuation">:</span>
            <span class="token keyword">for</span> c <span class="token keyword">in</span> arr<span class="token punctuation">:</span>
                <span class="token keyword">for</span> d <span class="token keyword">in</span> arr<span class="token punctuation">:</span>
                    guess<span class="token operator">=</span>q<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d
                    s<span class="token operator">=</span><span class="token number">0</span>
                    <span class="token keyword">for</span> ii <span class="token keyword">in</span> guess<span class="token punctuation">:</span>
                        s<span class="token operator">=</span><span class="token punctuation">(</span>s<span class="token operator">&lt;&lt;</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token builtin">ord</span><span class="token punctuation">(</span>ii<span class="token punctuation">)</span>
                    <span class="token keyword">if</span> s<span class="token operator">==</span>a<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">:</span>
                        cc<span class="token operator">+=</span>guess
                        x<span class="token operator">+=</span><span class="token number">1</span>
                        <span class="token keyword">return</span>

<span class="token keyword">while</span> x<span class="token operator">&lt;</span><span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    test<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token keyword">print</span><span class="token punctuation">(</span>cc<span class="token punctuation">)</span>



<span class="token comment">#10610336534759505889607399322387179316771488492347274741918862678692508953185876570981227584004676580623553664818853686933004290078153620168054665086468417541382824708104480882577200529822968531743002301934310349005341104696887943182074473298650903541494918266823037984054778903666406545980557074219162536057146090758158128189406073809226361445046225524917089434897957301396534515964547462425719205819342172669899546965221084098690893672595962129879041507903210851706793788311452973769358455761907303633956322972510500253009083922781934406731633755418753858930476576720874219359466503538931371444470303193503733920039</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>现在只剩最后一步解RSA！但是我不会，贴个t0hka1师傅的脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">import</span> ContinuedFractions<span class="token punctuation">,</span> Arithmetic
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes
 
 
<span class="token keyword">def</span> <span class="token function">wiener_hack</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># firstly git clone https://github.com/pablocelayes/rsa-wiener-attack.git !</span>
    frac <span class="token operator">=</span> ContinuedFractions<span class="token punctuation">.</span>rational_to_contfrac<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    convergents <span class="token operator">=</span> ContinuedFractions<span class="token punctuation">.</span>convergents_from_contfrac<span class="token punctuation">(</span>frac<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>k<span class="token punctuation">,</span> d<span class="token punctuation">)</span> <span class="token keyword">in</span> convergents<span class="token punctuation">:</span>
        <span class="token keyword">if</span> k <span class="token operator">!=</span> <span class="token number">0</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            phi <span class="token operator">=</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k
            s <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>
            discr <span class="token operator">=</span> s <span class="token operator">*</span> s <span class="token operator">-</span> <span class="token number">4</span> <span class="token operator">*</span> n
            <span class="token keyword">if</span> <span class="token punctuation">(</span>discr <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                t <span class="token operator">=</span> Arithmetic<span class="token punctuation">.</span>is_perfect_square<span class="token punctuation">(</span>discr<span class="token punctuation">)</span>
                <span class="token keyword">if</span> t <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>s <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    <span class="token keyword">return</span> d
    <span class="token keyword">return</span> <span class="token boolean">False</span>
 
 
<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    pub_key <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">0x649EE967E7916A825CC9FD3320BEABF263BEAC68C080F52824A0F521EDB6B78577EC52BF1C9E78F4BB71192F9A23F1A17AA76E5979E4D953329D3CA65FB4A71DA57412B59DFD6AEDF0191C5555D3E5F582B81B5E6B23163E9889204A81AFFDF119FE25C92F4ED59BD3285BCD7AAE14824240D2E33C5A97848F4EB7AAC203DE6330D2B4D8FF61691544FBECD120F99A157B3D2F58FA51B2887A9D06CA383C44D071314A12B17928B96F03A06E959A5AFEFA0183664F52CD32B9FC72A04B45913FCB2D5D2D3A415A14F611CF1EAC2D6C785142A8E9CC41B67A6CD85001B06EDB8CA767D367E56E0AE651491BF8A8C17A38A1835DB9E4A9292B1D86D5776C98CC25</span><span class="token punctuation">,</span>
    <span class="token number">0x647327833ACFEF1F9C83E74E171FC300FA347D4A6769476C33DA82C95120ACB38B62B33D429206FE6E9BB0BB7AB748A1036971BEA36EC47130B749C1C9FF6FE03D0F7D9FC5346EB0E575BDFA6C530AA57CD676894FC080D2DD049AB59625F4B9C78BCFD95CDCD2793E440E26E189D251121CB6EB177FEDB596409034E8B0C5BBD9BD9342235DBB226C9170EFE347FF0FD2CFF9A1F7B647CC83E4D8F005FD7125A89251C768AFE70BDD54B88116814D5030F499BCAC4673CCCC342FB4B6AC58EA5A64546DC25912B6C430529F6A7F449FD96536DE269D1A1B015A4AC6B6E46EE19DCE8143726A6503E290E4BAE6BD78319B5878981F6CFFDB3B818209341FD68B</span><span class="token punctuation">]</span>
    <span class="token comment"># 0->n,1->e</span>
 
    n <span class="token operator">=</span> pub_key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    e <span class="token operator">=</span> pub_key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    c <span class="token operator">=</span> <span class="token number">10610336534759505889607399322387179316771488492347274741918862678692508953185876570981227584004676580623553664818853686933004290078153620168054665086468417541382824708104480882577200529822968531743002301934310349005341104696887943182074473298650903541494918266823037984054778903666406545980557074219162536057146090758158128189406073809226361445046225524917089434897957301396534515964547462425719205819342172669899546965221084098690893672595962129879041507903210851706793788311452973769358455761907303633956322972510500253009083922781934406731633755418753858930476576720874219359466503538931371444470303193503733920039</span>
    d <span class="token operator">=</span> wiener_hack<span class="token punctuation">(</span>e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#  flag&#123;You_Need_Some_Tea&#125;</span>
 
 
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎对文章中的引用来源进行考证，欢迎指出任何有错误或不够清晰的表达。可以在下面评论区评论，也可以邮件至 767778848@qq.com </span>
    </div>
</article>





    <div id="comments"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

<script type="text/javascript">
    $.getScript('/js/gitalk.js', function () {
        var gitalk = new Gitalk({
            clientID: '6c49373fe3729f3c2b02',
            clientSecret: '4b38338216282f43430b6118f27ae24e4732ecec',
            repo: 'Whitebird0.github.io',
            owner: 'Whitebird0',
            admin: ['Whitebird0'],
            id: decodeURI(location.pathname),
            distractionFreeMode: 'true',
            language: 'zh-CN',
            perPage: parseInt('10',10)
        })
        gitalk.render('comments')
    })
</script>




    




    </div>
    <div class="copyright">
        <p class="footer-entry">
    ©2020-2022 Whitebird
</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
